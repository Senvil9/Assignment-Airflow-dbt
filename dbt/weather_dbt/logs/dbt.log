[0m13:44:04.822308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f849fada310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a1ee5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f849fcb3e90>]}


============================== 13:44:04.828950 | c71c2298-3b42-48dd-b563-739f7f391c94 ==============================
[0m13:44:04.828950 [info ] [MainThread]: Running with dbt=1.10.7
[0m13:44:04.829931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:05.068108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c71c2298-3b42-48dd-b563-739f7f391c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f849fb300d0>]}
[0m13:44:05.109027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c71c2298-3b42-48dd-b563-739f7f391c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a2497f10>]}
[0m13:44:05.110601 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:44:05.191683 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m13:44:05.194635 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:44:05.195863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c71c2298-3b42-48dd-b563-739f7f391c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f849fb2ed90>]}
[0m13:44:05.337237 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading weather_dbt: bronze/sources.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |     schema: bronze
    6  |     tables:
    7  |       - name: weather_raw
    8  |           description: "Raw weather data ingested from the API, stored in the bronze layer."
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 8, column 22
[0m13:44:05.338991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5836787, "process_in_blocks": "76536", "process_kernel_time": 0.585733, "process_mem_max_rss": "115192", "process_out_blocks": "1728", "process_user_time": 1.740222}
[0m13:44:05.339722 [debug] [MainThread]: Command `dbt run` failed at 13:44:05.339610 after 0.58 seconds
[0m13:44:05.340485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f849fad9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f849fb2f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a3fe3690>]}
[0m13:44:05.341307 [debug] [MainThread]: Flushing usage events
[0m13:44:06.768792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:35.785637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711a90f9d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711a90f91650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711a90f91910>]}


============================== 13:45:35.791815 | 10b7909c-3cb8-4c60-a4aa-304a7ab3760d ==============================
[0m13:45:35.791815 [info ] [MainThread]: Running with dbt=1.10.7
[0m13:45:35.793060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m13:45:35.925989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10b7909c-3cb8-4c60-a4aa-304a7ab3760d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711a90323d10>]}
[0m13:45:35.967694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10b7909c-3cb8-4c60-a4aa-304a7ab3760d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711a9395b9d0>]}
[0m13:45:35.969876 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:45:36.061116 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m13:45:36.064148 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:45:36.065017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '10b7909c-3cb8-4c60-a4aa-304a7ab3760d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711a8ff051d0>]}
[0m13:45:36.171642 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading weather_dbt: bronze/sources.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |     schema: bronze
    6  |     tables:
    7  |       - name: weather_raw
    8  |           description: "Raw weather data ingested from the API, stored in the bronze layer."
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 8, column 22
[0m13:45:36.173427 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4439371, "process_in_blocks": "0", "process_kernel_time": 0.438437, "process_mem_max_rss": "113388", "process_out_blocks": "0", "process_user_time": 1.540563}
[0m13:45:36.174344 [debug] [MainThread]: Command `dbt run` failed at 13:45:36.174273 after 0.45 seconds
[0m13:45:36.175076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711a90f9c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711a90f9e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711a90ff2450>]}
[0m13:45:36.175899 [debug] [MainThread]: Flushing usage events
[0m13:45:37.668959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:14.479759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7e87def50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7e863f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7e87fc9d0>]}


============================== 14:00:14.485920 | ebb49d0f-47ef-472a-8fdf-0daf2ef27065 ==============================
[0m14:00:14.485920 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:00:14.486860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:00:14.630072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebb49d0f-47ef-472a-8fdf-0daf2ef27065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7e8675390>]}
[0m14:00:14.662345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebb49d0f-47ef-472a-8fdf-0daf2ef27065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7eb1cc410>]}
[0m14:00:14.664149 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:00:14.735629 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:00:14.737981 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:00:14.738763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebb49d0f-47ef-472a-8fdf-0daf2ef27065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7e7b3e090>]}
[0m14:00:14.828834 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading weather_dbt: bronze/sources.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |     schema: bronze
    6  |     tables:
    7  |       - name: weather_raw
    8  |           description: "Raw weather data ingested from the API, stored in the bronze layer."
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 8, column 22
[0m14:00:14.830460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.39397657, "process_in_blocks": "27464", "process_kernel_time": 0.495097, "process_mem_max_rss": "115804", "process_out_blocks": "1728", "process_user_time": 1.415189}
[0m14:00:14.831171 [debug] [MainThread]: Command `dbt run` failed at 14:00:14.831095 after 0.39 seconds
[0m14:00:14.831776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7e89bfe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7e737b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e7e863fe10>]}
[0m14:00:14.832362 [debug] [MainThread]: Flushing usage events
[0m14:00:16.124870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:06.367402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bc071fd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bc0722cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bc0724f2d0>]}


============================== 14:03:06.372996 | 34a98a5b-4686-4a10-b0a6-95beacf2895c ==============================
[0m14:03:06.372996 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:03:06.374136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m14:03:06.512846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34a98a5b-4686-4a10-b0a6-95beacf2895c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bc0653c590>]}
[0m14:03:06.557883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34a98a5b-4686-4a10-b0a6-95beacf2895c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bc09bc0610>]}
[0m14:03:06.559579 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:03:06.646920 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:03:06.649901 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:03:06.650736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '34a98a5b-4686-4a10-b0a6-95beacf2895c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bc0613b610>]}
[0m14:03:06.762238 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading weather_dbt: bronze/sources.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |     schema: bronze
    6  |     tables:
    7  |       - name: weather_raw
    8  |           description: "Raw weather data ingested from the API, stored in the bronze layer."
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 8, column 22
[0m14:03:06.763999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.45801002, "process_in_blocks": "0", "process_kernel_time": 0.404411, "process_mem_max_rss": "113420", "process_out_blocks": "0", "process_user_time": 1.442539}
[0m14:03:06.764997 [debug] [MainThread]: Command `dbt run` failed at 14:03:06.764925 after 0.46 seconds
[0m14:03:06.766032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bc07073f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bc071fe610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bc070b7350>]}
[0m14:03:06.766787 [debug] [MainThread]: Flushing usage events
[0m14:03:08.545798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:30.476958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb5524590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb57d0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb59cd610>]}


============================== 14:05:30.482406 | 35b1d7d1-e621-4762-a86f-a95a74f4de1a ==============================
[0m14:05:30.482406 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:05:30.483690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:30.597596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35b1d7d1-e621-4762-a86f-a95a74f4de1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb4f53f90>]}
[0m14:05:30.635820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35b1d7d1-e621-4762-a86f-a95a74f4de1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb7f0fd90>]}
[0m14:05:30.637309 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:05:30.712230 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:05:30.715494 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:30.716802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35b1d7d1-e621-4762-a86f-a95a74f4de1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb5470150>]}
[0m14:05:31.600853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35b1d7d1-e621-4762-a86f-a95a74f4de1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb3786b10>]}
[0m14:05:31.665816 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m14:05:31.671347 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m14:05:31.718957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35b1d7d1-e621-4762-a86f-a95a74f4de1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb33b2e50>]}
[0m14:05:31.719850 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 435 macros
[0m14:05:31.720670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35b1d7d1-e621-4762-a86f-a95a74f4de1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb3f8fed0>]}
[0m14:05:31.722370 [info ] [MainThread]: 
[0m14:05:31.723263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:31.723933 [info ] [MainThread]: 
[0m14:05:31.724934 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:31.728941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:05:31.763240 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:05:31.764445 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:05:31.765478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:31.780418 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.015 seconds
[0m14:05:31.782300 [debug] [ThreadPool]: On list_analytics: Close
[0m14:05:31.784696 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:05:31.786062 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:05:31.786989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:31.794771 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m14:05:31.796689 [debug] [ThreadPool]: On list_analytics: Close
[0m14:05:31.798857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_gold)
[0m14:05:31.802983 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m14:05:31.803761 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m14:05:31.804533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:31.811294 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:05:31.812495 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m14:05:31.813238 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:05:31.823458 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m14:05:31.825537 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m14:05:31.826730 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m14:05:31.827827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_gold, now list_analytics_silver)
[0m14:05:31.830133 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m14:05:31.830801 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m14:05:31.831445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:31.837670 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:05:31.838786 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m14:05:31.839593 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:05:31.842302 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:05:31.843591 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m14:05:31.844403 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m14:05:31.848722 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:31.849848 [debug] [MainThread]: On master: BEGIN
[0m14:05:31.850595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:31.858077 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:05:31.859307 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:31.860024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:31.866929 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m14:05:31.868530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35b1d7d1-e621-4762-a86f-a95a74f4de1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb0f09dd0>]}
[0m14:05:31.869434 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:31.870676 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:31.871647 [debug] [MainThread]: On master: BEGIN
[0m14:05:31.873007 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:05:31.873743 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.874511 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:31.875398 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.876469 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:31.877357 [debug] [MainThread]: On master: Close
[0m14:05:31.882687 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m14:05:31.883898 [info ] [Thread-1 (]: 1 of 4 START sql view model silver.stg_weather ................................. [RUN]
[0m14:05:31.884903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_silver, now model.weather_dbt.stg_weather)
[0m14:05:31.885991 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m14:05:31.890814 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m14:05:31.906019 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m14:05:31.925902 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.stg_weather"
[0m14:05:31.941547 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m14:05:31.942400 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: BEGIN
[0m14:05:31.943305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:31.950557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:05:31.951688 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m14:05:31.952585 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */

  create view "analytics"."silver"."stg_weather__dbt_tmp"
    
    
  as (
    

WITH ranked AS (
    SELECT
        day:: DATE AS day,
        latitude:: NUMERIC AS latitude,
        longitude:: NUMERIC AS longitude,
        temp_max:: NUMERIC AS temp_max,
        temp_min:: NUMERIC AS temp_min,
        precipitation_sum:: NUMERIC AS precipitation_sum,
        ingested_at:: TIMESTAMP AS ingested_at,
        ROW_NUMBER() OVER(PARTITION BY day ORDER BY ingested_at DESC) AS rn
    FROM "analytics"."bronze"."weather_raw"
)

SELECT
    day,
    latitude,
    longitude,
    temp_max,
    temp_min,
    precipitation_sum,
    ingested_at
FROM ranked
WHERE rn = 1
  );
[0m14:05:31.960523 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:05:31.964747 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m14:05:31.965778 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m14:05:31.967312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:05:31.976337 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m14:05:31.977497 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m14:05:31.978219 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m14:05:31.979733 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:05:31.984014 [debug] [Thread-1 (]: Applying DROP to: "analytics"."silver"."stg_weather__dbt_backup"
[0m14:05:31.987825 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m14:05:31.988743 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
drop view if exists "analytics"."silver"."stg_weather__dbt_backup" cascade
[0m14:05:31.990017 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:05:31.992486 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: Close
[0m14:05:31.994722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b1d7d1-e621-4762-a86f-a95a74f4de1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb04985d0>]}
[0m14:05:31.996338 [info ] [Thread-1 (]: 1 of 4 OK created sql view model silver.stg_weather ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m14:05:31.997477 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m14:05:31.999014 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m14:05:31.999801 [info ] [Thread-1 (]: 2 of 4 START sql table model gold.dim_date ..................................... [RUN]
[0m14:05:32.000665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m14:05:32.001396 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m14:05:32.010195 [debug] [Thread-1 (]: Compilation Error in model dim_date (models/gold/dim_date.sql)
  'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:05:32.011429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b1d7d1-e621-4762-a86f-a95a74f4de1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb0369c90>]}
[0m14:05:32.012607 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model gold.dim_date ............................ [[31mERROR[0m in 0.01s]
[0m14:05:32.013684 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m14:05:32.014328 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m14:05:32.014713 [debug] [Thread-4 (]: Marking all children of 'model.weather_dbt.dim_date' to be skipped because of status 'error'.  Reason: Compilation Error in model dim_date (models/gold/dim_date.sql)
  'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:05:32.015799 [info ] [Thread-1 (]: 3 of 4 START sql table model gold.dim_location ................................. [RUN]
[0m14:05:32.017567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m14:05:32.018247 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m14:05:32.020797 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m14:05:32.032235 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m14:05:32.048292 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_location"
[0m14:05:32.059956 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m14:05:32.060865 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: BEGIN
[0m14:05:32.061666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:32.068725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:05:32.069949 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m14:05:32.070718 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */

  
    

  create  table "analytics"."gold"."dim_location__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    latitude,
    longitude
FROM "analytics"."silver"."stg_weather"
  );
  
[0m14:05:32.078729 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:05:32.083488 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m14:05:32.084291 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location__dbt_tmp" rename to "dim_location"
[0m14:05:32.085849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:05:32.087089 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m14:05:32.088424 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m14:05:32.089843 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m14:05:32.091965 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:05:32.093938 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_location__dbt_backup"
[0m14:05:32.097054 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m14:05:32.097959 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
drop table if exists "analytics"."gold"."dim_location__dbt_backup" cascade
[0m14:05:32.099095 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:05:32.100380 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: Close
[0m14:05:32.101301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b1d7d1-e621-4762-a86f-a95a74f4de1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb0345d90>]}
[0m14:05:32.102582 [info ] [Thread-1 (]: 3 of 4 OK created sql table model gold.dim_location ............................ [[32mSELECT 1[0m in 0.08s]
[0m14:05:32.103839 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m14:05:32.104612 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m14:05:32.105519 [info ] [Thread-1 (]: 4 of 4 START sql table model gold.fct_weather_daily ............................ [RUN]
[0m14:05:32.106496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m14:05:32.107157 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m14:05:32.109467 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m14:05:32.116520 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m14:05:32.119576 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.fct_weather_daily"
[0m14:05:32.127562 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m14:05:32.128485 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: BEGIN
[0m14:05:32.129231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:32.135912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:05:32.137109 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m14:05:32.138059 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */

  
    

  create  table "analytics"."gold"."fct_weather_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    day AS date_day,
    latitude,
    longitude,
    temp_max,
    temp_min,
    temp_max - temp_min AS temp_range,
    precipitation_sum
FROM "analytics"."silver"."stg_weather"
  );
  
[0m14:05:32.143311 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.004 seconds
[0m14:05:32.145943 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m14:05:32.146794 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily__dbt_tmp" rename to "fct_weather_daily"
[0m14:05:32.147942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:05:32.149880 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m14:05:32.150575 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m14:05:32.151160 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m14:05:32.152669 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:05:32.154487 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."fct_weather_daily__dbt_backup"
[0m14:05:32.155675 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m14:05:32.156475 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
drop table if exists "analytics"."gold"."fct_weather_daily__dbt_backup" cascade
[0m14:05:32.157517 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:05:32.158713 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: Close
[0m14:05:32.159560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b1d7d1-e621-4762-a86f-a95a74f4de1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb0331190>]}
[0m14:05:32.160551 [info ] [Thread-1 (]: 4 of 4 OK created sql table model gold.fct_weather_daily ....................... [[32mSELECT 14[0m in 0.05s]
[0m14:05:32.161869 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m14:05:32.163783 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:32.164760 [debug] [MainThread]: On master: BEGIN
[0m14:05:32.165833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:32.172359 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:05:32.173386 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.174214 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:32.174857 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.175833 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:32.176465 [debug] [MainThread]: On master: Close
[0m14:05:32.177453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:32.178213 [debug] [MainThread]: Connection 'model.weather_dbt.fct_weather_daily' was properly closed.
[0m14:05:32.179159 [info ] [MainThread]: 
[0m14:05:32.180106 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m14:05:32.181095 [debug] [MainThread]: Command end result
[0m14:05:32.209884 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m14:05:32.216863 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m14:05:32.224844 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m14:05:32.226341 [info ] [MainThread]: 
[0m14:05:32.227958 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:05:32.229067 [info ] [MainThread]: 
[0m14:05:32.230789 [error] [MainThread]: [31mFailure in model dim_date (models/gold/dim_date.sql)[0m
[0m14:05:32.231769 [error] [MainThread]:   Compilation Error in model dim_date (models/gold/dim_date.sql)
  'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:05:32.232699 [info ] [MainThread]: 
[0m14:05:32.233731 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m14:05:32.235388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8060063, "process_in_blocks": "6432", "process_kernel_time": 0.431601, "process_mem_max_rss": "134912", "process_out_blocks": "472", "process_user_time": 2.263873}
[0m14:05:32.236826 [debug] [MainThread]: Command `dbt run` failed at 14:05:32.236670 after 1.81 seconds
[0m14:05:32.237907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb5526590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb9b8e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726eb9b087d0>]}
[0m14:05:32.238702 [debug] [MainThread]: Flushing usage events
[0m14:05:33.639867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:43.214462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab48ed1990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab4651b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab4657b4d0>]}


============================== 14:08:43.218686 | 1785fb34-5bba-4fc6-9987-1e1f7d1dbd34 ==============================
[0m14:08:43.218686 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:08:43.219823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:43.322329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1785fb34-5bba-4fc6-9987-1e1f7d1dbd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab4657a350>]}
[0m14:08:43.354471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1785fb34-5bba-4fc6-9987-1e1f7d1dbd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab48ef0390>]}
[0m14:08:43.355816 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:08:43.426947 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:08:43.599966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:08:43.601122 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/gold/dim_date.sql
[0m14:08:43.750424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1785fb34-5bba-4fc6-9987-1e1f7d1dbd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab44f970d0>]}
[0m14:08:43.857672 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m14:08:43.862609 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m14:08:43.883164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1785fb34-5bba-4fc6-9987-1e1f7d1dbd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab44bf53d0>]}
[0m14:08:43.884250 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 435 macros
[0m14:08:43.884997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1785fb34-5bba-4fc6-9987-1e1f7d1dbd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab44fa9ad0>]}
[0m14:08:43.886546 [info ] [MainThread]: 
[0m14:08:43.887362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:43.888042 [info ] [MainThread]: 
[0m14:08:43.888913 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:08:43.892559 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:08:43.920301 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:08:43.921144 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:08:43.921842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:43.929431 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m14:08:43.931250 [debug] [ThreadPool]: On list_analytics: Close
[0m14:08:43.933568 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:08:43.934307 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:08:43.934892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:43.941181 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m14:08:43.942436 [debug] [ThreadPool]: On list_analytics: Close
[0m14:08:43.944487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_silver)
[0m14:08:43.948505 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m14:08:43.949217 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m14:08:43.949730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:43.954954 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:08:43.956005 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m14:08:43.956793 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:08:43.959337 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:08:43.960926 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m14:08:43.961920 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m14:08:43.962999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m14:08:43.965208 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m14:08:43.966021 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m14:08:43.966679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:43.972690 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:08:43.973468 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m14:08:43.974022 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:08:43.976556 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m14:08:43.978058 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m14:08:43.978921 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m14:08:43.982964 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:43.983748 [debug] [MainThread]: On master: BEGIN
[0m14:08:43.984442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:43.990499 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:08:43.991435 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:43.992234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:08:43.995581 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:08:43.996655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1785fb34-5bba-4fc6-9987-1e1f7d1dbd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab44f3db50>]}
[0m14:08:43.997291 [debug] [MainThread]: On master: ROLLBACK
[0m14:08:43.997983 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:43.998562 [debug] [MainThread]: On master: BEGIN
[0m14:08:43.999599 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:08:44.000323 [debug] [MainThread]: On master: COMMIT
[0m14:08:44.000908 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:44.001424 [debug] [MainThread]: On master: COMMIT
[0m14:08:44.002181 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:44.002897 [debug] [MainThread]: On master: Close
[0m14:08:44.006900 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m14:08:44.007995 [info ] [Thread-1 (]: 1 of 4 START sql view model silver.stg_weather ................................. [RUN]
[0m14:08:44.008794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now model.weather_dbt.stg_weather)
[0m14:08:44.009654 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m14:08:44.013994 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m14:08:44.020972 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m14:08:44.038463 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.stg_weather"
[0m14:08:44.046043 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m14:08:44.046853 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: BEGIN
[0m14:08:44.047871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:44.054211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:08:44.055425 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m14:08:44.056196 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */

  create view "analytics"."silver"."stg_weather__dbt_tmp"
    
    
  as (
    

WITH ranked AS (
    SELECT
        day:: DATE AS day,
        latitude:: NUMERIC AS latitude,
        longitude:: NUMERIC AS longitude,
        temp_max:: NUMERIC AS temp_max,
        temp_min:: NUMERIC AS temp_min,
        precipitation_sum:: NUMERIC AS precipitation_sum,
        ingested_at:: TIMESTAMP AS ingested_at,
        ROW_NUMBER() OVER(PARTITION BY day ORDER BY ingested_at DESC) AS rn
    FROM "analytics"."bronze"."weather_raw"
)

SELECT
    day,
    latitude,
    longitude,
    temp_max,
    temp_min,
    precipitation_sum,
    ingested_at
FROM ranked
WHERE rn = 1
  );
[0m14:08:44.058730 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:08:44.062995 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m14:08:44.063761 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather" rename to "stg_weather__dbt_backup"
[0m14:08:44.064945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:08:44.067544 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m14:08:44.068446 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m14:08:44.069506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:08:44.077357 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m14:08:44.078157 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m14:08:44.078849 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m14:08:44.080914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:08:44.085908 [debug] [Thread-1 (]: Applying DROP to: "analytics"."silver"."stg_weather__dbt_backup"
[0m14:08:44.089361 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m14:08:44.090097 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
drop view if exists "analytics"."silver"."stg_weather__dbt_backup" cascade
[0m14:08:44.094417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:08:44.096353 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: Close
[0m14:08:44.097727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1785fb34-5bba-4fc6-9987-1e1f7d1dbd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab465639d0>]}
[0m14:08:44.098763 [info ] [Thread-1 (]: 1 of 4 OK created sql view model silver.stg_weather ............................ [[32mCREATE VIEW[0m in 0.09s]
[0m14:08:44.099803 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m14:08:44.101097 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m14:08:44.101943 [info ] [Thread-1 (]: 2 of 4 START sql table model gold.dim_date ..................................... [RUN]
[0m14:08:44.102907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m14:08:44.103635 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m14:08:44.106539 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m14:08:44.113977 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m14:08:44.126293 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_date"
[0m14:08:44.134346 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m14:08:44.135194 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: BEGIN
[0m14:08:44.135903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:44.141505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:08:44.142742 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m14:08:44.143651 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */

  
    

  create  table "analytics"."gold"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    SELECT
        min(day) as min_day,
        max(day) as max_day
    FROM "analytics"."silver"."stg_weather"    
),
dates as (
    select generate_series(min_day, max_day, interval '1 day')::date as date_day
    from bounds
)
SELECT
    date_day,
    extract(year from date_day)::int as year,
    extract(month from date_day)::int as month,
    to_char(date_day, 'Mon')  as month_name,
    extract(day from date_day) as day_of_month,
    extract(dow from date_day)::int as day_of_week,
    to_char(date_day, 'Dy') as day_name,
    case when extract(dow from date_day) in (0,6) then true else false end as is_weekend
FROM dates
  );
  
[0m14:08:44.156406 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.012 seconds
[0m14:08:44.161024 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m14:08:44.161769 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
alter table "analytics"."gold"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:08:44.162816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:08:44.164208 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m14:08:44.165111 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m14:08:44.165911 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m14:08:44.167906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:08:44.170165 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_date__dbt_backup"
[0m14:08:44.172481 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m14:08:44.173067 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
drop table if exists "analytics"."gold"."dim_date__dbt_backup" cascade
[0m14:08:44.174119 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:08:44.175752 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: Close
[0m14:08:44.177060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1785fb34-5bba-4fc6-9987-1e1f7d1dbd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab417a3d90>]}
[0m14:08:44.178275 [info ] [Thread-1 (]: 2 of 4 OK created sql table model gold.dim_date ................................ [[32mSELECT 14[0m in 0.07s]
[0m14:08:44.179243 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m14:08:44.180087 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m14:08:44.180740 [info ] [Thread-1 (]: 3 of 4 START sql table model gold.dim_location ................................. [RUN]
[0m14:08:44.181715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m14:08:44.182410 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m14:08:44.184654 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m14:08:44.190895 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m14:08:44.193836 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_location"
[0m14:08:44.200294 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m14:08:44.201168 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: BEGIN
[0m14:08:44.202014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:44.208319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:08:44.209368 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m14:08:44.209991 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */

  
    

  create  table "analytics"."gold"."dim_location__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    latitude,
    longitude
FROM "analytics"."silver"."stg_weather"
  );
  
[0m14:08:44.215466 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:08:44.217837 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m14:08:44.218638 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location" rename to "dim_location__dbt_backup"
[0m14:08:44.219944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:08:44.222036 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m14:08:44.222635 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location__dbt_tmp" rename to "dim_location"
[0m14:08:44.223625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:08:44.225006 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m14:08:44.225611 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m14:08:44.226362 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m14:08:44.227996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:08:44.229892 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_location__dbt_backup"
[0m14:08:44.230687 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m14:08:44.231306 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
drop table if exists "analytics"."gold"."dim_location__dbt_backup" cascade
[0m14:08:44.233751 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:08:44.235284 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: Close
[0m14:08:44.236174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1785fb34-5bba-4fc6-9987-1e1f7d1dbd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab41753410>]}
[0m14:08:44.237279 [info ] [Thread-1 (]: 3 of 4 OK created sql table model gold.dim_location ............................ [[32mSELECT 1[0m in 0.05s]
[0m14:08:44.238435 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m14:08:44.239295 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m14:08:44.240161 [info ] [Thread-1 (]: 4 of 4 START sql table model gold.fct_weather_daily ............................ [RUN]
[0m14:08:44.240938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m14:08:44.241656 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m14:08:44.245028 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m14:08:44.252366 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m14:08:44.254894 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.fct_weather_daily"
[0m14:08:44.261704 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m14:08:44.262706 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: BEGIN
[0m14:08:44.263376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:44.269767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:08:44.270777 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m14:08:44.271513 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */

  
    

  create  table "analytics"."gold"."fct_weather_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    day AS date_day,
    latitude,
    longitude,
    temp_max,
    temp_min,
    temp_max - temp_min AS temp_range,
    precipitation_sum
FROM "analytics"."silver"."stg_weather"
  );
  
[0m14:08:44.276549 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.004 seconds
[0m14:08:44.278911 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m14:08:44.279649 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily" rename to "fct_weather_daily__dbt_backup"
[0m14:08:44.280583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:08:44.282463 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m14:08:44.283030 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily__dbt_tmp" rename to "fct_weather_daily"
[0m14:08:44.283909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:08:44.285083 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m14:08:44.285745 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m14:08:44.286360 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m14:08:44.288010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:08:44.289968 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."fct_weather_daily__dbt_backup"
[0m14:08:44.291181 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m14:08:44.291897 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
drop table if exists "analytics"."gold"."fct_weather_daily__dbt_backup" cascade
[0m14:08:44.294646 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:08:44.296360 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: Close
[0m14:08:44.297343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1785fb34-5bba-4fc6-9987-1e1f7d1dbd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab40500210>]}
[0m14:08:44.298266 [info ] [Thread-1 (]: 4 of 4 OK created sql table model gold.fct_weather_daily ....................... [[32mSELECT 14[0m in 0.06s]
[0m14:08:44.299367 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m14:08:44.301287 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:44.301890 [debug] [MainThread]: On master: BEGIN
[0m14:08:44.302781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:44.309311 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:08:44.310239 [debug] [MainThread]: On master: COMMIT
[0m14:08:44.310986 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:44.311950 [debug] [MainThread]: On master: COMMIT
[0m14:08:44.312787 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:44.313429 [debug] [MainThread]: On master: Close
[0m14:08:44.314254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:44.314860 [debug] [MainThread]: Connection 'model.weather_dbt.fct_weather_daily' was properly closed.
[0m14:08:44.315731 [info ] [MainThread]: 
[0m14:08:44.316483 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m14:08:44.317379 [debug] [MainThread]: Command end result
[0m14:08:44.340554 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m14:08:44.345219 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m14:08:44.352188 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m14:08:44.353144 [info ] [MainThread]: 
[0m14:08:44.354063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:44.354878 [info ] [MainThread]: 
[0m14:08:44.355705 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m14:08:44.357086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1872936, "process_in_blocks": "0", "process_kernel_time": 0.486875, "process_mem_max_rss": "129960", "process_out_blocks": "0", "process_user_time": 1.777765}
[0m14:08:44.358189 [debug] [MainThread]: Command `dbt run` succeeded at 14:08:44.358061 after 1.19 seconds
[0m14:08:44.359049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab4659fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab4956b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eab4aada7d0>]}
[0m14:08:44.359965 [debug] [MainThread]: Flushing usage events
[0m14:08:45.674448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:49.391084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6070d95bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d606e456f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d606e456610>]}


============================== 14:08:49.397216 | dd9cd9d3-309c-425b-b268-13399ed920f2 ==============================
[0m14:08:49.397216 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:08:49.398351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:49.517346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd9cd9d3-309c-425b-b268-13399ed920f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d606dbb5f90>]}
[0m14:08:49.560344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd9cd9d3-309c-425b-b268-13399ed920f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6070dcc7d0>]}
[0m14:08:49.562045 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:08:49.641853 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:08:49.835858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:49.836792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:49.862522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd9cd9d3-309c-425b-b268-13399ed920f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d606cf8bd50>]}
[0m14:08:49.921397 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m14:08:49.927239 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m14:08:49.958726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd9cd9d3-309c-425b-b268-13399ed920f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d606c7cac50>]}
[0m14:08:49.960128 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 435 macros
[0m14:08:49.961538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd9cd9d3-309c-425b-b268-13399ed920f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d606cf68b10>]}
[0m14:08:49.963824 [info ] [MainThread]: 
[0m14:08:49.965360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:49.966533 [info ] [MainThread]: 
[0m14:08:49.967602 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:08:49.971834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_silver'
[0m14:08:50.058708 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m14:08:50.059941 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m14:08:50.060921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:50.068813 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:08:50.069709 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m14:08:50.070346 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:08:50.074267 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:08:50.075792 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m14:08:50.076629 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m14:08:50.077551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m14:08:50.080019 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m14:08:50.080739 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m14:08:50.081384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:50.087691 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:08:50.088760 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m14:08:50.089587 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:08:50.092130 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:08:50.093626 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m14:08:50.094617 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m14:08:50.098812 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:50.099699 [debug] [MainThread]: On master: BEGIN
[0m14:08:50.100371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:50.106809 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:08:50.107866 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:50.108562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:08:50.111908 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:08:50.113631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd9cd9d3-309c-425b-b268-13399ed920f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d606c76de50>]}
[0m14:08:50.114611 [debug] [MainThread]: On master: ROLLBACK
[0m14:08:50.115718 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:50.116483 [debug] [MainThread]: On master: BEGIN
[0m14:08:50.117685 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:08:50.118428 [debug] [MainThread]: On master: COMMIT
[0m14:08:50.119048 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:50.119648 [debug] [MainThread]: On master: COMMIT
[0m14:08:50.120407 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:50.120968 [debug] [MainThread]: On master: Close
[0m14:08:50.124946 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_day.ddca75ad79
[0m14:08:50.125888 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_weather_day ..................................... [RUN]
[0m14:08:50.126905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now test.weather_dbt.not_null_stg_weather_day.ddca75ad79)
[0m14:08:50.127674 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_day.ddca75ad79
[0m14:08:50.137165 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_day.ddca75ad79"
[0m14:08:50.151403 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_day.ddca75ad79
[0m14:08:50.162168 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_day.ddca75ad79"
[0m14:08:50.176241 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_day.ddca75ad79"
[0m14:08:50.177382 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_day.ddca75ad79: BEGIN
[0m14:08:50.178148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:50.189835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m14:08:50.191090 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_day.ddca75ad79"
[0m14:08:50.191879 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_day.ddca75ad79: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_day.ddca75ad79"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day
from "analytics"."silver"."stg_weather"
where day is null



  
  
      
    ) dbt_internal_test
[0m14:08:50.194320 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:08:50.197817 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_day.ddca75ad79: ROLLBACK
[0m14:08:50.198933 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_day.ddca75ad79: Close
[0m14:08:50.200029 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_weather_day ........................................... [[32mPASS[0m in 0.07s]
[0m14:08:50.201070 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_day.ddca75ad79
[0m14:08:50.201892 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_stg_weather_day.af5e0fb747
[0m14:08:50.202778 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_weather_day ....................................... [RUN]
[0m14:08:50.203816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_day.ddca75ad79, now test.weather_dbt.unique_stg_weather_day.af5e0fb747)
[0m14:08:50.204748 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_stg_weather_day.af5e0fb747
[0m14:08:50.208815 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_stg_weather_day.af5e0fb747"
[0m14:08:50.217364 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_stg_weather_day.af5e0fb747
[0m14:08:50.219633 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.unique_stg_weather_day.af5e0fb747"
[0m14:08:50.228538 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_day.af5e0fb747"
[0m14:08:50.229672 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_day.af5e0fb747: BEGIN
[0m14:08:50.230581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:50.236841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:08:50.238024 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_day.af5e0fb747"
[0m14:08:50.238917 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_day.af5e0fb747: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.unique_stg_weather_day.af5e0fb747"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    day as unique_field,
    count(*) as n_records

from "analytics"."silver"."stg_weather"
where day is not null
group by day
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:50.241321 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:08:50.242913 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_day.af5e0fb747: ROLLBACK
[0m14:08:50.243783 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_day.af5e0fb747: Close
[0m14:08:50.245071 [info ] [Thread-1 (]: 2 of 2 PASS unique_stg_weather_day ............................................. [[32mPASS[0m in 0.04s]
[0m14:08:50.246241 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_stg_weather_day.af5e0fb747
[0m14:08:50.248250 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:50.248937 [debug] [MainThread]: On master: BEGIN
[0m14:08:50.249527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:50.255494 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:08:50.256514 [debug] [MainThread]: On master: COMMIT
[0m14:08:50.257125 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:50.257778 [debug] [MainThread]: On master: COMMIT
[0m14:08:50.258559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:50.259102 [debug] [MainThread]: On master: Close
[0m14:08:50.259771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:50.260552 [debug] [MainThread]: Connection 'test.weather_dbt.unique_stg_weather_day.af5e0fb747' was properly closed.
[0m14:08:50.261324 [info ] [MainThread]: 
[0m14:08:50.262104 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m14:08:50.263129 [debug] [MainThread]: Command end result
[0m14:08:50.289310 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m14:08:50.294677 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m14:08:50.303422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m14:08:50.304477 [info ] [MainThread]: 
[0m14:08:50.305840 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:50.306935 [info ] [MainThread]: 
[0m14:08:50.308064 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:08:50.309759 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9757644, "process_in_blocks": "1224", "process_kernel_time": 0.424628, "process_mem_max_rss": "128016", "process_out_blocks": "0", "process_user_time": 1.617632}
[0m14:08:50.310937 [debug] [MainThread]: Command `dbt test` succeeded at 14:08:50.310813 after 0.98 seconds
[0m14:08:50.311828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d606e6a2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d606dbf3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6072a3ee50>]}
[0m14:08:50.312679 [debug] [MainThread]: Flushing usage events
[0m14:08:52.341822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:55.587806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7975ea9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7975e99910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7976a63a90>]}


============================== 14:08:55.593337 | eab37aea-eb7a-45e3-afb0-fcbd3631393a ==============================
[0m14:08:55.593337 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:08:55.594440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m14:08:55.722994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eab37aea-eb7a-45e3-afb0-fcbd3631393a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7975506c90>]}
[0m14:08:55.760404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eab37aea-eb7a-45e3-afb0-fcbd3631393a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d79787e0550>]}
[0m14:08:55.761710 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:08:55.839315 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:08:56.088930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:56.090114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:56.123225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eab37aea-eb7a-45e3-afb0-fcbd3631393a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d79749b03d0>]}
[0m14:08:56.170912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eab37aea-eb7a-45e3-afb0-fcbd3631393a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7974532990>]}
[0m14:08:56.174470 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 435 macros
[0m14:08:56.176572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eab37aea-eb7a-45e3-afb0-fcbd3631393a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7975ed8a10>]}
[0m14:08:56.179484 [info ] [MainThread]: 
[0m14:08:56.180883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:56.181801 [info ] [MainThread]: 
[0m14:08:56.183040 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:08:56.187127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_silver'
[0m14:08:56.229366 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m14:08:56.230367 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m14:08:56.231044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:56.239300 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:08:56.240509 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m14:08:56.245952 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:08:56.251772 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:08:56.253468 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m14:08:56.254735 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m14:08:56.256640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m14:08:56.259161 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m14:08:56.259934 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m14:08:56.260591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:56.269406 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:08:56.270508 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m14:08:56.271193 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:08:56.274613 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:08:56.278336 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m14:08:56.280982 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m14:08:56.285727 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:56.286922 [debug] [MainThread]: On master: BEGIN
[0m14:08:56.287888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:56.294864 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:08:56.297023 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:56.298573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:08:56.302639 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:08:56.304184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eab37aea-eb7a-45e3-afb0-fcbd3631393a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7974900bd0>]}
[0m14:08:56.305622 [debug] [MainThread]: On master: ROLLBACK
[0m14:08:56.306760 [debug] [MainThread]: On master: Close
[0m14:08:56.310665 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m14:08:56.311654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now model.weather_dbt.stg_weather)
[0m14:08:56.312586 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m14:08:56.320429 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m14:08:56.335795 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m14:08:56.337573 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m14:08:56.339567 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m14:08:56.341288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m14:08:56.342499 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m14:08:56.348438 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m14:08:56.360881 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m14:08:56.362226 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m14:08:56.363494 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m14:08:56.365580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m14:08:56.367921 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m14:08:56.372267 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m14:08:56.382887 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m14:08:56.385956 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m14:08:56.388275 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m14:08:56.390426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m14:08:56.391611 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m14:08:56.395642 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m14:08:56.405597 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m14:08:56.407186 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m14:08:56.408084 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_day.ddca75ad79
[0m14:08:56.408911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.fct_weather_daily, now test.weather_dbt.not_null_stg_weather_day.ddca75ad79)
[0m14:08:56.409724 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_day.ddca75ad79
[0m14:08:56.419476 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_day.ddca75ad79"
[0m14:08:56.429858 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_day.ddca75ad79
[0m14:08:56.431293 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_day.ddca75ad79
[0m14:08:56.432200 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_stg_weather_day.af5e0fb747
[0m14:08:56.433194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_day.ddca75ad79, now test.weather_dbt.unique_stg_weather_day.af5e0fb747)
[0m14:08:56.434487 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_stg_weather_day.af5e0fb747
[0m14:08:56.439673 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_stg_weather_day.af5e0fb747"
[0m14:08:56.449930 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_stg_weather_day.af5e0fb747
[0m14:08:56.451025 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_stg_weather_day.af5e0fb747
[0m14:08:56.452761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:56.453615 [debug] [MainThread]: Connection 'test.weather_dbt.unique_stg_weather_day.af5e0fb747' was properly closed.
[0m14:08:56.455952 [debug] [MainThread]: Command end result
[0m14:08:56.605707 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m14:08:56.611202 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m14:08:56.621008 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m14:08:56.644049 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:08:56.645439 [info ] [MainThread]: Building catalog
[0m14:08:56.653711 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m14:08:56.660572 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:08:56.661655 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m14:08:56.662387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:56.671568 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:08:56.672918 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:08:56.673790 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('dim_location')) or (upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('fct_weather_daily')) or (upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('silver') and
           upper(tbl.relname) = upper('stg_weather')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('weather_raw')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:08:56.691728 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.017 seconds
[0m14:08:56.694437 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m14:08:56.695883 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m14:08:56.708728 [debug] [MainThread]: Wrote artifact CatalogArtifact to /opt/airflow/dbt/weather_dbt/target/catalog.json
[0m14:08:56.745135 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m14:08:56.753480 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m14:08:56.755054 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/weather_dbt/target/catalog.json
[0m14:08:56.756834 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.2271943, "process_in_blocks": "3416", "process_kernel_time": 0.43435, "process_mem_max_rss": "126560", "process_out_blocks": "0", "process_user_time": 1.860933}
[0m14:08:56.758137 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:08:56.758013 after 1.23 seconds
[0m14:08:56.759570 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:08:56.761193 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m14:08:56.762177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7977c2ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d797a315590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d797319c950>]}
[0m14:08:56.763076 [debug] [MainThread]: Flushing usage events
[0m14:08:58.019997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:38.840836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d36b62e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d36b663450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d36b673010>]}


============================== 17:51:38.847313 | 4f61f622-a8ff-43dc-9b88-7090a18a5676 ==============================
[0m17:51:38.847313 [info ] [MainThread]: Running with dbt=1.10.7
[0m17:51:38.848367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:51:39.058389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f61f622-a8ff-43dc-9b88-7090a18a5676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d36add5190>]}
[0m17:51:39.091928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f61f622-a8ff-43dc-9b88-7090a18a5676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d36dfdc7d0>]}
[0m17:51:39.093715 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:51:39.170111 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m17:51:39.432743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:51:39.434197 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/silver/schema.yml
[0m17:51:39.435334 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/gold/fct_weather_daily.sql
[0m17:51:39.436203 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/silver/stg_weather.sql
[0m17:51:39.729360 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.weather_dbt.fct_weather_daily' (models/gold/fct_weather_daily.sql) depends on a node named 'weather_silver' which was not found
[0m17:51:39.731770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.94124997, "process_in_blocks": "67872", "process_kernel_time": 0.651054, "process_mem_max_rss": "120556", "process_out_blocks": "1728", "process_user_time": 1.904773}
[0m17:51:39.732747 [debug] [MainThread]: Command `dbt run` failed at 17:51:39.732663 after 0.94 seconds
[0m17:51:39.733636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d36fbca6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d36fbca7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d36b52bdd0>]}
[0m17:51:39.734680 [debug] [MainThread]: Flushing usage events
[0m17:51:41.372108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:28.245728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d767cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d8226350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d767c850>]}


============================== 17:53:28.252539 | 03a1642f-76ad-4020-ad1e-366c15513581 ==============================
[0m17:53:28.252539 [info ] [MainThread]: Running with dbt=1.10.7
[0m17:53:28.253652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:53:28.473976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03a1642f-76ad-4020-ad1e-366c15513581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d770c1d0>]}
[0m17:53:28.512881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03a1642f-76ad-4020-ad1e-366c15513581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88da06bb50>]}
[0m17:53:28.515052 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:53:28.599277 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m17:53:28.889651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:53:28.891155 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/silver/schema.yml
[0m17:53:28.892099 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/silver/stg_weather.sql
[0m17:53:28.892895 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/gold/fct_weather_daily.sql
[0m17:53:29.273799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03a1642f-76ad-4020-ad1e-366c15513581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d6d30110>]}
[0m17:53:29.342415 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m17:53:29.348979 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m17:53:29.407691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03a1642f-76ad-4020-ad1e-366c15513581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d594f410>]}
[0m17:53:29.409063 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 435 macros
[0m17:53:29.410107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03a1642f-76ad-4020-ad1e-366c15513581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d6536190>]}
[0m17:53:29.412355 [info ] [MainThread]: 
[0m17:53:29.413467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:29.414689 [info ] [MainThread]: 
[0m17:53:29.416134 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:53:29.419619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m17:53:29.457804 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m17:53:29.458996 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:53:29.460021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:29.475822 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m17:53:29.477854 [debug] [ThreadPool]: On list_analytics: Close
[0m17:53:29.480103 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m17:53:29.481096 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:53:29.481933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:29.488814 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m17:53:29.490889 [debug] [ThreadPool]: On list_analytics: Close
[0m17:53:29.493271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_silver)
[0m17:53:29.497944 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m17:53:29.498902 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m17:53:29.499710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:29.506461 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:53:29.507811 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m17:53:29.508813 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m17:53:29.520890 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m17:53:29.522760 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m17:53:29.523897 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m17:53:29.525333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m17:53:29.527753 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m17:53:29.528596 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m17:53:29.529447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:29.537017 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:53:29.538065 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m17:53:29.539081 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m17:53:29.542268 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m17:53:29.543851 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m17:53:29.545302 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m17:53:29.549649 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:29.550978 [debug] [MainThread]: On master: BEGIN
[0m17:53:29.552012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:29.558888 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:53:29.560195 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:29.561385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:53:29.570267 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m17:53:29.572043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03a1642f-76ad-4020-ad1e-366c15513581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d55a7d10>]}
[0m17:53:29.573052 [debug] [MainThread]: On master: ROLLBACK
[0m17:53:29.574230 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:29.575514 [debug] [MainThread]: On master: BEGIN
[0m17:53:29.577029 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:53:29.578280 [debug] [MainThread]: On master: COMMIT
[0m17:53:29.579424 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:29.580462 [debug] [MainThread]: On master: COMMIT
[0m17:53:29.582016 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:53:29.583021 [debug] [MainThread]: On master: Close
[0m17:53:29.589195 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m17:53:29.590343 [info ] [Thread-1 (]: 1 of 4 START sql view model silver.stg_weather ................................. [RUN]
[0m17:53:29.591293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now model.weather_dbt.stg_weather)
[0m17:53:29.592104 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m17:53:29.598905 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m17:53:29.606941 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m17:53:29.626572 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.stg_weather"
[0m17:53:29.635126 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m17:53:29.636177 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: BEGIN
[0m17:53:29.636990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:29.644138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:53:29.645413 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m17:53:29.646325 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */

  create view "analytics"."silver"."stg_weather__dbt_tmp"
    
    
  as (
    


WITH ranked_weather AS (
    SELECT
        day:: DATE AS day,
        city_name:: VARCHAR(50) AS city_name,
        latitude:: NUMERIC AS latitude,
        longitude:: NUMERIC AS longitude,
        temp_max:: NUMERIC AS temp_max,
        temp_min:: NUMERIC AS temp_min,
        precipitation_sum:: NUMERIC AS precipitation_sum,
        ingested_at:: TIMESTAMP AS ingested_at,
        ROW_NUMBER() OVER(PARTITION BY city_name, day ORDER BY ingested_at DESC) AS rn
    FROM "analytics"."bronze"."weather_raw"
),

deduped_weather AS (
    SELECT
        -- Surrogate key: hash of business key + latest timestamp
        MD5(
            city_name || '|' || CAST(day AS STRING)) AS weather_surrogate_key,
        
        -- Cast types cleanly
        CAST(day AS DATE) AS observation_date,
        CAST(city_name AS VARCHAR(50)) AS city_name,
        CAST(latitude AS DECIMAL(9,6)) AS latitude,
        CAST(longitude AS DECIMAL(9,6)) AS longitude,
        CAST(temp_max AS DECIMAL(5,2)) AS temp_max_celsius,
        CAST(temp_min AS DECIMAL(5,2)) AS temp_min_celsius,
        CAST(precipitation_sum AS DECIMAL(6,2)) AS precipitation_mm,
        CAST(ingested_at AS TIMESTAMP) AS ingested_at
    FROM ranked_weather
    WHERE rn = 1  -- Keep only latest record per city per day
        AND city_name IS NOT NULL 
        AND latitude IS NOT NULL 
        AND longitude IS NOT NULL
        AND day IS NOT NULL
        AND temp_max IS NOT NULL 
        AND temp_min IS NOT NULL
)


SELECT * FROM deduped_weather
  );
[0m17:53:29.651421 [debug] [Thread-1 (]: Postgres adapter: Postgres error: type "string" does not exist
LINE 28:             city_name || '|' || CAST(day AS STRING)) AS weat...
                                                     ^

[0m17:53:29.652337 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: ROLLBACK
[0m17:53:29.653386 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: Close
[0m17:53:29.660922 [debug] [Thread-1 (]: Database Error in model stg_weather (models/silver/stg_weather.sql)
  type "string" does not exist
  LINE 28:             city_name || '|' || CAST(day AS STRING)) AS weat...
                                                       ^
  compiled code at target/run/weather_dbt/models/silver/stg_weather.sql
[0m17:53:29.663531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a1642f-76ad-4020-ad1e-366c15513581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d6dd3390>]}
[0m17:53:29.664899 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model silver.stg_weather ........................ [[31mERROR[0m in 0.07s]
[0m17:53:29.666092 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m17:53:29.667012 [debug] [Thread-4 (]: Marking all children of 'model.weather_dbt.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/silver/stg_weather.sql)
  type "string" does not exist
  LINE 28:             city_name || '|' || CAST(day AS STRING)) AS weat...
                                                       ^
  compiled code at target/run/weather_dbt/models/silver/stg_weather.sql.
[0m17:53:29.668813 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m17:53:29.669423 [info ] [Thread-1 (]: 2 of 4 SKIP relation gold.dim_date ............................................. [[33mSKIP[0m]
[0m17:53:29.670145 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m17:53:29.671071 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m17:53:29.671791 [info ] [Thread-1 (]: 3 of 4 SKIP relation gold.dim_location ......................................... [[33mSKIP[0m]
[0m17:53:29.672494 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m17:53:29.673278 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m17:53:29.674026 [info ] [Thread-1 (]: 4 of 4 SKIP relation gold.fct_weather_daily .................................... [[33mSKIP[0m]
[0m17:53:29.675194 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m17:53:29.677233 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:29.677897 [debug] [MainThread]: On master: BEGIN
[0m17:53:29.678489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:29.684295 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:53:29.685312 [debug] [MainThread]: On master: COMMIT
[0m17:53:29.685912 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:29.686488 [debug] [MainThread]: On master: COMMIT
[0m17:53:29.687265 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:53:29.687910 [debug] [MainThread]: On master: Close
[0m17:53:29.688735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:29.689517 [debug] [MainThread]: Connection 'model.weather_dbt.stg_weather' was properly closed.
[0m17:53:29.690529 [info ] [MainThread]: 
[0m17:53:29.691471 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m17:53:29.692307 [debug] [MainThread]: Command end result
[0m17:53:29.720235 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m17:53:29.726287 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m17:53:29.734217 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m17:53:29.735446 [info ] [MainThread]: 
[0m17:53:29.736588 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:53:29.737602 [info ] [MainThread]: 
[0m17:53:29.738462 [error] [MainThread]: [31mFailure in model stg_weather (models/silver/stg_weather.sql)[0m
[0m17:53:29.739305 [error] [MainThread]:   Database Error in model stg_weather (models/silver/stg_weather.sql)
  type "string" does not exist
  LINE 28:             city_name || '|' || CAST(day AS STRING)) AS weat...
                                                       ^
  compiled code at target/run/weather_dbt/models/silver/stg_weather.sql
[0m17:53:29.740253 [info ] [MainThread]: 
[0m17:53:29.741087 [info ] [MainThread]:   compiled code at target/compiled/weather_dbt/models/silver/stg_weather.sql
[0m17:53:29.741971 [info ] [MainThread]: 
[0m17:53:29.743073 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=4
[0m17:53:29.744922 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5478383, "process_in_blocks": "70840", "process_kernel_time": 0.651965, "process_mem_max_rss": "131296", "process_out_blocks": "472", "process_user_time": 2.051407}
[0m17:53:29.745913 [debug] [MainThread]: Command `dbt run` failed at 17:53:29.745827 after 1.55 seconds
[0m17:53:29.746797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d76f3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d825c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88d76f3dd0>]}
[0m17:53:29.747786 [debug] [MainThread]: Flushing usage events
[0m17:53:31.181250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:59.053253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4cbccc990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4cd23a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4cbccd590>]}


============================== 17:54:59.063012 | fd3e4c26-57da-49e9-85b3-a56d0b2cd00a ==============================
[0m17:54:59.063012 [info ] [MainThread]: Running with dbt=1.10.7
[0m17:54:59.064118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:54:59.333255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd3e4c26-57da-49e9-85b3-a56d0b2cd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4cbcce290>]}
[0m17:54:59.377710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd3e4c26-57da-49e9-85b3-a56d0b2cd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4caf35650>]}
[0m17:54:59.379750 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:54:59.471219 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m17:54:59.751640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:59.753484 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/silver/stg_weather.sql
[0m17:55:00.171391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd3e4c26-57da-49e9-85b3-a56d0b2cd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4cb3c44d0>]}
[0m17:55:00.245147 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m17:55:00.251337 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m17:55:00.288699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd3e4c26-57da-49e9-85b3-a56d0b2cd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4c9f1c290>]}
[0m17:55:00.290165 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 435 macros
[0m17:55:00.291309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd3e4c26-57da-49e9-85b3-a56d0b2cd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4cd0fd090>]}
[0m17:55:00.293444 [info ] [MainThread]: 
[0m17:55:00.294547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:00.295347 [info ] [MainThread]: 
[0m17:55:00.296502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:55:00.300380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m17:55:00.342814 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m17:55:00.343866 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:55:00.344894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:00.354611 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m17:55:00.356511 [debug] [ThreadPool]: On list_analytics: Close
[0m17:55:00.358683 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m17:55:00.361130 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:55:00.362436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:00.369593 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m17:55:00.371523 [debug] [ThreadPool]: On list_analytics: Close
[0m17:55:00.373925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_silver)
[0m17:55:00.380144 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m17:55:00.381340 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m17:55:00.381961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:00.389216 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:55:00.390622 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m17:55:00.391407 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m17:55:00.395431 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m17:55:00.397266 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m17:55:00.398158 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m17:55:00.399307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m17:55:00.401341 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m17:55:00.402022 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m17:55:00.403118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:00.410959 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m17:55:00.412138 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m17:55:00.413174 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m17:55:00.416571 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m17:55:00.418641 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m17:55:00.419668 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m17:55:00.424427 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:00.425730 [debug] [MainThread]: On master: BEGIN
[0m17:55:00.426638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:00.434791 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:55:00.435981 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:00.436805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:55:00.440760 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m17:55:00.442139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd3e4c26-57da-49e9-85b3-a56d0b2cd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4cd94e7d0>]}
[0m17:55:00.443205 [debug] [MainThread]: On master: ROLLBACK
[0m17:55:00.444156 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:00.444818 [debug] [MainThread]: On master: BEGIN
[0m17:55:00.445922 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:55:00.446783 [debug] [MainThread]: On master: COMMIT
[0m17:55:00.447682 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:00.448581 [debug] [MainThread]: On master: COMMIT
[0m17:55:00.449501 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:55:00.450206 [debug] [MainThread]: On master: Close
[0m17:55:00.455700 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m17:55:00.456927 [info ] [Thread-1 (]: 1 of 4 START sql view model silver.stg_weather ................................. [RUN]
[0m17:55:00.457998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now model.weather_dbt.stg_weather)
[0m17:55:00.459562 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m17:55:00.465360 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m17:55:00.472822 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m17:55:00.495434 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.stg_weather"
[0m17:55:00.502876 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m17:55:00.504131 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: BEGIN
[0m17:55:00.505077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:00.512373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:55:00.513839 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m17:55:00.514888 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */

  create view "analytics"."silver"."stg_weather__dbt_tmp"
    
    
  as (
    


WITH ranked_weather AS (
    SELECT
        day:: DATE AS day,
        city_name:: VARCHAR AS city_name,
        latitude:: NUMERIC AS latitude,
        longitude:: NUMERIC AS longitude,
        temp_max:: NUMERIC AS temp_max,
        temp_min:: NUMERIC AS temp_min,
        precipitation_sum:: NUMERIC AS precipitation_sum,
        ingested_at:: TIMESTAMP AS ingested_at,
        ROW_NUMBER() OVER(PARTITION BY city_name, day ORDER BY ingested_at DESC) AS rn
    FROM "analytics"."bronze"."weather_raw"
),

deduped_weather AS (
    SELECT
        -- Surrogate key: hash of business key + latest timestamp
        MD5(
            city_name || '|' || CAST(day AS STRING)) AS weather_surrogate_key,
        
        -- Cast types cleanly
        CAST(day AS DATE) AS observation_date,
        CAST(city_name AS VARCHAR(50)) AS city_name,
        CAST(latitude AS DECIMAL(9,6)) AS latitude,
        CAST(longitude AS DECIMAL(9,6)) AS longitude,
        CAST(temp_max AS DECIMAL(5,2)) AS temp_max_celsius,
        CAST(temp_min AS DECIMAL(5,2)) AS temp_min_celsius,
        CAST(precipitation_sum AS DECIMAL(6,2)) AS precipitation_mm,
        CAST(ingested_at AS TIMESTAMP) AS ingested_at
    FROM ranked_weather
    WHERE rn = 1  -- Keep only latest record per city per day
        AND city_name IS NOT NULL 
        AND latitude IS NOT NULL 
        AND longitude IS NOT NULL
        AND day IS NOT NULL
        AND temp_max IS NOT NULL 
        AND temp_min IS NOT NULL
)


SELECT * FROM deduped_weather;
  );
[0m17:55:00.517103 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 50: SELECT * FROM deduped_weather;
                                      ^

[0m17:55:00.517907 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: ROLLBACK
[0m17:55:00.518928 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: Close
[0m17:55:00.526090 [debug] [Thread-1 (]: Database Error in model stg_weather (models/silver/stg_weather.sql)
  syntax error at or near ";"
  LINE 50: SELECT * FROM deduped_weather;
                                        ^
  compiled code at target/run/weather_dbt/models/silver/stg_weather.sql
[0m17:55:00.529324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd3e4c26-57da-49e9-85b3-a56d0b2cd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4ca3dc310>]}
[0m17:55:00.531028 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model silver.stg_weather ........................ [[31mERROR[0m in 0.07s]
[0m17:55:00.532112 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m17:55:00.533306 [debug] [Thread-4 (]: Marking all children of 'model.weather_dbt.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/silver/stg_weather.sql)
  syntax error at or near ";"
  LINE 50: SELECT * FROM deduped_weather;
                                        ^
  compiled code at target/run/weather_dbt/models/silver/stg_weather.sql.
[0m17:55:00.535043 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m17:55:00.535802 [info ] [Thread-1 (]: 2 of 4 SKIP relation gold.dim_date ............................................. [[33mSKIP[0m]
[0m17:55:00.536643 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m17:55:00.537398 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m17:55:00.538308 [info ] [Thread-1 (]: 3 of 4 SKIP relation gold.dim_location ......................................... [[33mSKIP[0m]
[0m17:55:00.539280 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m17:55:00.540435 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m17:55:00.541262 [info ] [Thread-1 (]: 4 of 4 SKIP relation gold.fct_weather_daily .................................... [[33mSKIP[0m]
[0m17:55:00.541982 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m17:55:00.544223 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:00.545103 [debug] [MainThread]: On master: BEGIN
[0m17:55:00.545854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:00.553217 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:55:00.554469 [debug] [MainThread]: On master: COMMIT
[0m17:55:00.555415 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:00.556332 [debug] [MainThread]: On master: COMMIT
[0m17:55:00.557298 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:55:00.558086 [debug] [MainThread]: On master: Close
[0m17:55:00.559990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:00.561182 [debug] [MainThread]: Connection 'model.weather_dbt.stg_weather' was properly closed.
[0m17:55:00.562083 [info ] [MainThread]: 
[0m17:55:00.563496 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m17:55:00.564940 [debug] [MainThread]: Command end result
[0m17:55:00.597333 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m17:55:00.603277 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m17:55:00.612588 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m17:55:00.613768 [info ] [MainThread]: 
[0m17:55:00.614718 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:55:00.615627 [info ] [MainThread]: 
[0m17:55:00.616506 [error] [MainThread]: [31mFailure in model stg_weather (models/silver/stg_weather.sql)[0m
[0m17:55:00.617356 [error] [MainThread]:   Database Error in model stg_weather (models/silver/stg_weather.sql)
  syntax error at or near ";"
  LINE 50: SELECT * FROM deduped_weather;
                                        ^
  compiled code at target/run/weather_dbt/models/silver/stg_weather.sql
[0m17:55:00.618175 [info ] [MainThread]: 
[0m17:55:00.619018 [info ] [MainThread]:   compiled code at target/compiled/weather_dbt/models/silver/stg_weather.sql
[0m17:55:00.619827 [info ] [MainThread]: 
[0m17:55:00.620638 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=4
[0m17:55:00.622302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6305517, "process_in_blocks": "70480", "process_kernel_time": 0.697414, "process_mem_max_rss": "131136", "process_out_blocks": "0", "process_user_time": 2.45139}
[0m17:55:00.623529 [debug] [MainThread]: Command `dbt run` failed at 17:55:00.623420 after 1.63 seconds
[0m17:55:00.624316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4cc7f3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4cbccd410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b4cbe3d690>]}
[0m17:55:00.625071 [debug] [MainThread]: Flushing usage events
[0m17:55:02.144764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:47.504011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c8c5d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c8e4f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c8c8cf50>]}


============================== 17:59:47.512406 | b958f600-e6a0-453c-84ed-e65da8ed87f8 ==============================
[0m17:59:47.512406 [info ] [MainThread]: Running with dbt=1.10.7
[0m17:59:47.513486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:59:47.859643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b958f600-e6a0-453c-84ed-e65da8ed87f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c83d7f10>]}
[0m17:59:47.923736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b958f600-e6a0-453c-84ed-e65da8ed87f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16cb643bd0>]}
[0m17:59:47.925718 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:59:48.020821 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m17:59:48.344018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:59:48.347028 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/silver/stg_weather.sql
[0m17:59:48.759305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b958f600-e6a0-453c-84ed-e65da8ed87f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c8393690>]}
[0m17:59:48.849130 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m17:59:48.856759 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m17:59:48.900250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b958f600-e6a0-453c-84ed-e65da8ed87f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c77dc4d0>]}
[0m17:59:48.901467 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 435 macros
[0m17:59:48.902648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b958f600-e6a0-453c-84ed-e65da8ed87f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16ca90d610>]}
[0m17:59:48.905159 [info ] [MainThread]: 
[0m17:59:48.906285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:48.907849 [info ] [MainThread]: 
[0m17:59:48.909312 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:59:48.915056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m17:59:48.961086 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m17:59:48.963930 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:59:48.965106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:48.974541 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m17:59:48.976900 [debug] [ThreadPool]: On list_analytics: Close
[0m17:59:48.979917 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m17:59:48.981257 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:59:48.983501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:48.991915 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m17:59:48.993754 [debug] [ThreadPool]: On list_analytics: Close
[0m17:59:48.996056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_gold)
[0m17:59:49.001695 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m17:59:49.002788 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m17:59:49.003786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:49.010772 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:59:49.012945 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m17:59:49.013942 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m17:59:49.017959 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m17:59:49.019906 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m17:59:49.021178 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m17:59:49.022392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_gold, now list_analytics_silver)
[0m17:59:49.024583 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m17:59:49.025587 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m17:59:49.026578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:49.033985 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:59:49.035310 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m17:59:49.036373 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m17:59:49.040637 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m17:59:49.042412 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m17:59:49.043274 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m17:59:49.047984 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:49.049199 [debug] [MainThread]: On master: BEGIN
[0m17:59:49.050047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:49.056872 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:59:49.058174 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:49.059193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:59:49.065265 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m17:59:49.067101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b958f600-e6a0-453c-84ed-e65da8ed87f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c73cda90>]}
[0m17:59:49.068353 [debug] [MainThread]: On master: ROLLBACK
[0m17:59:49.069642 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:49.070806 [debug] [MainThread]: On master: BEGIN
[0m17:59:49.072239 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:59:49.073255 [debug] [MainThread]: On master: COMMIT
[0m17:59:49.073945 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:49.074558 [debug] [MainThread]: On master: COMMIT
[0m17:59:49.075751 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:59:49.076788 [debug] [MainThread]: On master: Close
[0m17:59:49.085433 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m17:59:49.087189 [info ] [Thread-1 (]: 1 of 4 START sql view model silver.stg_weather ................................. [RUN]
[0m17:59:49.089057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_silver, now model.weather_dbt.stg_weather)
[0m17:59:49.090550 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m17:59:49.097368 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m17:59:49.105613 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m17:59:49.134539 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.stg_weather"
[0m17:59:49.142895 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m17:59:49.144081 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: BEGIN
[0m17:59:49.145069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:49.152176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:59:49.153439 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m17:59:49.154336 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */

  create view "analytics"."silver"."stg_weather__dbt_tmp"
    
    
  as (
    

WITH ranked_weather AS (
    SELECT
        *,  -- Keep raw types, cast later
        ROW_NUMBER() OVER(
            PARTITION BY city_name, day 
            ORDER BY ingested_at DESC
        ) AS rn
    FROM "analytics"."bronze"."weather_raw"
),  -- ✅ Fixed: Added comma

deduped_weather AS (
    SELECT
        MD5(city_name || '|' || day::TEXT) AS weather_surrogate_key,  -- ✅ PostgreSQL fix
        
        CAST(day AS DATE) AS observation_date,
        CAST(city_name AS VARCHAR(50)) AS city_name,
        CAST(latitude AS DECIMAL(9,6)) AS latitude,
        CAST(longitude AS DECIMAL(9,6)) AS longitude,
        CAST(temp_max AS DECIMAL(5,2)) AS temp_max_celsius,
        CAST(temp_min AS DECIMAL(5,2)) AS temp_min_celsius,
        CAST(precipitation_sum AS DECIMAL(6,2)) AS precipitation_mm,
        CAST(ingested_at AS TIMESTAMP) AS ingested_at
    FROM ranked_weather
    WHERE rn = 1
        AND city_name IS NOT NULL 
        AND latitude IS NOT NULL 
        AND longitude IS NOT NULL
        AND day IS NOT NULL
        AND temp_max IS NOT NULL 
        AND temp_min IS NOT NULL
)

SELECT * FROM deduped_weather
  );
[0m17:59:49.166780 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:59:49.172149 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m17:59:49.173492 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m17:59:49.175720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:49.186922 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m17:59:49.188490 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m17:59:49.189535 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m17:59:49.192107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:59:49.198790 [debug] [Thread-1 (]: Applying DROP to: "analytics"."silver"."stg_weather__dbt_backup"
[0m17:59:49.203656 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m17:59:49.204647 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
drop view if exists "analytics"."silver"."stg_weather__dbt_backup" cascade
[0m17:59:49.206269 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:59:49.209422 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: Close
[0m17:59:49.213689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b958f600-e6a0-453c-84ed-e65da8ed87f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c7f18110>]}
[0m17:59:49.215349 [info ] [Thread-1 (]: 1 of 4 OK created sql view model silver.stg_weather ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m17:59:49.216542 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m17:59:49.218223 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m17:59:49.219213 [info ] [Thread-1 (]: 2 of 4 START sql table model gold.dim_date ..................................... [RUN]
[0m17:59:49.220159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m17:59:49.221098 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m17:59:49.225089 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m17:59:49.235327 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m17:59:49.250943 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_date"
[0m17:59:49.261124 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m17:59:49.263473 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: BEGIN
[0m17:59:49.264897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:49.272867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:59:49.274006 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m17:59:49.275384 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */

  
    

  create  table "analytics"."gold"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    SELECT
        min(day) as min_day,
        max(day) as max_day
    FROM "analytics"."silver"."stg_weather"    
),
dates as (
    select generate_series(min_day, max_day, interval '1 day')::date as date_day
    from bounds
)
SELECT
    date_day,
    extract(year from date_day)::int as year,
    extract(month from date_day)::int as month,
    to_char(date_day, 'Mon')  as month_name,
    extract(day from date_day) as day_of_month,
    extract(dow from date_day)::int as day_of_week,
    to_char(date_day, 'Dy') as day_name,
    case when extract(dow from date_day) in (0,6) then true else false end as is_weekend
FROM dates
  );
  
[0m17:59:49.278667 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "day" does not exist
LINE 16:         min(day) as min_day,
                     ^

[0m17:59:49.279992 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: ROLLBACK
[0m17:59:49.281294 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: Close
[0m17:59:49.292231 [debug] [Thread-1 (]: Database Error in model dim_date (models/gold/dim_date.sql)
  column "day" does not exist
  LINE 16:         min(day) as min_day,
                       ^
  compiled code at target/run/weather_dbt/models/gold/dim_date.sql
[0m17:59:49.293386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b958f600-e6a0-453c-84ed-e65da8ed87f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c444c790>]}
[0m17:59:49.294500 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model gold.dim_date ............................ [[31mERROR[0m in 0.07s]
[0m17:59:49.295755 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m17:59:49.296561 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m17:59:49.297446 [debug] [Thread-4 (]: Marking all children of 'model.weather_dbt.dim_date' to be skipped because of status 'error'.  Reason: Database Error in model dim_date (models/gold/dim_date.sql)
  column "day" does not exist
  LINE 16:         min(day) as min_day,
                       ^
  compiled code at target/run/weather_dbt/models/gold/dim_date.sql.
[0m17:59:49.298905 [info ] [Thread-1 (]: 3 of 4 START sql table model gold.dim_location ................................. [RUN]
[0m17:59:49.301221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m17:59:49.302250 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m17:59:49.305304 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m17:59:49.315302 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m17:59:49.319135 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_location"
[0m17:59:49.328595 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m17:59:49.329914 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: BEGIN
[0m17:59:49.331145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:49.340142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:59:49.341380 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m17:59:49.342341 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */

  
    

  create  table "analytics"."gold"."dim_location__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    latitude,
    longitude
FROM "analytics"."silver"."stg_weather"
  );
  
[0m17:59:49.349049 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m17:59:49.354785 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m17:59:49.355914 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location__dbt_tmp" rename to "dim_location"
[0m17:59:49.357866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:49.359854 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m17:59:49.360961 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m17:59:49.362768 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m17:59:49.366482 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:59:49.370099 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_location__dbt_backup"
[0m17:59:49.374336 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m17:59:49.375468 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
drop table if exists "analytics"."gold"."dim_location__dbt_backup" cascade
[0m17:59:49.376900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m17:59:49.378971 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: Close
[0m17:59:49.380491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b958f600-e6a0-453c-84ed-e65da8ed87f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c83c4c50>]}
[0m17:59:49.382895 [info ] [Thread-1 (]: 3 of 4 OK created sql table model gold.dim_location ............................ [[32mSELECT 0[0m in 0.08s]
[0m17:59:49.384971 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m17:59:49.385942 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m17:59:49.386982 [info ] [Thread-1 (]: 4 of 4 START sql table model gold.fct_weather_daily ............................ [RUN]
[0m17:59:49.388703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m17:59:49.389604 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m17:59:49.392564 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m17:59:49.401178 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m17:59:49.404951 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.fct_weather_daily"
[0m17:59:49.416369 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m17:59:49.417830 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: BEGIN
[0m17:59:49.419084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:49.426144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:59:49.427406 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m17:59:49.428805 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */

  
    

  create  table "analytics"."gold"."fct_weather_daily__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_metrics AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        
        -- Basic metrics
        (temp_max_celsius + temp_min_celsius) / 2 AS avg_temp,
        temp_max_celsius AS max_temp,
        temp_min_celsius AS min_temp,
        precipitation_mm AS total_precipitation,
        
        -- 7-day moving average temperature
        AVG((temp_max_celsius + temp_min_celsius) / 2) 
            OVER (
                PARTITION BY city_name 
                ORDER BY observation_date 
                ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ) AS moving_avg_7d_temp

    FROM "analytics"."silver"."stg_weather"
),

final_summary AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        ROUND(avg_temp, 2) AS avg_temp,
        ROUND(max_temp, 2) AS max_temp,
        ROUND(min_temp, 2) AS min_temp,
        ROUND(total_precipitation, 2) AS total_precipitation,
        ROUND(moving_avg_7d_temp, 2) AS moving_avg_7d_temp

    FROM daily_metrics
)

SELECT * FROM final_summary
  );
  
[0m17:59:49.441830 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m17:59:49.446578 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m17:59:49.448018 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily__dbt_tmp" rename to "fct_weather_daily"
[0m17:59:49.449767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:59:49.451525 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m17:59:49.452337 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m17:59:49.453009 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m17:59:49.455242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:59:49.458179 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."fct_weather_daily__dbt_backup"
[0m17:59:49.459614 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m17:59:49.460860 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
drop table if exists "analytics"."gold"."fct_weather_daily__dbt_backup" cascade
[0m17:59:49.463971 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:59:49.466479 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: Close
[0m17:59:49.468490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b958f600-e6a0-453c-84ed-e65da8ed87f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c421c5d0>]}
[0m17:59:49.470211 [info ] [Thread-1 (]: 4 of 4 OK created sql table model gold.fct_weather_daily ....................... [[32mSELECT 0[0m in 0.08s]
[0m17:59:49.471604 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m17:59:49.473606 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:49.474649 [debug] [MainThread]: On master: BEGIN
[0m17:59:49.475536 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:49.484808 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m17:59:49.486029 [debug] [MainThread]: On master: COMMIT
[0m17:59:49.487414 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:49.488649 [debug] [MainThread]: On master: COMMIT
[0m17:59:49.489576 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:59:49.490329 [debug] [MainThread]: On master: Close
[0m17:59:49.491333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:49.492540 [debug] [MainThread]: Connection 'model.weather_dbt.fct_weather_daily' was properly closed.
[0m17:59:49.493938 [info ] [MainThread]: 
[0m17:59:49.495205 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m17:59:49.496941 [debug] [MainThread]: Command end result
[0m17:59:49.536114 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m17:59:49.543208 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m17:59:49.552983 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m17:59:49.554208 [info ] [MainThread]: 
[0m17:59:49.555701 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:59:49.557273 [info ] [MainThread]: 
[0m17:59:49.559039 [error] [MainThread]: [31mFailure in model dim_date (models/gold/dim_date.sql)[0m
[0m17:59:49.560388 [error] [MainThread]:   Database Error in model dim_date (models/gold/dim_date.sql)
  column "day" does not exist
  LINE 16:         min(day) as min_day,
                       ^
  compiled code at target/run/weather_dbt/models/gold/dim_date.sql
[0m17:59:49.562352 [info ] [MainThread]: 
[0m17:59:49.563967 [info ] [MainThread]:   compiled code at target/compiled/weather_dbt/models/gold/dim_date.sql
[0m17:59:49.565132 [info ] [MainThread]: 
[0m17:59:49.566146 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m17:59:49.569313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1187375, "process_in_blocks": "70480", "process_kernel_time": 0.771909, "process_mem_max_rss": "132200", "process_out_blocks": "0", "process_user_time": 2.615041}
[0m17:59:49.570779 [debug] [MainThread]: Command `dbt run` failed at 17:59:49.570649 after 2.12 seconds
[0m17:59:49.571816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c8c5d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c4350cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b16c8c5e6d0>]}
[0m17:59:49.573627 [debug] [MainThread]: Flushing usage events
[0m17:59:50.973691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:02:50.801962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720819ee0290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720819f105d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720819f10490>]}


============================== 18:02:50.808423 | 02e614d1-f92e-4e2f-92e9-19c828345096 ==============================
[0m18:02:50.808423 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:02:50.809290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:02:51.028501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02e614d1-f92e-4e2f-92e9-19c828345096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720819d8b250>]}
[0m18:02:51.065698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02e614d1-f92e-4e2f-92e9-19c828345096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72081c8a7d10>]}
[0m18:02:51.067912 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:02:51.147436 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:02:51.393007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:02:51.394401 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/gold/dim_date.sql
[0m18:02:51.554030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02e614d1-f92e-4e2f-92e9-19c828345096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7208185c71d0>]}
[0m18:02:51.685827 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:02:51.693177 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:02:51.727649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02e614d1-f92e-4e2f-92e9-19c828345096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720818562590>]}
[0m18:02:51.729696 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 435 macros
[0m18:02:51.730953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e614d1-f92e-4e2f-92e9-19c828345096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7208181e0510>]}
[0m18:02:51.733531 [info ] [MainThread]: 
[0m18:02:51.734787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:51.736777 [info ] [MainThread]: 
[0m18:02:51.737909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:02:51.742935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m18:02:51.780384 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:02:51.781610 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:02:51.782623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:51.791820 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m18:02:51.793817 [debug] [ThreadPool]: On list_analytics: Close
[0m18:02:51.796351 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:02:51.797379 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:02:51.798313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:51.806328 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m18:02:51.808079 [debug] [ThreadPool]: On list_analytics: Close
[0m18:02:51.810375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_silver)
[0m18:02:51.815159 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:02:51.816234 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:02:51.817036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:51.824080 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:02:51.825377 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:02:51.826411 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:02:51.830287 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:02:51.832000 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:02:51.833065 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:02:51.834288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m18:02:51.836570 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:02:51.837391 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:02:51.838323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:51.845086 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:02:51.846311 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:02:51.847332 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:02:51.850883 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m18:02:51.852438 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:02:51.853481 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:02:51.858142 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:51.859353 [debug] [MainThread]: On master: BEGIN
[0m18:02:51.860446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:51.866626 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:02:51.867707 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:51.868533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:02:51.872772 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m18:02:51.874357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e614d1-f92e-4e2f-92e9-19c828345096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720818179190>]}
[0m18:02:51.875630 [debug] [MainThread]: On master: ROLLBACK
[0m18:02:51.876788 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:51.877647 [debug] [MainThread]: On master: BEGIN
[0m18:02:51.878957 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:02:51.879830 [debug] [MainThread]: On master: COMMIT
[0m18:02:51.880655 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:51.881282 [debug] [MainThread]: On master: COMMIT
[0m18:02:51.882379 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:02:51.883541 [debug] [MainThread]: On master: Close
[0m18:02:51.890944 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m18:02:51.892406 [info ] [Thread-1 (]: 1 of 4 START sql view model silver.stg_weather ................................. [RUN]
[0m18:02:51.893769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now model.weather_dbt.stg_weather)
[0m18:02:51.894637 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m18:02:51.899479 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m18:02:51.908439 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m18:02:51.930851 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.stg_weather"
[0m18:02:51.940041 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:02:51.941013 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: BEGIN
[0m18:02:51.941935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:51.949080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:02:51.950429 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:02:51.951877 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */

  create view "analytics"."silver"."stg_weather__dbt_tmp"
    
    
  as (
    

WITH ranked_weather AS (
    SELECT
        *,  -- Keep raw types, cast later
        ROW_NUMBER() OVER(
            PARTITION BY city_name, day 
            ORDER BY ingested_at DESC
        ) AS rn
    FROM "analytics"."bronze"."weather_raw"
),  -- ✅ Fixed: Added comma

deduped_weather AS (
    SELECT
        MD5(city_name || '|' || day::TEXT) AS weather_surrogate_key,  -- ✅ PostgreSQL fix
        
        CAST(day AS DATE) AS observation_date,
        CAST(city_name AS VARCHAR(50)) AS city_name,
        CAST(latitude AS DECIMAL(9,6)) AS latitude,
        CAST(longitude AS DECIMAL(9,6)) AS longitude,
        CAST(temp_max AS DECIMAL(5,2)) AS temp_max_celsius,
        CAST(temp_min AS DECIMAL(5,2)) AS temp_min_celsius,
        CAST(precipitation_sum AS DECIMAL(6,2)) AS precipitation_mm,
        CAST(ingested_at AS TIMESTAMP) AS ingested_at
    FROM ranked_weather
    WHERE rn = 1
        AND city_name IS NOT NULL 
        AND latitude IS NOT NULL 
        AND longitude IS NOT NULL
        AND day IS NOT NULL
        AND temp_max IS NOT NULL 
        AND temp_min IS NOT NULL
)

SELECT * FROM deduped_weather
  );
[0m18:02:51.957145 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:02:51.962312 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:02:51.963577 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather" rename to "stg_weather__dbt_backup"
[0m18:02:51.965545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:02:51.968557 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:02:51.969652 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m18:02:51.971279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:02:51.981365 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:02:51.982666 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:02:51.983763 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:02:51.985961 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:02:51.990878 [debug] [Thread-1 (]: Applying DROP to: "analytics"."silver"."stg_weather__dbt_backup"
[0m18:02:51.995394 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:02:51.996481 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
drop view if exists "analytics"."silver"."stg_weather__dbt_backup" cascade
[0m18:02:52.001341 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m18:02:52.003822 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: Close
[0m18:02:52.006336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02e614d1-f92e-4e2f-92e9-19c828345096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7208152c9f10>]}
[0m18:02:52.008014 [info ] [Thread-1 (]: 1 of 4 OK created sql view model silver.stg_weather ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m18:02:52.009156 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m18:02:52.010628 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m18:02:52.011776 [info ] [Thread-1 (]: 2 of 4 START sql table model gold.dim_date ..................................... [RUN]
[0m18:02:52.012995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m18:02:52.013898 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m18:02:52.016902 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m18:02:52.025767 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m18:02:52.038850 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_date"
[0m18:02:52.048413 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:02:52.049502 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: BEGIN
[0m18:02:52.050524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:52.057556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:02:52.058718 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:02:52.059579 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */

  
    

  create  table "analytics"."gold"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    SELECT
        min(observation_date) as min_day,
        max(observation_date) as max_day
    FROM "analytics"."silver"."stg_weather"    
),
dates as (
    select generate_series(min_day, max_day, interval '1 day')::date as date_day
    from bounds
)
SELECT
    date_day,
    extract(year from observation_date)::int as year,
    extract(month from observation_date)::int as month,
    to_char(observation_date, 'Mon')  as month_name,
    extract(day from observation_date) as day_of_month,
    extract(dow from observation_date)::int as day_of_week,
    to_char(observation_date, 'Dy') as day_name,
    case when extract(dow from observation_date) in (0,6) then true else false end as is_weekend
FROM dates
  );
  
[0m18:02:52.064434 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "observation_date" does not exist
LINE 26:     extract(year from observation_date)::int as year,
                               ^

[0m18:02:52.065740 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: ROLLBACK
[0m18:02:52.067058 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: Close
[0m18:02:52.075519 [debug] [Thread-1 (]: Database Error in model dim_date (models/gold/dim_date.sql)
  column "observation_date" does not exist
  LINE 26:     extract(year from observation_date)::int as year,
                                 ^
  compiled code at target/run/weather_dbt/models/gold/dim_date.sql
[0m18:02:52.076714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02e614d1-f92e-4e2f-92e9-19c828345096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72080f549390>]}
[0m18:02:52.077760 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model gold.dim_date ............................ [[31mERROR[0m in 0.06s]
[0m18:02:52.078846 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m18:02:52.079996 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m18:02:52.080557 [debug] [Thread-4 (]: Marking all children of 'model.weather_dbt.dim_date' to be skipped because of status 'error'.  Reason: Database Error in model dim_date (models/gold/dim_date.sql)
  column "observation_date" does not exist
  LINE 26:     extract(year from observation_date)::int as year,
                                 ^
  compiled code at target/run/weather_dbt/models/gold/dim_date.sql.
[0m18:02:52.081516 [info ] [Thread-1 (]: 3 of 4 START sql table model gold.dim_location ................................. [RUN]
[0m18:02:52.083719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m18:02:52.084405 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m18:02:52.087403 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m18:02:52.096244 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m18:02:52.099318 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_location"
[0m18:02:52.108415 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:02:52.109380 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: BEGIN
[0m18:02:52.110231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:52.116171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:02:52.117251 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:02:52.117996 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */

  
    

  create  table "analytics"."gold"."dim_location__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    latitude,
    longitude
FROM "analytics"."silver"."stg_weather"
  );
  
[0m18:02:52.121099 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m18:02:52.125948 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:02:52.128613 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location" rename to "dim_location__dbt_backup"
[0m18:02:52.130122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:02:52.133494 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:02:52.134792 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location__dbt_tmp" rename to "dim_location"
[0m18:02:52.136054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:02:52.137506 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:02:52.138401 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:02:52.139173 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:02:52.141260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:02:52.143747 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_location__dbt_backup"
[0m18:02:52.146964 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:02:52.148003 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
drop table if exists "analytics"."gold"."dim_location__dbt_backup" cascade
[0m18:02:52.151568 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:02:52.153528 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: Close
[0m18:02:52.154832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02e614d1-f92e-4e2f-92e9-19c828345096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72080f5d7c10>]}
[0m18:02:52.156150 [info ] [Thread-1 (]: 3 of 4 OK created sql table model gold.dim_location ............................ [[32mSELECT 0[0m in 0.07s]
[0m18:02:52.157379 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m18:02:52.158201 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m18:02:52.159013 [info ] [Thread-1 (]: 4 of 4 START sql table model gold.fct_weather_daily ............................ [RUN]
[0m18:02:52.160068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m18:02:52.160938 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m18:02:52.163700 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m18:02:52.171761 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m18:02:52.174647 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.fct_weather_daily"
[0m18:02:52.183310 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:02:52.184468 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: BEGIN
[0m18:02:52.185537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:52.191649 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:02:52.192623 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:02:52.193565 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */

  
    

  create  table "analytics"."gold"."fct_weather_daily__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_metrics AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        
        -- Basic metrics
        (temp_max_celsius + temp_min_celsius) / 2 AS avg_temp,
        temp_max_celsius AS max_temp,
        temp_min_celsius AS min_temp,
        precipitation_mm AS total_precipitation,
        
        -- 7-day moving average temperature
        AVG((temp_max_celsius + temp_min_celsius) / 2) 
            OVER (
                PARTITION BY city_name 
                ORDER BY observation_date 
                ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ) AS moving_avg_7d_temp

    FROM "analytics"."silver"."stg_weather"
),

final_summary AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        ROUND(avg_temp, 2) AS avg_temp,
        ROUND(max_temp, 2) AS max_temp,
        ROUND(min_temp, 2) AS min_temp,
        ROUND(total_precipitation, 2) AS total_precipitation,
        ROUND(moving_avg_7d_temp, 2) AS moving_avg_7d_temp

    FROM daily_metrics
)

SELECT * FROM final_summary
  );
  
[0m18:02:52.200254 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m18:02:52.203417 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:02:52.204188 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily" rename to "fct_weather_daily__dbt_backup"
[0m18:02:52.205140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:02:52.207115 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:02:52.207767 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily__dbt_tmp" rename to "fct_weather_daily"
[0m18:02:52.208671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:02:52.209795 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:02:52.210479 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:02:52.211141 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:02:52.213228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:02:52.215778 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."fct_weather_daily__dbt_backup"
[0m18:02:52.216963 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:02:52.217872 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
drop table if exists "analytics"."gold"."fct_weather_daily__dbt_backup" cascade
[0m18:02:52.220586 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:02:52.222479 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: Close
[0m18:02:52.223594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02e614d1-f92e-4e2f-92e9-19c828345096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7208152908d0>]}
[0m18:02:52.224640 [info ] [Thread-1 (]: 4 of 4 OK created sql table model gold.fct_weather_daily ....................... [[32mSELECT 0[0m in 0.06s]
[0m18:02:52.225772 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m18:02:52.227789 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:52.228526 [debug] [MainThread]: On master: BEGIN
[0m18:02:52.229328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:52.235169 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:02:52.236112 [debug] [MainThread]: On master: COMMIT
[0m18:02:52.236798 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:52.237356 [debug] [MainThread]: On master: COMMIT
[0m18:02:52.238055 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:02:52.238625 [debug] [MainThread]: On master: Close
[0m18:02:52.239466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:52.240387 [debug] [MainThread]: Connection 'model.weather_dbt.fct_weather_daily' was properly closed.
[0m18:02:52.241220 [info ] [MainThread]: 
[0m18:02:52.242069 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m18:02:52.243110 [debug] [MainThread]: Command end result
[0m18:02:52.270813 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:02:52.275932 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:02:52.284575 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:02:52.285518 [info ] [MainThread]: 
[0m18:02:52.286400 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:02:52.287288 [info ] [MainThread]: 
[0m18:02:52.288223 [error] [MainThread]: [31mFailure in model dim_date (models/gold/dim_date.sql)[0m
[0m18:02:52.289098 [error] [MainThread]:   Database Error in model dim_date (models/gold/dim_date.sql)
  column "observation_date" does not exist
  LINE 26:     extract(year from observation_date)::int as year,
                                 ^
  compiled code at target/run/weather_dbt/models/gold/dim_date.sql
[0m18:02:52.289842 [info ] [MainThread]: 
[0m18:02:52.290593 [info ] [MainThread]:   compiled code at target/compiled/weather_dbt/models/gold/dim_date.sql
[0m18:02:52.291634 [info ] [MainThread]: 
[0m18:02:52.292671 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m18:02:52.294603 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5519676, "process_in_blocks": "70480", "process_kernel_time": 0.615745, "process_mem_max_rss": "130700", "process_out_blocks": "0", "process_user_time": 2.05659}
[0m18:02:52.295550 [debug] [MainThread]: Command `dbt run` failed at 18:02:52.295472 after 1.55 seconds
[0m18:02:52.296485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720819f2b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720819f2bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72081a0e3d50>]}
[0m18:02:52.297352 [debug] [MainThread]: Flushing usage events
[0m18:02:53.756310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:08.825010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a4e89990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a4ed9c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a4edb150>]}


============================== 18:04:08.831366 | 841fe1ac-8432-4f8a-9a34-eed2b15fce92 ==============================
[0m18:04:08.831366 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:04:08.832354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:04:09.066655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '841fe1ac-8432-4f8a-9a34-eed2b15fce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a4ed8c90>]}
[0m18:04:09.110563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '841fe1ac-8432-4f8a-9a34-eed2b15fce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a79579d0>]}
[0m18:04:09.112344 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:04:09.195782 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:04:09.444784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:09.445910 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/gold/dim_date.sql
[0m18:04:09.643025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '841fe1ac-8432-4f8a-9a34-eed2b15fce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a311c410>]}
[0m18:04:09.779356 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:04:09.785223 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:04:09.823084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '841fe1ac-8432-4f8a-9a34-eed2b15fce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a39cf750>]}
[0m18:04:09.824229 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 435 macros
[0m18:04:09.825386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841fe1ac-8432-4f8a-9a34-eed2b15fce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a3170190>]}
[0m18:04:09.827835 [info ] [MainThread]: 
[0m18:04:09.828913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:09.829663 [info ] [MainThread]: 
[0m18:04:09.830682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:09.834070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m18:04:09.872002 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:04:09.873198 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:04:09.874191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:09.881821 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m18:04:09.883327 [debug] [ThreadPool]: On list_analytics: Close
[0m18:04:09.885454 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:04:09.886296 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:04:09.887138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:09.894267 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m18:04:09.897048 [debug] [ThreadPool]: On list_analytics: Close
[0m18:04:09.899672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_gold)
[0m18:04:09.903884 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:04:09.904846 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:04:09.905760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:09.912931 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:04:09.914737 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:04:09.915618 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:04:09.919676 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m18:04:09.921386 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:04:09.922394 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:04:09.923771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_gold, now list_analytics_silver)
[0m18:04:09.926630 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:04:09.927705 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:04:09.928513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:09.933721 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:04:09.934734 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:04:09.935930 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:04:09.940089 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:04:09.942708 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:04:09.943918 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:04:09.948012 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:09.949159 [debug] [MainThread]: On master: BEGIN
[0m18:04:09.950489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:09.957123 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:04:09.958708 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:09.960774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:09.966703 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m18:04:09.968798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841fe1ac-8432-4f8a-9a34-eed2b15fce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a3536290>]}
[0m18:04:09.969903 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:09.970885 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:09.971912 [debug] [MainThread]: On master: BEGIN
[0m18:04:09.973104 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:04:09.973957 [debug] [MainThread]: On master: COMMIT
[0m18:04:09.975039 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:09.975893 [debug] [MainThread]: On master: COMMIT
[0m18:04:09.976869 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:09.977677 [debug] [MainThread]: On master: Close
[0m18:04:09.983813 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m18:04:09.984900 [info ] [Thread-1 (]: 1 of 4 START sql view model silver.stg_weather ................................. [RUN]
[0m18:04:09.986312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_silver, now model.weather_dbt.stg_weather)
[0m18:04:09.987775 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m18:04:09.993647 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m18:04:10.002386 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m18:04:10.024135 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.stg_weather"
[0m18:04:10.033906 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:04:10.035360 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: BEGIN
[0m18:04:10.036664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:10.042672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:04:10.043733 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:04:10.044656 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */

  create view "analytics"."silver"."stg_weather__dbt_tmp"
    
    
  as (
    

WITH ranked_weather AS (
    SELECT
        *,  -- Keep raw types, cast later
        ROW_NUMBER() OVER(
            PARTITION BY city_name, day 
            ORDER BY ingested_at DESC
        ) AS rn
    FROM "analytics"."bronze"."weather_raw"
),  -- ✅ Fixed: Added comma

deduped_weather AS (
    SELECT
        MD5(city_name || '|' || day::TEXT) AS weather_surrogate_key,  -- ✅ PostgreSQL fix
        
        CAST(day AS DATE) AS observation_date,
        CAST(city_name AS VARCHAR(50)) AS city_name,
        CAST(latitude AS DECIMAL(9,6)) AS latitude,
        CAST(longitude AS DECIMAL(9,6)) AS longitude,
        CAST(temp_max AS DECIMAL(5,2)) AS temp_max_celsius,
        CAST(temp_min AS DECIMAL(5,2)) AS temp_min_celsius,
        CAST(precipitation_sum AS DECIMAL(6,2)) AS precipitation_mm,
        CAST(ingested_at AS TIMESTAMP) AS ingested_at
    FROM ranked_weather
    WHERE rn = 1
        AND city_name IS NOT NULL 
        AND latitude IS NOT NULL 
        AND longitude IS NOT NULL
        AND day IS NOT NULL
        AND temp_max IS NOT NULL 
        AND temp_min IS NOT NULL
)

SELECT * FROM deduped_weather
  );
[0m18:04:10.049798 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:04:10.055727 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:04:10.056882 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather" rename to "stg_weather__dbt_backup"
[0m18:04:10.058773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:04:10.061799 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:04:10.062698 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m18:04:10.064939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:04:10.074540 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:04:10.075897 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:04:10.077082 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:04:10.080794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:04:10.086934 [debug] [Thread-1 (]: Applying DROP to: "analytics"."silver"."stg_weather__dbt_backup"
[0m18:04:10.091732 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:04:10.093206 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
drop view if exists "analytics"."silver"."stg_weather__dbt_backup" cascade
[0m18:04:10.096287 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:04:10.099717 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: Close
[0m18:04:10.102481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841fe1ac-8432-4f8a-9a34-eed2b15fce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f75be3d2d0>]}
[0m18:04:10.104004 [info ] [Thread-1 (]: 1 of 4 OK created sql view model silver.stg_weather ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m18:04:10.105136 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m18:04:10.106774 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m18:04:10.107805 [info ] [Thread-1 (]: 2 of 4 START sql table model gold.dim_date ..................................... [RUN]
[0m18:04:10.109165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m18:04:10.110111 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m18:04:10.113038 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m18:04:10.122482 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m18:04:10.137466 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_date"
[0m18:04:10.147192 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:04:10.148428 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: BEGIN
[0m18:04:10.149665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:10.157172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:04:10.158101 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:04:10.158999 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */

  
    

  create  table "analytics"."gold"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    SELECT
        min(observation_date) as min_day,
        max(observation_date) as max_day
    FROM "analytics"."silver"."stg_weather"    
),
dates as (
    select generate_series(min_day, max_day, interval '1 day')::date as date_day
    from bounds
)
SELECT
    date_day,
    extract(year from date_day)::int as year,
    extract(month from date_day)::int as month,
    to_char(date_day, 'Mon')  as month_name,
    extract(day from date_day) as day_of_month,
    extract(dow from date_day)::int as day_of_week,
    to_char(date_day, 'Dy') as day_name,
    case when extract(dow from date_day) in (0,6) then true else false end as is_weekend
FROM dates
  );
  
[0m18:04:10.168868 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m18:04:10.174957 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:04:10.176030 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
alter table "analytics"."gold"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:04:10.177684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:04:10.179007 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m18:04:10.179658 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:04:10.180297 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m18:04:10.181885 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:04:10.184551 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_date__dbt_backup"
[0m18:04:10.187002 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:04:10.188554 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
drop table if exists "analytics"."gold"."dim_date__dbt_backup" cascade
[0m18:04:10.190125 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:04:10.191521 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: Close
[0m18:04:10.193018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841fe1ac-8432-4f8a-9a34-eed2b15fce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f75be70bd0>]}
[0m18:04:10.194267 [info ] [Thread-1 (]: 2 of 4 OK created sql table model gold.dim_date ................................ [[32mSELECT 0[0m in 0.08s]
[0m18:04:10.195340 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m18:04:10.196005 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m18:04:10.196719 [info ] [Thread-1 (]: 3 of 4 START sql table model gold.dim_location ................................. [RUN]
[0m18:04:10.197529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m18:04:10.198266 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m18:04:10.201043 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m18:04:10.208845 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m18:04:10.213397 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_location"
[0m18:04:10.222300 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:04:10.223323 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: BEGIN
[0m18:04:10.223978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:10.230042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:04:10.231022 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:04:10.231652 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */

  
    

  create  table "analytics"."gold"."dim_location__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    latitude,
    longitude
FROM "analytics"."silver"."stg_weather"
  );
  
[0m18:04:10.235553 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m18:04:10.239181 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:04:10.240241 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location" rename to "dim_location__dbt_backup"
[0m18:04:10.241617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:04:10.243617 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:04:10.244448 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location__dbt_tmp" rename to "dim_location"
[0m18:04:10.245542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:10.247290 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:04:10.248272 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:04:10.249109 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:04:10.250864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:04:10.253140 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_location__dbt_backup"
[0m18:04:10.253901 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:04:10.254563 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
drop table if exists "analytics"."gold"."dim_location__dbt_backup" cascade
[0m18:04:10.257041 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:04:10.258717 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: Close
[0m18:04:10.259661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841fe1ac-8432-4f8a-9a34-eed2b15fce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f75a557350>]}
[0m18:04:10.260851 [info ] [Thread-1 (]: 3 of 4 OK created sql table model gold.dim_location ............................ [[32mSELECT 0[0m in 0.06s]
[0m18:04:10.262703 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m18:04:10.263876 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m18:04:10.265165 [info ] [Thread-1 (]: 4 of 4 START sql table model gold.fct_weather_daily ............................ [RUN]
[0m18:04:10.266154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m18:04:10.266888 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m18:04:10.269313 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m18:04:10.276517 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m18:04:10.279656 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.fct_weather_daily"
[0m18:04:10.287433 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:04:10.288287 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: BEGIN
[0m18:04:10.288993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:10.295360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:04:10.296336 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:04:10.296991 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */

  
    

  create  table "analytics"."gold"."fct_weather_daily__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_metrics AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        
        -- Basic metrics
        (temp_max_celsius + temp_min_celsius) / 2 AS avg_temp,
        temp_max_celsius AS max_temp,
        temp_min_celsius AS min_temp,
        precipitation_mm AS total_precipitation,
        
        -- 7-day moving average temperature
        AVG((temp_max_celsius + temp_min_celsius) / 2) 
            OVER (
                PARTITION BY city_name 
                ORDER BY observation_date 
                ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ) AS moving_avg_7d_temp

    FROM "analytics"."silver"."stg_weather"
),

final_summary AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        ROUND(avg_temp, 2) AS avg_temp,
        ROUND(max_temp, 2) AS max_temp,
        ROUND(min_temp, 2) AS min_temp,
        ROUND(total_precipitation, 2) AS total_precipitation,
        ROUND(moving_avg_7d_temp, 2) AS moving_avg_7d_temp

    FROM daily_metrics
)

SELECT * FROM final_summary
  );
  
[0m18:04:10.302422 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m18:04:10.305507 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:04:10.306256 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily" rename to "fct_weather_daily__dbt_backup"
[0m18:04:10.308444 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:04:10.311443 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:04:10.312601 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily__dbt_tmp" rename to "fct_weather_daily"
[0m18:04:10.313935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:10.315376 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:04:10.316154 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:04:10.316895 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:04:10.318602 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:04:10.321123 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."fct_weather_daily__dbt_backup"
[0m18:04:10.322127 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:04:10.322873 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
drop table if exists "analytics"."gold"."fct_weather_daily__dbt_backup" cascade
[0m18:04:10.325656 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:04:10.328027 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: Close
[0m18:04:10.329102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841fe1ac-8432-4f8a-9a34-eed2b15fce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f75a529f10>]}
[0m18:04:10.330391 [info ] [Thread-1 (]: 4 of 4 OK created sql table model gold.fct_weather_daily ....................... [[32mSELECT 0[0m in 0.06s]
[0m18:04:10.331417 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m18:04:10.333231 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:10.333953 [debug] [MainThread]: On master: BEGIN
[0m18:04:10.334636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:10.340776 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:04:10.341603 [debug] [MainThread]: On master: COMMIT
[0m18:04:10.342183 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:10.342803 [debug] [MainThread]: On master: COMMIT
[0m18:04:10.343603 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:10.344416 [debug] [MainThread]: On master: Close
[0m18:04:10.345417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:10.346097 [debug] [MainThread]: Connection 'model.weather_dbt.fct_weather_daily' was properly closed.
[0m18:04:10.346808 [info ] [MainThread]: 
[0m18:04:10.347765 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m18:04:10.349012 [debug] [MainThread]: Command end result
[0m18:04:10.380037 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:04:10.384890 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:04:10.392527 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:04:10.393751 [info ] [MainThread]: 
[0m18:04:10.394780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:10.395576 [info ] [MainThread]: 
[0m18:04:10.396367 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:04:10.398023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6244471, "process_in_blocks": "70096", "process_kernel_time": 0.700998, "process_mem_max_rss": "129872", "process_out_blocks": "0", "process_user_time": 2.457718}
[0m18:04:10.400344 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:10.399988 after 1.63 seconds
[0m18:04:10.401355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a4efa650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a4efbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f7a94ee990>]}
[0m18:04:10.402362 [debug] [MainThread]: Flushing usage events
[0m18:04:11.695016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:13.905135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4e7c89210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4e7c7bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4e7cd3f50>]}


============================== 18:04:13.910359 | a6f9b588-e984-4aab-ae15-b2c2fd16de1b ==============================
[0m18:04:13.910359 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:04:13.911408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:04:14.029868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6f9b588-e984-4aab-ae15-b2c2fd16de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4e7c22850>]}
[0m18:04:14.069698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6f9b588-e984-4aab-ae15-b2c2fd16de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4ea650590>]}
[0m18:04:14.071254 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:04:14.147372 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:04:14.353821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:04:14.354931 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:04:14.382797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6f9b588-e984-4aab-ae15-b2c2fd16de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4e6b3b350>]}
[0m18:04:14.451587 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:04:14.457431 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:04:14.506008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6f9b588-e984-4aab-ae15-b2c2fd16de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4e5b73f10>]}
[0m18:04:14.507336 [info ] [MainThread]: Found 4 models, 14 data tests, 1 source, 435 macros
[0m18:04:14.508882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6f9b588-e984-4aab-ae15-b2c2fd16de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4e6ffea90>]}
[0m18:04:14.511363 [info ] [MainThread]: 
[0m18:04:14.512613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:14.513669 [info ] [MainThread]: 
[0m18:04:14.514891 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:14.518982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_silver'
[0m18:04:14.607495 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:04:14.608464 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:04:14.609174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:14.616483 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:04:14.617684 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:04:14.618286 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:04:14.622000 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:04:14.623437 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:04:14.624303 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:04:14.625678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m18:04:14.628163 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:04:14.629138 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:04:14.629886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:14.637061 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:04:14.638132 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:04:14.639049 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:04:14.642360 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m18:04:14.643912 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:04:14.644837 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:04:14.649553 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:14.650522 [debug] [MainThread]: On master: BEGIN
[0m18:04:14.651358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:14.656894 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:04:14.657834 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:14.658664 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:14.664032 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m18:04:14.666069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6f9b588-e984-4aab-ae15-b2c2fd16de1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4e5ff0510>]}
[0m18:04:14.667104 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:14.668232 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:14.668954 [debug] [MainThread]: On master: BEGIN
[0m18:04:14.669887 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:04:14.670673 [debug] [MainThread]: On master: COMMIT
[0m18:04:14.671434 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:14.672091 [debug] [MainThread]: On master: COMMIT
[0m18:04:14.672903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:14.673644 [debug] [MainThread]: On master: Close
[0m18:04:14.678498 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:04:14.679348 [info ] [Thread-1 (]: 1 of 14 START test accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj  [RUN]
[0m18:04:14.680980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816)
[0m18:04:14.682055 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:04:14.692810 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:04:14.700677 [debug] [Thread-1 (]: Began executing node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:04:14.713347 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:04:14.721607 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:04:14.722474 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: BEGIN
[0m18:04:14.723274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:14.730552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:04:14.731841 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:04:14.732748 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        city_name as value_field,
        count(*) as n_records

    from "analytics"."silver"."stg_weather"
    group by city_name

)

select *
from all_values
where value_field not in (
    'Kathmandu','Pokhara','Biratnagar','Birgunj'
)



  
  
      
    ) dbt_internal_test
[0m18:04:14.738542 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:04:14.741977 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: ROLLBACK
[0m18:04:14.743022 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: Close
[0m18:04:14.744283 [info ] [Thread-1 (]: 1 of 14 PASS accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj  [[32mPASS[0m in 0.06s]
[0m18:04:14.745642 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:04:14.746542 [debug] [Thread-1 (]: Began running node test.weather_dbt.dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500.bdb72781c2
[0m18:04:14.747675 [info ] [Thread-1 (]: 2 of 14 START test dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500  [RUN]
[0m18:04:14.748902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816, now test.weather_dbt.dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500.bdb72781c2)
[0m18:04:14.749575 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500.bdb72781c2
[0m18:04:14.760254 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500 (models/silver/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:04:14.761291 [error] [Thread-1 (]: 2 of 14 ERROR dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500  [[31mERROR[0m in 0.01s]
[0m18:04:14.762430 [debug] [Thread-1 (]: Finished running node test.weather_dbt.dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500.bdb72781c2
[0m18:04:14.763307 [debug] [Thread-1 (]: Began running node test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50.c4a6022088
[0m18:04:14.763684 [debug] [Thread-4 (]: Marking all children of 'test.weather_dbt.dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500.bdb72781c2' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500 (models/silver/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:04:14.764380 [info ] [Thread-1 (]: 3 of 14 START test dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50  [RUN]
[0m18:04:14.766531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500.bdb72781c2, now test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50.c4a6022088)
[0m18:04:14.767394 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50.c4a6022088
[0m18:04:14.773622 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50 (models/silver/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:04:14.774667 [error] [Thread-1 (]: 3 of 14 ERROR dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50  [[31mERROR[0m in 0.01s]
[0m18:04:14.775811 [debug] [Thread-1 (]: Finished running node test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50.c4a6022088
[0m18:04:14.776730 [debug] [Thread-1 (]: Began running node test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40.9bcdec8db0
[0m18:04:14.777239 [debug] [Thread-4 (]: Marking all children of 'test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50.c4a6022088' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50 (models/silver/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:04:14.778025 [info ] [Thread-1 (]: 4 of 14 START test dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40  [RUN]
[0m18:04:14.779351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50.c4a6022088, now test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40.9bcdec8db0)
[0m18:04:14.780045 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40.9bcdec8db0
[0m18:04:14.784423 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40 (models/silver/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:04:14.785470 [error] [Thread-1 (]: 4 of 14 ERROR dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40  [[31mERROR[0m in 0.01s]
[0m18:04:14.786484 [debug] [Thread-1 (]: Finished running node test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40.9bcdec8db0
[0m18:04:14.787124 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:04:14.787390 [debug] [Thread-4 (]: Marking all children of 'test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40.9bcdec8db0' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40 (models/silver/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:04:14.788088 [info ] [Thread-1 (]: 5 of 14 START test not_null_stg_weather_city_name .............................. [RUN]
[0m18:04:14.789522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40.9bcdec8db0, now test.weather_dbt.not_null_stg_weather_city_name.d57308e884)
[0m18:04:14.790170 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:04:14.794707 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:04:14.804048 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:04:14.806534 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:04:14.816164 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:04:14.817029 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: BEGIN
[0m18:04:14.817951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:14.825340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:04:14.826527 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:04:14.827265 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_name
from "analytics"."silver"."stg_weather"
where city_name is null



  
  
      
    ) dbt_internal_test
[0m18:04:14.829454 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:04:14.831126 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: ROLLBACK
[0m18:04:14.832136 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: Close
[0m18:04:14.833290 [info ] [Thread-1 (]: 5 of 14 PASS not_null_stg_weather_city_name .................................... [[32mPASS[0m in 0.04s]
[0m18:04:14.834489 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:04:14.835269 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:04:14.835958 [info ] [Thread-1 (]: 6 of 14 START test not_null_stg_weather_ingested_at ............................ [RUN]
[0m18:04:14.837046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_city_name.d57308e884, now test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516)
[0m18:04:14.837672 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:04:14.842662 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:04:14.851729 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:04:14.853908 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:04:14.864085 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:04:14.865318 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: BEGIN
[0m18:04:14.866331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:14.872471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:04:14.873653 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:04:14.874492 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ingested_at
from "analytics"."silver"."stg_weather"
where ingested_at is null



  
  
      
    ) dbt_internal_test
[0m18:04:14.877771 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:04:14.879940 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: ROLLBACK
[0m18:04:14.880984 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: Close
[0m18:04:14.881791 [info ] [Thread-1 (]: 6 of 14 PASS not_null_stg_weather_ingested_at .................................. [[32mPASS[0m in 0.04s]
[0m18:04:14.882771 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:04:14.883848 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:04:14.884820 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_weather_latitude ............................... [RUN]
[0m18:04:14.885999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516, now test.weather_dbt.not_null_stg_weather_latitude.35769df29a)
[0m18:04:14.886723 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:04:14.890946 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:04:14.899049 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:04:14.901217 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:04:14.912064 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:04:14.913355 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: BEGIN
[0m18:04:14.914227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:14.920340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:04:14.921665 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:04:14.922777 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from "analytics"."silver"."stg_weather"
where latitude is null



  
  
      
    ) dbt_internal_test
[0m18:04:14.925493 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:04:14.927161 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: ROLLBACK
[0m18:04:14.928334 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: Close
[0m18:04:14.929416 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_weather_latitude ..................................... [[32mPASS[0m in 0.04s]
[0m18:04:14.930715 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:04:14.932320 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:04:14.933160 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_weather_longitude .............................. [RUN]
[0m18:04:14.933972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_latitude.35769df29a, now test.weather_dbt.not_null_stg_weather_longitude.04815d6a63)
[0m18:04:14.934771 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:04:14.938528 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:04:14.946801 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:04:14.949255 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:04:14.959364 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:04:14.960520 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: BEGIN
[0m18:04:14.961552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:14.967361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:04:14.968685 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:04:14.969728 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from "analytics"."silver"."stg_weather"
where longitude is null



  
  
      
    ) dbt_internal_test
[0m18:04:14.972174 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:04:14.973776 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: ROLLBACK
[0m18:04:14.974515 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: Close
[0m18:04:14.975383 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_weather_longitude .................................... [[32mPASS[0m in 0.04s]
[0m18:04:14.976525 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:04:14.977630 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:04:14.978518 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_weather_observation_date ....................... [RUN]
[0m18:04:14.979309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_longitude.04815d6a63, now test.weather_dbt.not_null_stg_weather_observation_date.9a16015555)
[0m18:04:14.979935 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:04:14.984781 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:04:14.992962 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:04:14.995459 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:04:15.005271 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:04:15.006199 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: BEGIN
[0m18:04:15.007018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:15.012907 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:04:15.014145 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:04:15.015067 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select observation_date
from "analytics"."silver"."stg_weather"
where observation_date is null



  
  
      
    ) dbt_internal_test
[0m18:04:15.017539 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:04:15.019333 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: ROLLBACK
[0m18:04:15.020412 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: Close
[0m18:04:15.021449 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_weather_observation_date ............................. [[32mPASS[0m in 0.04s]
[0m18:04:15.022677 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:04:15.023733 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:04:15.024514 [info ] [Thread-1 (]: 10 of 14 START test not_null_stg_weather_precipitation_mm ...................... [RUN]
[0m18:04:15.025303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_observation_date.9a16015555, now test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4)
[0m18:04:15.026293 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:04:15.030338 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:04:15.038626 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:04:15.041459 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:04:15.051567 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:04:15.052558 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: BEGIN
[0m18:04:15.053203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:15.058699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:04:15.060036 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:04:15.061188 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select precipitation_mm
from "analytics"."silver"."stg_weather"
where precipitation_mm is null



  
  
      
    ) dbt_internal_test
[0m18:04:15.063689 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:04:15.065358 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: ROLLBACK
[0m18:04:15.066222 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: Close
[0m18:04:15.067259 [info ] [Thread-1 (]: 10 of 14 PASS not_null_stg_weather_precipitation_mm ............................ [[32mPASS[0m in 0.04s]
[0m18:04:15.068995 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:04:15.069919 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:04:15.070706 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_weather_temp_max_celsius ...................... [RUN]
[0m18:04:15.071713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4, now test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82)
[0m18:04:15.072697 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:04:15.077224 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:04:15.085432 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:04:15.090656 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:04:15.100130 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:04:15.102240 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: BEGIN
[0m18:04:15.103477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:15.109756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:04:15.110738 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:04:15.111582 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select temp_max_celsius
from "analytics"."silver"."stg_weather"
where temp_max_celsius is null



  
  
      
    ) dbt_internal_test
[0m18:04:15.113839 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:04:15.115636 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: ROLLBACK
[0m18:04:15.116671 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: Close
[0m18:04:15.117646 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_weather_temp_max_celsius ............................ [[32mPASS[0m in 0.05s]
[0m18:04:15.118644 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:04:15.120361 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:04:15.121405 [info ] [Thread-1 (]: 12 of 14 START test not_null_stg_weather_temp_min_celsius ...................... [RUN]
[0m18:04:15.122246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82, now test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6)
[0m18:04:15.123248 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:04:15.126423 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:04:15.134710 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:04:15.137758 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:04:15.148500 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:04:15.149489 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: BEGIN
[0m18:04:15.150494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:15.157345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:04:15.158361 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:04:15.159057 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select temp_min_celsius
from "analytics"."silver"."stg_weather"
where temp_min_celsius is null



  
  
      
    ) dbt_internal_test
[0m18:04:15.161695 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:04:15.163661 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: ROLLBACK
[0m18:04:15.164569 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: Close
[0m18:04:15.166444 [info ] [Thread-1 (]: 12 of 14 PASS not_null_stg_weather_temp_min_celsius ............................ [[32mPASS[0m in 0.04s]
[0m18:04:15.167857 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:04:15.168960 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:04:15.170065 [info ] [Thread-1 (]: 13 of 14 START test not_null_stg_weather_weather_surrogate_key ................. [RUN]
[0m18:04:15.171082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6, now test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab)
[0m18:04:15.171983 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:04:15.174699 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:04:15.183317 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:04:15.187849 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:04:15.197003 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:04:15.198036 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: BEGIN
[0m18:04:15.199253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:15.205451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:04:15.206693 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:04:15.207361 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select weather_surrogate_key
from "analytics"."silver"."stg_weather"
where weather_surrogate_key is null



  
  
      
    ) dbt_internal_test
[0m18:04:15.209817 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:04:15.212699 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: ROLLBACK
[0m18:04:15.213857 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: Close
[0m18:04:15.214837 [info ] [Thread-1 (]: 13 of 14 PASS not_null_stg_weather_weather_surrogate_key ....................... [[32mPASS[0m in 0.04s]
[0m18:04:15.216004 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:04:15.216997 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:04:15.217779 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_weather_weather_surrogate_key ................... [RUN]
[0m18:04:15.218775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab, now test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20)
[0m18:04:15.219450 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:04:15.223397 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:04:15.234569 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:04:15.237101 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:04:15.246076 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:04:15.246939 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: BEGIN
[0m18:04:15.247642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:15.253882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:04:15.255046 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:04:15.256237 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    weather_surrogate_key as unique_field,
    count(*) as n_records

from "analytics"."silver"."stg_weather"
where weather_surrogate_key is not null
group by weather_surrogate_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:04:15.259979 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:04:15.262826 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: ROLLBACK
[0m18:04:15.264288 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: Close
[0m18:04:15.265336 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_weather_weather_surrogate_key ......................... [[32mPASS[0m in 0.05s]
[0m18:04:15.266312 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:04:15.268081 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:15.268872 [debug] [MainThread]: On master: BEGIN
[0m18:04:15.270030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:15.277391 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:04:15.278467 [debug] [MainThread]: On master: COMMIT
[0m18:04:15.279455 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:15.280073 [debug] [MainThread]: On master: COMMIT
[0m18:04:15.281066 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:15.281755 [debug] [MainThread]: On master: Close
[0m18:04:15.282454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:15.283104 [debug] [MainThread]: Connection 'test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20' was properly closed.
[0m18:04:15.284356 [info ] [MainThread]: 
[0m18:04:15.285159 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m18:04:15.286598 [debug] [MainThread]: Command end result
[0m18:04:15.319410 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:04:15.325441 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:04:15.333972 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:04:15.335100 [info ] [MainThread]: 
[0m18:04:15.336225 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m18:04:15.337026 [info ] [MainThread]: 
[0m18:04:15.337834 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500 (models/silver/schema.yml)[0m
[0m18:04:15.338799 [error] [MainThread]:   Compilation Error in test dbt_utils_expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0_AND_precipitation_mm_500 (models/silver/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:04:15.339693 [info ] [MainThread]: 
[0m18:04:15.340387 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50 (models/silver/schema.yml)[0m
[0m18:04:15.341367 [error] [MainThread]:   Compilation Error in test dbt_utils_expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_BETWEEN_50_AND_50 (models/silver/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:04:15.342589 [info ] [MainThread]: 
[0m18:04:15.343583 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40 (models/silver/schema.yml)[0m
[0m18:04:15.344548 [error] [MainThread]:   Compilation Error in test dbt_utils_expression_is_true_stg_weather_temp_min_celsius__temp_min_celsius_BETWEEN_60_AND_40 (models/silver/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:04:15.345342 [info ] [MainThread]: 
[0m18:04:15.346061 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=14
[0m18:04:15.347170 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.493813, "process_in_blocks": "1592", "process_kernel_time": 0.581221, "process_mem_max_rss": "129284", "process_out_blocks": "0", "process_user_time": 1.955019}
[0m18:04:15.347978 [debug] [MainThread]: Command `dbt test` failed at 18:04:15.347900 after 1.49 seconds
[0m18:04:15.349087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4e7cfac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4e7c8a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4ec1b3610>]}
[0m18:04:15.350671 [debug] [MainThread]: Flushing usage events
[0m18:04:17.377843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:03.509249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e6e8d1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e46aaed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e46abc50>]}


============================== 18:09:03.515626 | 40e03d52-ebf0-4f8f-b6fc-cca1f016f225 ==============================
[0m18:09:03.515626 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:09:03.516835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:09:03.735875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40e03d52-ebf0-4f8f-b6fc-cca1f016f225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e4450310>]}
[0m18:09:03.774442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40e03d52-ebf0-4f8f-b6fc-cca1f016f225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e6e9bd50>]}
[0m18:09:03.776503 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:09:03.862150 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:09:04.113238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:09:04.114871 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/silver/schema.yml
[0m18:09:04.452032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40e03d52-ebf0-4f8f-b6fc-cca1f016f225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e37f3510>]}
[0m18:09:04.512776 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:09:04.519650 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:09:04.557027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40e03d52-ebf0-4f8f-b6fc-cca1f016f225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e3b404d0>]}
[0m18:09:04.558469 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 435 macros
[0m18:09:04.559400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e03d52-ebf0-4f8f-b6fc-cca1f016f225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e23d8f50>]}
[0m18:09:04.561778 [info ] [MainThread]: 
[0m18:09:04.562719 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:04.563962 [info ] [MainThread]: 
[0m18:09:04.565160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:04.568754 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m18:09:04.607469 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:09:04.608602 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:09:04.609362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:04.619251 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m18:09:04.620910 [debug] [ThreadPool]: On list_analytics: Close
[0m18:09:04.623681 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:09:04.624895 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:09:04.625553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:04.632130 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m18:09:04.634234 [debug] [ThreadPool]: On list_analytics: Close
[0m18:09:04.636328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_gold)
[0m18:09:04.640296 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:09:04.641067 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:09:04.641853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:04.648331 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:09:04.649233 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:09:04.649813 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:09:04.653201 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m18:09:04.654927 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:09:04.656128 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:09:04.657268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_gold, now list_analytics_silver)
[0m18:09:04.659780 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:09:04.660554 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:09:04.661191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:04.667394 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:09:04.668674 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:09:04.669452 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:09:04.673402 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:09:04.674956 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:09:04.675755 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:09:04.679426 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:04.680239 [debug] [MainThread]: On master: BEGIN
[0m18:09:04.681003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:04.686828 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:09:04.687970 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:04.688684 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:04.692353 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m18:09:04.693843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e03d52-ebf0-4f8f-b6fc-cca1f016f225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e23b3050>]}
[0m18:09:04.694778 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:04.695663 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:04.696248 [debug] [MainThread]: On master: BEGIN
[0m18:09:04.697304 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:09:04.698304 [debug] [MainThread]: On master: COMMIT
[0m18:09:04.699070 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:04.699840 [debug] [MainThread]: On master: COMMIT
[0m18:09:04.700674 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:09:04.701337 [debug] [MainThread]: On master: Close
[0m18:09:04.707089 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m18:09:04.708100 [info ] [Thread-1 (]: 1 of 4 START sql view model silver.stg_weather ................................. [RUN]
[0m18:09:04.709065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_silver, now model.weather_dbt.stg_weather)
[0m18:09:04.709748 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m18:09:04.714498 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m18:09:04.721242 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m18:09:04.741188 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.stg_weather"
[0m18:09:04.749557 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:09:04.750318 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: BEGIN
[0m18:09:04.750943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:04.757708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:09:04.758790 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:09:04.759554 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */

  create view "analytics"."silver"."stg_weather__dbt_tmp"
    
    
  as (
    

WITH ranked_weather AS (
    SELECT
        *,  -- Keep raw types, cast later
        ROW_NUMBER() OVER(
            PARTITION BY city_name, day 
            ORDER BY ingested_at DESC
        ) AS rn
    FROM "analytics"."bronze"."weather_raw"
),  -- ✅ Fixed: Added comma

deduped_weather AS (
    SELECT
        MD5(city_name || '|' || day::TEXT) AS weather_surrogate_key,  -- ✅ PostgreSQL fix
        
        CAST(day AS DATE) AS observation_date,
        CAST(city_name AS VARCHAR(50)) AS city_name,
        CAST(latitude AS DECIMAL(9,6)) AS latitude,
        CAST(longitude AS DECIMAL(9,6)) AS longitude,
        CAST(temp_max AS DECIMAL(5,2)) AS temp_max_celsius,
        CAST(temp_min AS DECIMAL(5,2)) AS temp_min_celsius,
        CAST(precipitation_sum AS DECIMAL(6,2)) AS precipitation_mm,
        CAST(ingested_at AS TIMESTAMP) AS ingested_at
    FROM ranked_weather
    WHERE rn = 1
        AND city_name IS NOT NULL 
        AND latitude IS NOT NULL 
        AND longitude IS NOT NULL
        AND day IS NOT NULL
        AND temp_max IS NOT NULL 
        AND temp_min IS NOT NULL
)

SELECT * FROM deduped_weather
  );
[0m18:09:04.765148 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:09:04.769487 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:09:04.770259 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather" rename to "stg_weather__dbt_backup"
[0m18:09:04.771671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:09:04.774405 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:09:04.775327 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m18:09:04.777293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:09:04.787704 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:09:04.788775 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:09:04.789512 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:09:04.791625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:09:04.796984 [debug] [Thread-1 (]: Applying DROP to: "analytics"."silver"."stg_weather__dbt_backup"
[0m18:09:04.800586 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:09:04.801328 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
drop view if exists "analytics"."silver"."stg_weather__dbt_backup" cascade
[0m18:09:04.804010 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:09:04.806255 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: Close
[0m18:09:04.808428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e03d52-ebf0-4f8f-b6fc-cca1f016f225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840ab2687d0>]}
[0m18:09:04.809569 [info ] [Thread-1 (]: 1 of 4 OK created sql view model silver.stg_weather ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m18:09:04.810421 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m18:09:04.811652 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m18:09:04.812620 [info ] [Thread-1 (]: 2 of 4 START sql table model gold.dim_date ..................................... [RUN]
[0m18:09:04.813846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m18:09:04.814619 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m18:09:04.817484 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m18:09:04.825025 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m18:09:04.837694 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_date"
[0m18:09:04.846670 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:09:04.847744 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: BEGIN
[0m18:09:04.848378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:04.854941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:09:04.856041 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:09:04.856799 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */

  
    

  create  table "analytics"."gold"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    SELECT
        min(observation_date) as min_day,
        max(observation_date) as max_day
    FROM "analytics"."silver"."stg_weather"    
),
dates as (
    select generate_series(min_day, max_day, interval '1 day')::date as date_day
    from bounds
)
SELECT
    date_day,
    extract(year from date_day)::int as year,
    extract(month from date_day)::int as month,
    to_char(date_day, 'Mon')  as month_name,
    extract(day from date_day) as day_of_month,
    extract(dow from date_day)::int as day_of_week,
    to_char(date_day, 'Dy') as day_name,
    case when extract(dow from date_day) in (0,6) then true else false end as is_weekend
FROM dates
  );
  
[0m18:09:04.862732 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m18:09:04.868230 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:09:04.869089 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
alter table "analytics"."gold"."dim_date" rename to "dim_date__dbt_backup"
[0m18:09:04.870440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:09:04.873250 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:09:04.874409 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
alter table "analytics"."gold"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:09:04.875469 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:09:04.876768 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m18:09:04.877447 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:09:04.878088 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m18:09:04.879976 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:09:04.882163 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_date__dbt_backup"
[0m18:09:04.884912 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:09:04.885857 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
drop table if exists "analytics"."gold"."dim_date__dbt_backup" cascade
[0m18:09:04.889500 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:09:04.891086 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: Close
[0m18:09:04.892175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e03d52-ebf0-4f8f-b6fc-cca1f016f225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e2b78b50>]}
[0m18:09:04.893391 [info ] [Thread-1 (]: 2 of 4 OK created sql table model gold.dim_date ................................ [[32mSELECT 0[0m in 0.08s]
[0m18:09:04.894782 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m18:09:04.895607 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m18:09:04.896360 [info ] [Thread-1 (]: 3 of 4 START sql table model gold.dim_location ................................. [RUN]
[0m18:09:04.897144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m18:09:04.897731 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m18:09:04.900037 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m18:09:04.908584 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m18:09:04.911259 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_location"
[0m18:09:04.919755 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:09:04.920748 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: BEGIN
[0m18:09:04.921505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:04.928849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:09:04.930126 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:09:04.930956 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */

  
    

  create  table "analytics"."gold"."dim_location__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    latitude,
    longitude
FROM "analytics"."silver"."stg_weather"
  );
  
[0m18:09:04.934194 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m18:09:04.937591 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:09:04.938324 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location" rename to "dim_location__dbt_backup"
[0m18:09:04.939379 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:09:04.941812 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:09:04.942611 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location__dbt_tmp" rename to "dim_location"
[0m18:09:04.944096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:09:04.945523 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:09:04.946134 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:09:04.946699 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:09:04.948169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:09:04.952435 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_location__dbt_backup"
[0m18:09:04.953507 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:09:04.954406 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
drop table if exists "analytics"."gold"."dim_location__dbt_backup" cascade
[0m18:09:04.956861 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:09:04.958163 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: Close
[0m18:09:04.959253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e03d52-ebf0-4f8f-b6fc-cca1f016f225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840ab2d1050>]}
[0m18:09:04.960503 [info ] [Thread-1 (]: 3 of 4 OK created sql table model gold.dim_location ............................ [[32mSELECT 0[0m in 0.06s]
[0m18:09:04.961792 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m18:09:04.962700 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m18:09:04.963988 [info ] [Thread-1 (]: 4 of 4 START sql table model gold.fct_weather_daily ............................ [RUN]
[0m18:09:04.965368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m18:09:04.966203 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m18:09:04.968537 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m18:09:04.975926 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m18:09:04.978361 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.fct_weather_daily"
[0m18:09:04.986947 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:09:04.987727 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: BEGIN
[0m18:09:04.988397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:04.994504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:09:04.995706 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:09:04.996504 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */

  
    

  create  table "analytics"."gold"."fct_weather_daily__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_metrics AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        
        -- Basic metrics
        (temp_max_celsius + temp_min_celsius) / 2 AS avg_temp,
        temp_max_celsius AS max_temp,
        temp_min_celsius AS min_temp,
        precipitation_mm AS total_precipitation,
        
        -- 7-day moving average temperature
        AVG((temp_max_celsius + temp_min_celsius) / 2) 
            OVER (
                PARTITION BY city_name 
                ORDER BY observation_date 
                ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ) AS moving_avg_7d_temp

    FROM "analytics"."silver"."stg_weather"
),

final_summary AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        ROUND(avg_temp, 2) AS avg_temp,
        ROUND(max_temp, 2) AS max_temp,
        ROUND(min_temp, 2) AS min_temp,
        ROUND(total_precipitation, 2) AS total_precipitation,
        ROUND(moving_avg_7d_temp, 2) AS moving_avg_7d_temp

    FROM daily_metrics
)

SELECT * FROM final_summary
  );
  
[0m18:09:05.002551 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m18:09:05.005557 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:09:05.006391 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily" rename to "fct_weather_daily__dbt_backup"
[0m18:09:05.007627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:09:05.010591 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:09:05.011560 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily__dbt_tmp" rename to "fct_weather_daily"
[0m18:09:05.012559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:09:05.014051 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:09:05.014851 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:09:05.015754 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:09:05.017466 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:09:05.019954 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."fct_weather_daily__dbt_backup"
[0m18:09:05.020749 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:09:05.021442 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
drop table if exists "analytics"."gold"."fct_weather_daily__dbt_backup" cascade
[0m18:09:05.024437 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:09:05.026001 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: Close
[0m18:09:05.027287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e03d52-ebf0-4f8f-b6fc-cca1f016f225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840ab2d0790>]}
[0m18:09:05.028339 [info ] [Thread-1 (]: 4 of 4 OK created sql table model gold.fct_weather_daily ....................... [[32mSELECT 0[0m in 0.06s]
[0m18:09:05.029352 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m18:09:05.031430 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:05.032096 [debug] [MainThread]: On master: BEGIN
[0m18:09:05.032726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:05.040871 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:09:05.042208 [debug] [MainThread]: On master: COMMIT
[0m18:09:05.043166 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:05.044059 [debug] [MainThread]: On master: COMMIT
[0m18:09:05.045122 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:09:05.045884 [debug] [MainThread]: On master: Close
[0m18:09:05.046750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:05.048933 [debug] [MainThread]: Connection 'model.weather_dbt.fct_weather_daily' was properly closed.
[0m18:09:05.050503 [info ] [MainThread]: 
[0m18:09:05.051362 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m18:09:05.052580 [debug] [MainThread]: Command end result
[0m18:09:05.081361 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:09:05.087050 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:09:05.096233 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:09:05.097229 [info ] [MainThread]: 
[0m18:09:05.098379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:05.099256 [info ] [MainThread]: 
[0m18:09:05.100134 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:09:05.102268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6416745, "process_in_blocks": "70096", "process_kernel_time": 0.65099, "process_mem_max_rss": "132088", "process_out_blocks": "0", "process_user_time": 2.182252}
[0m18:09:05.103257 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:05.103154 after 1.64 seconds
[0m18:09:05.104513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e89df5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e8a9c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7840e8a96dd0>]}
[0m18:09:05.105598 [debug] [MainThread]: Flushing usage events
[0m18:09:06.567611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:09.764718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c385f56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c3c7c68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c39a53750>]}


============================== 18:09:09.769314 | 75de8edc-e39e-43ce-8d60-8193a91b8af0 ==============================
[0m18:09:09.769314 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:09:09.770455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:09:09.884091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75de8edc-e39e-43ce-8d60-8193a91b8af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c379c4590>]}
[0m18:09:09.925643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75de8edc-e39e-43ce-8d60-8193a91b8af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c3afb84d0>]}
[0m18:09:09.927031 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:09:10.006154 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:09:10.220312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:10.221367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:10.250598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75de8edc-e39e-43ce-8d60-8193a91b8af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c3715b190>]}
[0m18:09:10.316224 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:09:10.321956 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:09:10.372405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75de8edc-e39e-43ce-8d60-8193a91b8af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c3617d9d0>]}
[0m18:09:10.374059 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 435 macros
[0m18:09:10.374939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75de8edc-e39e-43ce-8d60-8193a91b8af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c385f56d0>]}
[0m18:09:10.377175 [info ] [MainThread]: 
[0m18:09:10.378287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:10.379652 [info ] [MainThread]: 
[0m18:09:10.380559 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:10.384705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_silver'
[0m18:09:10.481930 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:09:10.483320 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:09:10.484624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:10.492107 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:09:10.493349 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:09:10.494276 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:09:10.497978 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:09:10.499916 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:09:10.501124 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:09:10.502667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m18:09:10.506240 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:09:10.507313 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:09:10.508021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:10.515212 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:09:10.516859 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:09:10.517693 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:09:10.520757 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m18:09:10.522371 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:09:10.523719 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:09:10.528807 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:10.529860 [debug] [MainThread]: On master: BEGIN
[0m18:09:10.530574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:10.537572 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:09:10.538623 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:10.539300 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:10.543446 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m18:09:10.545323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75de8edc-e39e-43ce-8d60-8193a91b8af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c3616f550>]}
[0m18:09:10.546425 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:10.547881 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:10.548703 [debug] [MainThread]: On master: BEGIN
[0m18:09:10.550155 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:09:10.551007 [debug] [MainThread]: On master: COMMIT
[0m18:09:10.551653 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:10.552547 [debug] [MainThread]: On master: COMMIT
[0m18:09:10.553681 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:09:10.554609 [debug] [MainThread]: On master: Close
[0m18:09:10.559459 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:09:10.560480 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj  [RUN]
[0m18:09:10.561735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816)
[0m18:09:10.562638 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:09:10.574081 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:09:10.584840 [debug] [Thread-1 (]: Began executing node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:09:10.597094 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:09:10.607045 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:09:10.607864 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: BEGIN
[0m18:09:10.608755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:10.615567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:09:10.616846 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:09:10.618087 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        city_name as value_field,
        count(*) as n_records

    from "analytics"."silver"."stg_weather"
    group by city_name

)

select *
from all_values
where value_field not in (
    'Kathmandu','Pokhara','Biratnagar','Birgunj'
)



  
  
      
    ) dbt_internal_test
[0m18:09:10.621132 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:09:10.624470 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: ROLLBACK
[0m18:09:10.625840 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: Close
[0m18:09:10.627111 [info ] [Thread-1 (]: 1 of 13 PASS accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj  [[32mPASS[0m in 0.07s]
[0m18:09:10.628242 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:09:10.629124 [debug] [Thread-1 (]: Began running node test.weather_dbt.expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0.fb0de0aaf3
[0m18:09:10.629930 [info ] [Thread-1 (]: 2 of 13 START test expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0  [RUN]
[0m18:09:10.630818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816, now test.weather_dbt.expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0.fb0de0aaf3)
[0m18:09:10.631780 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0.fb0de0aaf3
[0m18:09:10.642452 [debug] [Thread-1 (]: Compilation Error in test expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0 (models/silver/schema.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:09:10.643947 [error] [Thread-1 (]: 2 of 13 ERROR expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0  [[31mERROR[0m in 0.01s]
[0m18:09:10.645033 [debug] [Thread-1 (]: Finished running node test.weather_dbt.expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0.fb0de0aaf3
[0m18:09:10.646301 [debug] [Thread-1 (]: Began running node test.weather_dbt.expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50.f7bb44baf8
[0m18:09:10.646761 [debug] [Thread-4 (]: Marking all children of 'test.weather_dbt.expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0.fb0de0aaf3' to be skipped because of status 'error'.  Reason: Compilation Error in test expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0 (models/silver/schema.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:09:10.647322 [info ] [Thread-1 (]: 3 of 13 START test expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50  [RUN]
[0m18:09:10.649012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0.fb0de0aaf3, now test.weather_dbt.expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50.f7bb44baf8)
[0m18:09:10.649636 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50.f7bb44baf8
[0m18:09:10.654111 [debug] [Thread-1 (]: Compilation Error in test expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50 (models/silver/schema.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:09:10.655204 [error] [Thread-1 (]: 3 of 13 ERROR expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50  [[31mERROR[0m in 0.01s]
[0m18:09:10.656331 [debug] [Thread-1 (]: Finished running node test.weather_dbt.expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50.f7bb44baf8
[0m18:09:10.657750 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:09:10.658173 [debug] [Thread-4 (]: Marking all children of 'test.weather_dbt.expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50.f7bb44baf8' to be skipped because of status 'error'.  Reason: Compilation Error in test expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50 (models/silver/schema.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:09:10.658854 [info ] [Thread-1 (]: 4 of 13 START test not_null_stg_weather_city_name .............................. [RUN]
[0m18:09:10.660825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50.f7bb44baf8, now test.weather_dbt.not_null_stg_weather_city_name.d57308e884)
[0m18:09:10.661761 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:09:10.666941 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:09:10.675984 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:09:10.678497 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:09:10.689086 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:09:10.690062 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: BEGIN
[0m18:09:10.690881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:10.698234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:09:10.699359 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:09:10.700704 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_name
from "analytics"."silver"."stg_weather"
where city_name is null



  
  
      
    ) dbt_internal_test
[0m18:09:10.703246 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:09:10.705252 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: ROLLBACK
[0m18:09:10.706184 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: Close
[0m18:09:10.707095 [info ] [Thread-1 (]: 4 of 13 PASS not_null_stg_weather_city_name .................................... [[32mPASS[0m in 0.05s]
[0m18:09:10.708255 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:09:10.709134 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:09:10.709929 [info ] [Thread-1 (]: 5 of 13 START test not_null_stg_weather_ingested_at ............................ [RUN]
[0m18:09:10.711147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_city_name.d57308e884, now test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516)
[0m18:09:10.711904 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:09:10.716229 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:09:10.726025 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:09:10.729634 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:09:10.739712 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:09:10.741666 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: BEGIN
[0m18:09:10.743070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:10.749461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:09:10.750554 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:09:10.752091 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ingested_at
from "analytics"."silver"."stg_weather"
where ingested_at is null



  
  
      
    ) dbt_internal_test
[0m18:09:10.755316 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:09:10.756936 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: ROLLBACK
[0m18:09:10.758071 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: Close
[0m18:09:10.759584 [info ] [Thread-1 (]: 5 of 13 PASS not_null_stg_weather_ingested_at .................................. [[32mPASS[0m in 0.05s]
[0m18:09:10.760916 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:09:10.762066 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:09:10.763150 [info ] [Thread-1 (]: 6 of 13 START test not_null_stg_weather_latitude ............................... [RUN]
[0m18:09:10.764430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516, now test.weather_dbt.not_null_stg_weather_latitude.35769df29a)
[0m18:09:10.765672 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:09:10.769354 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:09:10.778462 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:09:10.781290 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:09:10.790586 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:09:10.791786 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: BEGIN
[0m18:09:10.792702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:10.799993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:09:10.801309 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:09:10.802159 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from "analytics"."silver"."stg_weather"
where latitude is null



  
  
      
    ) dbt_internal_test
[0m18:09:10.804844 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:09:10.806559 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: ROLLBACK
[0m18:09:10.807782 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: Close
[0m18:09:10.809232 [info ] [Thread-1 (]: 6 of 13 PASS not_null_stg_weather_latitude ..................................... [[32mPASS[0m in 0.04s]
[0m18:09:10.810487 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:09:10.811650 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:09:10.812436 [info ] [Thread-1 (]: 7 of 13 START test not_null_stg_weather_longitude .............................. [RUN]
[0m18:09:10.813832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_latitude.35769df29a, now test.weather_dbt.not_null_stg_weather_longitude.04815d6a63)
[0m18:09:10.814935 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:09:10.818326 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:09:10.827278 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:09:10.829577 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:09:10.838303 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:09:10.839251 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: BEGIN
[0m18:09:10.840256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:10.847537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:09:10.848455 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:09:10.849470 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from "analytics"."silver"."stg_weather"
where longitude is null



  
  
      
    ) dbt_internal_test
[0m18:09:10.851788 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:09:10.853608 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: ROLLBACK
[0m18:09:10.854806 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: Close
[0m18:09:10.855931 [info ] [Thread-1 (]: 7 of 13 PASS not_null_stg_weather_longitude .................................... [[32mPASS[0m in 0.04s]
[0m18:09:10.856994 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:09:10.857833 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:09:10.858777 [info ] [Thread-1 (]: 8 of 13 START test not_null_stg_weather_observation_date ....................... [RUN]
[0m18:09:10.859857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_longitude.04815d6a63, now test.weather_dbt.not_null_stg_weather_observation_date.9a16015555)
[0m18:09:10.860535 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:09:10.864267 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:09:10.873060 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:09:10.876275 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:09:10.885132 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:09:10.886688 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: BEGIN
[0m18:09:10.887387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:10.895065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:09:10.896156 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:09:10.897061 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select observation_date
from "analytics"."silver"."stg_weather"
where observation_date is null



  
  
      
    ) dbt_internal_test
[0m18:09:10.899656 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:09:10.901557 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: ROLLBACK
[0m18:09:10.902627 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: Close
[0m18:09:10.903928 [info ] [Thread-1 (]: 8 of 13 PASS not_null_stg_weather_observation_date ............................. [[32mPASS[0m in 0.04s]
[0m18:09:10.905014 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:09:10.906240 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:09:10.907243 [info ] [Thread-1 (]: 9 of 13 START test not_null_stg_weather_precipitation_mm ....................... [RUN]
[0m18:09:10.908283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_observation_date.9a16015555, now test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4)
[0m18:09:10.908958 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:09:10.912146 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:09:10.921585 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:09:10.924197 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:09:10.932280 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:09:10.933574 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: BEGIN
[0m18:09:10.934659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:10.941445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:09:10.942422 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:09:10.943323 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select precipitation_mm
from "analytics"."silver"."stg_weather"
where precipitation_mm is null



  
  
      
    ) dbt_internal_test
[0m18:09:10.946395 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:09:10.948074 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: ROLLBACK
[0m18:09:10.948968 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: Close
[0m18:09:10.949819 [info ] [Thread-1 (]: 9 of 13 PASS not_null_stg_weather_precipitation_mm ............................. [[32mPASS[0m in 0.04s]
[0m18:09:10.950840 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:09:10.951779 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:09:10.952825 [info ] [Thread-1 (]: 10 of 13 START test not_null_stg_weather_temp_max_celsius ...................... [RUN]
[0m18:09:10.954347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4, now test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82)
[0m18:09:10.955157 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:09:10.958499 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:09:10.966472 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:09:10.969010 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:09:10.978695 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:09:10.979674 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: BEGIN
[0m18:09:10.980493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:10.987128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:09:10.988203 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:09:10.989036 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select temp_max_celsius
from "analytics"."silver"."stg_weather"
where temp_max_celsius is null



  
  
      
    ) dbt_internal_test
[0m18:09:10.991519 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:09:10.993399 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: ROLLBACK
[0m18:09:10.994350 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: Close
[0m18:09:10.995274 [info ] [Thread-1 (]: 10 of 13 PASS not_null_stg_weather_temp_max_celsius ............................ [[32mPASS[0m in 0.04s]
[0m18:09:10.996330 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:09:10.997193 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:09:10.997850 [info ] [Thread-1 (]: 11 of 13 START test not_null_stg_weather_temp_min_celsius ...................... [RUN]
[0m18:09:10.998614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82, now test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6)
[0m18:09:10.999289 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:09:11.004637 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:09:11.012797 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:09:11.015725 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:09:11.023968 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:09:11.024943 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: BEGIN
[0m18:09:11.025741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:11.032227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:09:11.033440 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:09:11.034331 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select temp_min_celsius
from "analytics"."silver"."stg_weather"
where temp_min_celsius is null



  
  
      
    ) dbt_internal_test
[0m18:09:11.036937 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:09:11.038748 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: ROLLBACK
[0m18:09:11.039660 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: Close
[0m18:09:11.040589 [info ] [Thread-1 (]: 11 of 13 PASS not_null_stg_weather_temp_min_celsius ............................ [[32mPASS[0m in 0.04s]
[0m18:09:11.041565 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:09:11.042627 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:09:11.043734 [info ] [Thread-1 (]: 12 of 13 START test not_null_stg_weather_weather_surrogate_key ................. [RUN]
[0m18:09:11.044603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6, now test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab)
[0m18:09:11.045363 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:09:11.048823 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:09:11.057594 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:09:11.060102 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:09:11.068295 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:09:11.069092 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: BEGIN
[0m18:09:11.069817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:11.077726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:09:11.079053 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:09:11.079978 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select weather_surrogate_key
from "analytics"."silver"."stg_weather"
where weather_surrogate_key is null



  
  
      
    ) dbt_internal_test
[0m18:09:11.082441 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:09:11.084697 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: ROLLBACK
[0m18:09:11.085594 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: Close
[0m18:09:11.086469 [info ] [Thread-1 (]: 12 of 13 PASS not_null_stg_weather_weather_surrogate_key ....................... [[32mPASS[0m in 0.04s]
[0m18:09:11.087673 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:09:11.088507 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:09:11.089177 [info ] [Thread-1 (]: 13 of 13 START test unique_stg_weather_weather_surrogate_key ................... [RUN]
[0m18:09:11.090104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab, now test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20)
[0m18:09:11.090760 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:09:11.095209 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:09:11.103404 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:09:11.106341 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:09:11.115166 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:09:11.116054 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: BEGIN
[0m18:09:11.116703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:11.122414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:09:11.123771 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:09:11.124729 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    weather_surrogate_key as unique_field,
    count(*) as n_records

from "analytics"."silver"."stg_weather"
where weather_surrogate_key is not null
group by weather_surrogate_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:09:11.127281 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:09:11.129114 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: ROLLBACK
[0m18:09:11.130025 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: Close
[0m18:09:11.130956 [info ] [Thread-1 (]: 13 of 13 PASS unique_stg_weather_weather_surrogate_key ......................... [[32mPASS[0m in 0.04s]
[0m18:09:11.131984 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:09:11.134376 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:11.135614 [debug] [MainThread]: On master: BEGIN
[0m18:09:11.136554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:11.142968 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:09:11.144179 [debug] [MainThread]: On master: COMMIT
[0m18:09:11.144976 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:11.145626 [debug] [MainThread]: On master: COMMIT
[0m18:09:11.146817 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:09:11.147671 [debug] [MainThread]: On master: Close
[0m18:09:11.148753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:11.149620 [debug] [MainThread]: Connection 'test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20' was properly closed.
[0m18:09:11.150462 [info ] [MainThread]: 
[0m18:09:11.151204 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m18:09:11.152736 [debug] [MainThread]: Command end result
[0m18:09:11.182674 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:09:11.188422 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:09:11.197901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:09:11.198926 [info ] [MainThread]: 
[0m18:09:11.199845 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:09:11.200606 [info ] [MainThread]: 
[0m18:09:11.201562 [error] [MainThread]: [31mFailure in test expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0 (models/silver/schema.yml)[0m
[0m18:09:11.202504 [error] [MainThread]:   Compilation Error in test expression_is_true_stg_weather_precipitation_mm__precipitation_mm_0 (models/silver/schema.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:09:11.203661 [info ] [MainThread]: 
[0m18:09:11.204573 [error] [MainThread]: [31mFailure in test expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50 (models/silver/schema.yml)[0m
[0m18:09:11.205471 [error] [MainThread]:   Compilation Error in test expression_is_true_stg_weather_temp_max_celsius__temp_max_celsius_50_AND_temp_max_celsius_50 (models/silver/schema.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:09:11.206327 [info ] [MainThread]: 
[0m18:09:11.207121 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=13
[0m18:09:11.208401 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.4899062, "process_in_blocks": "1592", "process_kernel_time": 0.473902, "process_mem_max_rss": "129476", "process_out_blocks": "0", "process_user_time": 1.791192}
[0m18:09:11.209280 [debug] [MainThread]: Command `dbt test` failed at 18:09:11.209210 after 1.49 seconds
[0m18:09:11.210036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c3cbaaed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c3cba88d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9c379bbfd0>]}
[0m18:09:11.210917 [debug] [MainThread]: Flushing usage events
[0m18:09:12.421013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:15.844387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751971b64dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751971e0d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751971b64910>]}


============================== 18:10:15.852054 | f6885734-9044-48bd-8f64-2745b7ae02ed ==============================
[0m18:10:15.852054 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:10:15.853387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:10:16.083834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6885734-9044-48bd-8f64-2745b7ae02ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7519714d6e10>]}
[0m18:10:16.119577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6885734-9044-48bd-8f64-2745b7ae02ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751974520150>]}
[0m18:10:16.121914 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:10:16.219996 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:10:16.481086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:10:16.482344 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/silver/schema.yml
[0m18:10:16.813164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6885734-9044-48bd-8f64-2745b7ae02ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751974475310>]}
[0m18:10:16.878656 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:10:16.884796 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:10:16.915964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6885734-9044-48bd-8f64-2745b7ae02ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75196fd55b50>]}
[0m18:10:16.917072 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 435 macros
[0m18:10:16.918300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6885734-9044-48bd-8f64-2745b7ae02ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75196fdb9b90>]}
[0m18:10:16.920058 [info ] [MainThread]: 
[0m18:10:16.920913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:16.921876 [info ] [MainThread]: 
[0m18:10:16.922695 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:16.926256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m18:10:16.962321 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:10:16.963545 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:10:16.964221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:16.973273 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m18:10:16.975489 [debug] [ThreadPool]: On list_analytics: Close
[0m18:10:16.978479 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:10:16.979420 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:10:16.980156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:16.988663 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m18:10:16.990578 [debug] [ThreadPool]: On list_analytics: Close
[0m18:10:16.992890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_silver)
[0m18:10:16.997220 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:10:16.998176 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:10:16.998916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:17.005968 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:10:17.007085 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:10:17.007877 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:10:17.011552 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:10:17.013287 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:10:17.014111 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:10:17.014946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m18:10:17.017981 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:10:17.018990 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:10:17.019725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:17.026040 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:10:17.026938 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:10:17.027493 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:10:17.030826 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m18:10:17.032495 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:10:17.033317 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:10:17.038010 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:17.038976 [debug] [MainThread]: On master: BEGIN
[0m18:10:17.039734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:17.046626 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:10:17.047549 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:17.048264 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:17.053749 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m18:10:17.056119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6885734-9044-48bd-8f64-2745b7ae02ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7519730f6010>]}
[0m18:10:17.057157 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:17.058099 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:17.058692 [debug] [MainThread]: On master: BEGIN
[0m18:10:17.059862 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:10:17.060557 [debug] [MainThread]: On master: COMMIT
[0m18:10:17.061109 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:17.061759 [debug] [MainThread]: On master: COMMIT
[0m18:10:17.062601 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:17.063170 [debug] [MainThread]: On master: Close
[0m18:10:17.068355 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m18:10:17.069586 [info ] [Thread-1 (]: 1 of 4 START sql view model silver.stg_weather ................................. [RUN]
[0m18:10:17.070435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now model.weather_dbt.stg_weather)
[0m18:10:17.071196 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m18:10:17.076016 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m18:10:17.086430 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m18:10:17.107378 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.stg_weather"
[0m18:10:17.114986 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:10:17.116097 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: BEGIN
[0m18:10:17.116975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:17.122981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:17.124052 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:10:17.124927 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */

  create view "analytics"."silver"."stg_weather__dbt_tmp"
    
    
  as (
    

WITH ranked_weather AS (
    SELECT
        *,  -- Keep raw types, cast later
        ROW_NUMBER() OVER(
            PARTITION BY city_name, day 
            ORDER BY ingested_at DESC
        ) AS rn
    FROM "analytics"."bronze"."weather_raw"
),  -- ✅ Fixed: Added comma

deduped_weather AS (
    SELECT
        MD5(city_name || '|' || day::TEXT) AS weather_surrogate_key,  -- ✅ PostgreSQL fix
        
        CAST(day AS DATE) AS observation_date,
        CAST(city_name AS VARCHAR(50)) AS city_name,
        CAST(latitude AS DECIMAL(9,6)) AS latitude,
        CAST(longitude AS DECIMAL(9,6)) AS longitude,
        CAST(temp_max AS DECIMAL(5,2)) AS temp_max_celsius,
        CAST(temp_min AS DECIMAL(5,2)) AS temp_min_celsius,
        CAST(precipitation_sum AS DECIMAL(6,2)) AS precipitation_mm,
        CAST(ingested_at AS TIMESTAMP) AS ingested_at
    FROM ranked_weather
    WHERE rn = 1
        AND city_name IS NOT NULL 
        AND latitude IS NOT NULL 
        AND longitude IS NOT NULL
        AND day IS NOT NULL
        AND temp_max IS NOT NULL 
        AND temp_min IS NOT NULL
)

SELECT * FROM deduped_weather
  );
[0m18:10:17.129274 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:10:17.134363 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:10:17.135603 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather" rename to "stg_weather__dbt_backup"
[0m18:10:17.138294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:10:17.141157 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:10:17.142126 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m18:10:17.143557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:10:17.153875 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:10:17.155316 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:10:17.156690 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:10:17.159174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:10:17.165186 [debug] [Thread-1 (]: Applying DROP to: "analytics"."silver"."stg_weather__dbt_backup"
[0m18:10:17.170473 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:10:17.171511 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
drop view if exists "analytics"."silver"."stg_weather__dbt_backup" cascade
[0m18:10:17.174257 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:10:17.177155 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: Close
[0m18:10:17.180365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6885734-9044-48bd-8f64-2745b7ae02ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75196cbafa90>]}
[0m18:10:17.181836 [info ] [Thread-1 (]: 1 of 4 OK created sql view model silver.stg_weather ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m18:10:17.183224 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m18:10:17.184974 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m18:10:17.186400 [info ] [Thread-1 (]: 2 of 4 START sql table model gold.dim_date ..................................... [RUN]
[0m18:10:17.187583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m18:10:17.188631 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m18:10:17.191720 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m18:10:17.200464 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m18:10:17.215172 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_date"
[0m18:10:17.225874 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:10:17.227025 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: BEGIN
[0m18:10:17.227835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:17.233691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:17.234744 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:10:17.235744 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */

  
    

  create  table "analytics"."gold"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    SELECT
        min(observation_date) as min_day,
        max(observation_date) as max_day
    FROM "analytics"."silver"."stg_weather"    
),
dates as (
    select generate_series(min_day, max_day, interval '1 day')::date as date_day
    from bounds
)
SELECT
    date_day,
    extract(year from date_day)::int as year,
    extract(month from date_day)::int as month,
    to_char(date_day, 'Mon')  as month_name,
    extract(day from date_day) as day_of_month,
    extract(dow from date_day)::int as day_of_week,
    to_char(date_day, 'Dy') as day_name,
    case when extract(dow from date_day) in (0,6) then true else false end as is_weekend
FROM dates
  );
  
[0m18:10:17.243172 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m18:10:17.248952 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:10:17.250163 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
alter table "analytics"."gold"."dim_date" rename to "dim_date__dbt_backup"
[0m18:10:17.251730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:10:17.254389 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:10:17.255980 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
alter table "analytics"."gold"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:10:17.258027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:10:17.259778 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m18:10:17.260837 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:10:17.261929 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m18:10:17.264242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:17.267462 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_date__dbt_backup"
[0m18:10:17.271875 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:10:17.273203 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
drop table if exists "analytics"."gold"."dim_date__dbt_backup" cascade
[0m18:10:17.277058 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:10:17.279405 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: Close
[0m18:10:17.280795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6885734-9044-48bd-8f64-2745b7ae02ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75196ca4cd50>]}
[0m18:10:17.282038 [info ] [Thread-1 (]: 2 of 4 OK created sql table model gold.dim_date ................................ [[32mSELECT 0[0m in 0.09s]
[0m18:10:17.283507 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m18:10:17.284486 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m18:10:17.285953 [info ] [Thread-1 (]: 3 of 4 START sql table model gold.dim_location ................................. [RUN]
[0m18:10:17.287583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m18:10:17.288332 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m18:10:17.291071 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m18:10:17.299814 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m18:10:17.302994 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_location"
[0m18:10:17.311205 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:10:17.312073 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: BEGIN
[0m18:10:17.312761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:17.319078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:17.320053 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:10:17.320736 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */

  
    

  create  table "analytics"."gold"."dim_location__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    latitude,
    longitude
FROM "analytics"."silver"."stg_weather"
  );
  
[0m18:10:17.323339 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m18:10:17.326371 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:10:17.327207 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location" rename to "dim_location__dbt_backup"
[0m18:10:17.328298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:17.330432 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:10:17.331176 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location__dbt_tmp" rename to "dim_location"
[0m18:10:17.332169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:17.333216 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:10:17.333868 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:10:17.334744 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:10:17.337040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:17.339179 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_location__dbt_backup"
[0m18:10:17.339987 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:10:17.340660 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
drop table if exists "analytics"."gold"."dim_location__dbt_backup" cascade
[0m18:10:17.342638 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:10:17.343826 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: Close
[0m18:10:17.344866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6885734-9044-48bd-8f64-2745b7ae02ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75196cb0e050>]}
[0m18:10:17.346630 [info ] [Thread-1 (]: 3 of 4 OK created sql table model gold.dim_location ............................ [[32mSELECT 0[0m in 0.06s]
[0m18:10:17.347732 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m18:10:17.348473 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m18:10:17.349282 [info ] [Thread-1 (]: 4 of 4 START sql table model gold.fct_weather_daily ............................ [RUN]
[0m18:10:17.350357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m18:10:17.351170 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m18:10:17.354204 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m18:10:17.361873 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m18:10:17.366100 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.fct_weather_daily"
[0m18:10:17.372687 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:10:17.373509 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: BEGIN
[0m18:10:17.374223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:17.380312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:17.381542 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:10:17.382430 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */

  
    

  create  table "analytics"."gold"."fct_weather_daily__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_metrics AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        
        -- Basic metrics
        (temp_max_celsius + temp_min_celsius) / 2 AS avg_temp,
        temp_max_celsius AS max_temp,
        temp_min_celsius AS min_temp,
        precipitation_mm AS total_precipitation,
        
        -- 7-day moving average temperature
        AVG((temp_max_celsius + temp_min_celsius) / 2) 
            OVER (
                PARTITION BY city_name 
                ORDER BY observation_date 
                ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ) AS moving_avg_7d_temp

    FROM "analytics"."silver"."stg_weather"
),

final_summary AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        ROUND(avg_temp, 2) AS avg_temp,
        ROUND(max_temp, 2) AS max_temp,
        ROUND(min_temp, 2) AS min_temp,
        ROUND(total_precipitation, 2) AS total_precipitation,
        ROUND(moving_avg_7d_temp, 2) AS moving_avg_7d_temp

    FROM daily_metrics
)

SELECT * FROM final_summary
  );
  
[0m18:10:17.389206 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m18:10:17.392279 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:10:17.393035 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily" rename to "fct_weather_daily__dbt_backup"
[0m18:10:17.394152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:17.396387 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:10:17.397558 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily__dbt_tmp" rename to "fct_weather_daily"
[0m18:10:17.398823 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:17.400154 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:10:17.400829 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:10:17.401503 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:10:17.403055 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:17.405401 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."fct_weather_daily__dbt_backup"
[0m18:10:17.406747 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:10:17.407498 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
drop table if exists "analytics"."gold"."fct_weather_daily__dbt_backup" cascade
[0m18:10:17.410391 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:10:17.411660 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: Close
[0m18:10:17.412540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6885734-9044-48bd-8f64-2745b7ae02ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751971581610>]}
[0m18:10:17.413778 [info ] [Thread-1 (]: 4 of 4 OK created sql table model gold.fct_weather_daily ....................... [[32mSELECT 0[0m in 0.06s]
[0m18:10:17.414783 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m18:10:17.416965 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:17.417812 [debug] [MainThread]: On master: BEGIN
[0m18:10:17.418640 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:17.425098 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:10:17.426304 [debug] [MainThread]: On master: COMMIT
[0m18:10:17.427141 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:17.427915 [debug] [MainThread]: On master: COMMIT
[0m18:10:17.429043 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:17.429776 [debug] [MainThread]: On master: Close
[0m18:10:17.430565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:17.431223 [debug] [MainThread]: Connection 'model.weather_dbt.fct_weather_daily' was properly closed.
[0m18:10:17.432012 [info ] [MainThread]: 
[0m18:10:17.432816 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m18:10:17.434364 [debug] [MainThread]: Command end result
[0m18:10:17.462931 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:10:17.468964 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:10:17.476707 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:10:17.477826 [info ] [MainThread]: 
[0m18:10:17.478917 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:17.479730 [info ] [MainThread]: 
[0m18:10:17.480733 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:10:17.482724 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6886269, "process_in_blocks": "70096", "process_kernel_time": 0.56032, "process_mem_max_rss": "131652", "process_out_blocks": "0", "process_user_time": 2.229275}
[0m18:10:17.483732 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:17.483659 after 1.69 seconds
[0m18:10:17.484443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751971d57a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75197619a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7519760875d0>]}
[0m18:10:17.485582 [debug] [MainThread]: Flushing usage events
[0m18:10:19.151614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:22.103289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef7f219f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef7f26af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef7f2693d0>]}


============================== 18:10:22.108539 | d930a413-c71d-4801-a98d-39012f621541 ==============================
[0m18:10:22.108539 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:10:22.109584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:10:22.213285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd930a413-c71d-4801-a98d-39012f621541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef7f2a7250>]}
[0m18:10:22.249246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd930a413-c71d-4801-a98d-39012f621541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef81bf3f90>]}
[0m18:10:22.250396 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:10:22.323124 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:10:22.504745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:22.505853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:22.532768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd930a413-c71d-4801-a98d-39012f621541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef7d933110>]}
[0m18:10:22.588787 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:10:22.593915 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:10:22.636330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd930a413-c71d-4801-a98d-39012f621541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef7d157dd0>]}
[0m18:10:22.637554 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 435 macros
[0m18:10:22.638446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd930a413-c71d-4801-a98d-39012f621541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef7e12bf50>]}
[0m18:10:22.641097 [info ] [MainThread]: 
[0m18:10:22.642066 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:22.642989 [info ] [MainThread]: 
[0m18:10:22.643922 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:22.647101 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_silver'
[0m18:10:22.729792 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:10:22.731000 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:10:22.731864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:22.738439 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:10:22.739191 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:10:22.740032 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:10:22.743873 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:10:22.745310 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:10:22.746429 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:10:22.747471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m18:10:22.750238 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:10:22.751042 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:10:22.751764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:22.758287 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:10:22.759188 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:10:22.759794 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:10:22.762713 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m18:10:22.764095 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:10:22.764922 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:10:22.769565 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:22.770428 [debug] [MainThread]: On master: BEGIN
[0m18:10:22.771035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:22.776757 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:10:22.777708 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:22.778420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:22.782411 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m18:10:22.783754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd930a413-c71d-4801-a98d-39012f621541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef7d10cb50>]}
[0m18:10:22.784496 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:22.785250 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:22.786293 [debug] [MainThread]: On master: BEGIN
[0m18:10:22.787234 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:10:22.787929 [debug] [MainThread]: On master: COMMIT
[0m18:10:22.788549 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:22.789242 [debug] [MainThread]: On master: COMMIT
[0m18:10:22.789936 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:22.790490 [debug] [MainThread]: On master: Close
[0m18:10:22.794260 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:10:22.795561 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj  [RUN]
[0m18:10:22.796471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816)
[0m18:10:22.797137 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:10:22.806102 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:10:22.814018 [debug] [Thread-1 (]: Began executing node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:10:22.824639 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:10:22.832305 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:10:22.833187 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: BEGIN
[0m18:10:22.833866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:22.839647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:22.840549 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:10:22.841652 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        city_name as value_field,
        count(*) as n_records

    from "analytics"."silver"."stg_weather"
    group by city_name

)

select *
from all_values
where value_field not in (
    'Kathmandu','Pokhara','Biratnagar','Birgunj'
)



  
  
      
    ) dbt_internal_test
[0m18:10:22.844428 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:10:22.847148 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: ROLLBACK
[0m18:10:22.848009 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: Close
[0m18:10:22.848993 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj  [[32mPASS[0m in 0.05s]
[0m18:10:22.850520 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:10:22.851528 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:10:22.852157 [info ] [Thread-1 (]: 2 of 11 START test not_null_stg_weather_city_name .............................. [RUN]
[0m18:10:22.853031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816, now test.weather_dbt.not_null_stg_weather_city_name.d57308e884)
[0m18:10:22.853670 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:10:22.857837 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:10:22.866093 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:10:22.868924 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:10:22.876353 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:10:22.877179 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: BEGIN
[0m18:10:22.878309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:22.883936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:22.884812 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:10:22.885671 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_name
from "analytics"."silver"."stg_weather"
where city_name is null



  
  
      
    ) dbt_internal_test
[0m18:10:22.888466 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:10:22.890514 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: ROLLBACK
[0m18:10:22.891274 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: Close
[0m18:10:22.892055 [info ] [Thread-1 (]: 2 of 11 PASS not_null_stg_weather_city_name .................................... [[32mPASS[0m in 0.04s]
[0m18:10:22.892966 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:10:22.894003 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:10:22.894691 [info ] [Thread-1 (]: 3 of 11 START test not_null_stg_weather_ingested_at ............................ [RUN]
[0m18:10:22.895401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_city_name.d57308e884, now test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516)
[0m18:10:22.896402 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:10:22.899135 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:10:22.905994 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:10:22.908387 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:10:22.915759 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:10:22.916517 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: BEGIN
[0m18:10:22.917146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:22.923206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:22.924288 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:10:22.924894 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ingested_at
from "analytics"."silver"."stg_weather"
where ingested_at is null



  
  
      
    ) dbt_internal_test
[0m18:10:22.927044 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:10:22.928435 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: ROLLBACK
[0m18:10:22.929278 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: Close
[0m18:10:22.930355 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stg_weather_ingested_at .................................. [[32mPASS[0m in 0.03s]
[0m18:10:22.931307 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:10:22.931931 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:10:22.933212 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_weather_latitude ............................... [RUN]
[0m18:10:22.934144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516, now test.weather_dbt.not_null_stg_weather_latitude.35769df29a)
[0m18:10:22.934785 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:10:22.937905 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:10:22.945186 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:10:22.948217 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:10:22.956383 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:10:22.957350 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: BEGIN
[0m18:10:22.958136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:22.963915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:22.965026 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:10:22.965852 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from "analytics"."silver"."stg_weather"
where latitude is null



  
  
      
    ) dbt_internal_test
[0m18:10:22.968200 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:10:22.970228 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: ROLLBACK
[0m18:10:22.971173 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: Close
[0m18:10:22.972069 [info ] [Thread-1 (]: 4 of 11 PASS not_null_stg_weather_latitude ..................................... [[32mPASS[0m in 0.04s]
[0m18:10:22.972988 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:10:22.973739 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:10:22.974488 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_weather_longitude .............................. [RUN]
[0m18:10:22.975364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_latitude.35769df29a, now test.weather_dbt.not_null_stg_weather_longitude.04815d6a63)
[0m18:10:22.976108 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:10:22.979135 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:10:22.986342 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:10:22.989009 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:10:22.997287 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:10:22.998069 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: BEGIN
[0m18:10:22.998801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:23.003862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:10:23.004857 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:10:23.005622 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from "analytics"."silver"."stg_weather"
where longitude is null



  
  
      
    ) dbt_internal_test
[0m18:10:23.007997 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:10:23.009983 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: ROLLBACK
[0m18:10:23.011177 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: Close
[0m18:10:23.012279 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_weather_longitude .................................... [[32mPASS[0m in 0.04s]
[0m18:10:23.013290 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:10:23.014129 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:10:23.015014 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_weather_observation_date ....................... [RUN]
[0m18:10:23.015934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_longitude.04815d6a63, now test.weather_dbt.not_null_stg_weather_observation_date.9a16015555)
[0m18:10:23.016579 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:10:23.019754 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:10:23.028497 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:10:23.030765 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:10:23.038505 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:10:23.039396 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: BEGIN
[0m18:10:23.040181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:23.047149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:10:23.048160 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:10:23.048774 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select observation_date
from "analytics"."silver"."stg_weather"
where observation_date is null



  
  
      
    ) dbt_internal_test
[0m18:10:23.050815 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:10:23.052601 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: ROLLBACK
[0m18:10:23.053701 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: Close
[0m18:10:23.054903 [info ] [Thread-1 (]: 6 of 11 PASS not_null_stg_weather_observation_date ............................. [[32mPASS[0m in 0.04s]
[0m18:10:23.055964 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:10:23.056823 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:10:23.057616 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_weather_precipitation_mm ....................... [RUN]
[0m18:10:23.058517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_observation_date.9a16015555, now test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4)
[0m18:10:23.059123 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:10:23.062044 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:10:23.069312 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:10:23.071755 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:10:23.080270 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:10:23.081563 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: BEGIN
[0m18:10:23.082308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:23.088428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:23.089552 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:10:23.090419 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select precipitation_mm
from "analytics"."silver"."stg_weather"
where precipitation_mm is null



  
  
      
    ) dbt_internal_test
[0m18:10:23.092609 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:10:23.094255 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: ROLLBACK
[0m18:10:23.095244 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: Close
[0m18:10:23.096294 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_weather_precipitation_mm ............................. [[32mPASS[0m in 0.04s]
[0m18:10:23.097564 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:10:23.098723 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:10:23.099465 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_weather_temp_max_celsius ....................... [RUN]
[0m18:10:23.100416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4, now test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82)
[0m18:10:23.101136 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:10:23.103752 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:10:23.110760 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:10:23.112964 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:10:23.121679 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:10:23.122492 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: BEGIN
[0m18:10:23.123212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:23.129800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:10:23.131008 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:10:23.131879 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select temp_max_celsius
from "analytics"."silver"."stg_weather"
where temp_max_celsius is null



  
  
      
    ) dbt_internal_test
[0m18:10:23.133894 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:10:23.135467 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: ROLLBACK
[0m18:10:23.136354 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: Close
[0m18:10:23.137216 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_weather_temp_max_celsius ............................. [[32mPASS[0m in 0.04s]
[0m18:10:23.138325 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:10:23.139048 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:10:23.139666 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_weather_temp_min_celsius ....................... [RUN]
[0m18:10:23.140354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82, now test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6)
[0m18:10:23.140892 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:10:23.144084 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:10:23.151097 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:10:23.153113 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:10:23.160170 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:10:23.160833 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: BEGIN
[0m18:10:23.161588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:23.167406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:23.168310 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:10:23.168913 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select temp_min_celsius
from "analytics"."silver"."stg_weather"
where temp_min_celsius is null



  
  
      
    ) dbt_internal_test
[0m18:10:23.170960 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:10:23.172776 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: ROLLBACK
[0m18:10:23.173756 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: Close
[0m18:10:23.174861 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_weather_temp_min_celsius ............................. [[32mPASS[0m in 0.03s]
[0m18:10:23.175823 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:10:23.176530 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:10:23.177159 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_weather_weather_surrogate_key ................. [RUN]
[0m18:10:23.177982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6, now test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab)
[0m18:10:23.178634 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:10:23.183284 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:10:23.190776 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:10:23.193255 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:10:23.200585 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:10:23.201382 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: BEGIN
[0m18:10:23.202015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:23.207529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:10:23.208779 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:10:23.209571 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select weather_surrogate_key
from "analytics"."silver"."stg_weather"
where weather_surrogate_key is null



  
  
      
    ) dbt_internal_test
[0m18:10:23.211727 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:10:23.213016 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: ROLLBACK
[0m18:10:23.213879 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: Close
[0m18:10:23.214800 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_weather_weather_surrogate_key ....................... [[32mPASS[0m in 0.04s]
[0m18:10:23.215771 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:10:23.216857 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:10:23.217831 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_weather_weather_surrogate_key ................... [RUN]
[0m18:10:23.218705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab, now test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20)
[0m18:10:23.219511 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:10:23.223717 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:10:23.231107 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:10:23.232928 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:10:23.240963 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:10:23.241938 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: BEGIN
[0m18:10:23.242846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:23.249048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:23.249933 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:10:23.250572 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    weather_surrogate_key as unique_field,
    count(*) as n_records

from "analytics"."silver"."stg_weather"
where weather_surrogate_key is not null
group by weather_surrogate_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:10:23.252510 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:10:23.254483 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: ROLLBACK
[0m18:10:23.255726 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: Close
[0m18:10:23.256792 [info ] [Thread-1 (]: 11 of 11 PASS unique_stg_weather_weather_surrogate_key ......................... [[32mPASS[0m in 0.04s]
[0m18:10:23.257798 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:10:23.259598 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:23.260425 [debug] [MainThread]: On master: BEGIN
[0m18:10:23.261141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:23.266550 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:10:23.267578 [debug] [MainThread]: On master: COMMIT
[0m18:10:23.268350 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:23.269051 [debug] [MainThread]: On master: COMMIT
[0m18:10:23.270158 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:23.271052 [debug] [MainThread]: On master: Close
[0m18:10:23.272188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:23.273329 [debug] [MainThread]: Connection 'test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20' was properly closed.
[0m18:10:23.274204 [info ] [MainThread]: 
[0m18:10:23.275133 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m18:10:23.276936 [debug] [MainThread]: Command end result
[0m18:10:23.305398 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:10:23.311877 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:10:23.321547 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:10:23.322401 [info ] [MainThread]: 
[0m18:10:23.323303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:23.324227 [info ] [MainThread]: 
[0m18:10:23.324991 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m18:10:23.326616 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2648745, "process_in_blocks": "1224", "process_kernel_time": 0.434362, "process_mem_max_rss": "128432", "process_out_blocks": "0", "process_user_time": 1.781325}
[0m18:10:23.327783 [debug] [MainThread]: Command `dbt test` succeeded at 18:10:23.327676 after 1.27 seconds
[0m18:10:23.328679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef7f290650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef7f292850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bef8387e990>]}
[0m18:10:23.329711 [debug] [MainThread]: Flushing usage events
[0m18:10:24.541741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:22.886648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c95071290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c975c4c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c95071150>]}


============================== 18:12:22.893612 | bd72b011-23d2-450c-bb28-aea4c7e25c7d ==============================
[0m18:12:22.893612 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:12:22.894642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:12:23.129066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd72b011-23d2-450c-bb28-aea4c7e25c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c95be7e90>]}
[0m18:12:23.166221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd72b011-23d2-450c-bb28-aea4c7e25c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c97a17e90>]}
[0m18:12:23.168249 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:12:23.247270 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:12:23.456818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:23.457832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:23.484163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd72b011-23d2-450c-bb28-aea4c7e25c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c94f2f1d0>]}
[0m18:12:23.514076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd72b011-23d2-450c-bb28-aea4c7e25c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c937ad090>]}
[0m18:12:23.514906 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 435 macros
[0m18:12:23.515702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd72b011-23d2-450c-bb28-aea4c7e25c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c9379f210>]}
[0m18:12:23.517798 [info ] [MainThread]: 
[0m18:12:23.518851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:23.519815 [info ] [MainThread]: 
[0m18:12:23.521227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:23.524440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_gold'
[0m18:12:23.560212 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:12:23.561737 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:12:23.562373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:23.569188 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:12:23.570215 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:12:23.570838 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:12:23.574304 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m18:12:23.576159 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:12:23.577170 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:12:23.577976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_gold, now list_analytics_silver)
[0m18:12:23.580176 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:12:23.580795 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:12:23.581645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:23.586988 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:12:23.587923 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:12:23.588573 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:12:23.591361 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:12:23.592752 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:12:23.593756 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:12:23.597921 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:23.598576 [debug] [MainThread]: On master: BEGIN
[0m18:12:23.599078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:23.605533 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:12:23.606398 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:23.607057 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:12:23.611577 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m18:12:23.612950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd72b011-23d2-450c-bb28-aea4c7e25c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c9333fc90>]}
[0m18:12:23.613667 [debug] [MainThread]: On master: ROLLBACK
[0m18:12:23.614617 [debug] [MainThread]: On master: Close
[0m18:12:23.619079 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m18:12:23.620048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_silver, now model.weather_dbt.stg_weather)
[0m18:12:23.620799 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m18:12:23.626370 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m18:12:23.633945 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m18:12:23.635352 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m18:12:23.636933 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m18:12:23.637874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m18:12:23.638637 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m18:12:23.641332 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m18:12:23.648266 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m18:12:23.649687 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m18:12:23.650450 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m18:12:23.652129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m18:12:23.652825 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m18:12:23.654822 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m18:12:23.661298 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m18:12:23.662401 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m18:12:23.663179 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m18:12:23.663744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m18:12:23.664299 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m18:12:23.719927 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m18:12:23.726830 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m18:12:23.727821 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m18:12:23.728501 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:12:23.729211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.fct_weather_daily, now test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816)
[0m18:12:23.729935 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:12:23.737274 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:12:23.745548 [debug] [Thread-1 (]: Began executing node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:12:23.746580 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:12:23.747300 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:12:23.747984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816, now test.weather_dbt.not_null_stg_weather_city_name.d57308e884)
[0m18:12:23.748645 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:12:23.753745 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:12:23.761983 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:12:23.763270 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:12:23.763923 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:12:23.764536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_city_name.d57308e884, now test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516)
[0m18:12:23.765090 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:12:23.767598 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:12:23.774713 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:12:23.775852 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:12:23.776768 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:12:23.777829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516, now test.weather_dbt.not_null_stg_weather_latitude.35769df29a)
[0m18:12:23.778440 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:12:23.781574 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:12:23.789431 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:12:23.790593 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:12:23.791363 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:12:23.791994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_latitude.35769df29a, now test.weather_dbt.not_null_stg_weather_longitude.04815d6a63)
[0m18:12:23.792536 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:12:23.795062 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:12:23.802415 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:12:23.803305 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:12:23.803906 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:12:23.804934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_longitude.04815d6a63, now test.weather_dbt.not_null_stg_weather_observation_date.9a16015555)
[0m18:12:23.805639 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:12:23.808554 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:12:23.816179 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:12:23.817055 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:12:23.817946 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:12:23.818683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_observation_date.9a16015555, now test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4)
[0m18:12:23.819238 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:12:23.821808 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:12:23.829001 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:12:23.830159 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:12:23.830905 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:12:23.831698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4, now test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82)
[0m18:12:23.832882 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:12:23.835500 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:12:23.843575 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:12:23.844505 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:12:23.845234 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:12:23.846013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82, now test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6)
[0m18:12:23.846596 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:12:23.850413 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:12:23.857210 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:12:23.858189 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:12:23.858936 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:12:23.859900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6, now test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab)
[0m18:12:23.860766 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:12:23.863669 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:12:23.871348 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:12:23.872357 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:12:23.873095 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:12:23.873816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab, now test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20)
[0m18:12:23.874491 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:12:23.878865 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:12:23.885812 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:12:23.887300 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:12:23.888881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:23.889439 [debug] [MainThread]: Connection 'test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20' was properly closed.
[0m18:12:23.890965 [debug] [MainThread]: Command end result
[0m18:12:23.944633 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:12:23.963918 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:12:23.970790 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:12:23.989389 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:12:23.990136 [info ] [MainThread]: Building catalog
[0m18:12:23.995730 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m18:12:24.000832 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m18:12:24.001724 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m18:12:24.002288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:24.009268 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:12:24.010331 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m18:12:24.011215 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('dim_location')) or (upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('fct_weather_daily')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('weather_raw')) or (upper(sch.nspname) = upper('silver') and
           upper(tbl.relname) = upper('stg_weather')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:12:24.020095 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.008 seconds
[0m18:12:24.022464 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m18:12:24.023382 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m18:12:24.033289 [debug] [MainThread]: Wrote artifact CatalogArtifact to /opt/airflow/dbt/weather_dbt/target/catalog.json
[0m18:12:24.059092 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:12:24.063853 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:12:24.064793 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/weather_dbt/target/catalog.json
[0m18:12:24.066481 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.2289175, "process_in_blocks": "73992", "process_kernel_time": 0.524057, "process_mem_max_rss": "127156", "process_out_blocks": "0", "process_user_time": 1.894033}
[0m18:12:24.067436 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:12:24.067331 after 1.23 seconds
[0m18:12:24.068212 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:12:24.068732 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m18:12:24.069267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c9531a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c99601850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c922b7290>]}
[0m18:12:24.070685 [debug] [MainThread]: Flushing usage events
[0m18:12:25.335362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:24:25.208653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7655784ab990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76557868f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7655784a8550>]}


============================== 18:24:25.215269 | 803d8b0b-439a-4fc7-b5a5-54e6a8332c1d ==============================
[0m18:24:25.215269 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:24:25.219146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:24:25.409982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '803d8b0b-439a-4fc7-b5a5-54e6a8332c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765577b0b690>]}
[0m18:24:25.455316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '803d8b0b-439a-4fc7-b5a5-54e6a8332c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76557ae7e350>]}
[0m18:24:25.457494 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:24:25.553633 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:24:25.801446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:24:25.802929 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:24:25.832891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '803d8b0b-439a-4fc7-b5a5-54e6a8332c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7655773466d0>]}
[0m18:24:25.910626 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:24:25.919611 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:24:25.966943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '803d8b0b-439a-4fc7-b5a5-54e6a8332c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765576786e90>]}
[0m18:24:25.970422 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 435 macros
[0m18:24:25.971731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '803d8b0b-439a-4fc7-b5a5-54e6a8332c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765577b0b590>]}
[0m18:24:25.974049 [info ] [MainThread]: 
[0m18:24:25.974944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:25.975960 [info ] [MainThread]: 
[0m18:24:25.977359 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:24:25.981370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m18:24:26.082983 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:24:26.084186 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:24:26.085124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:26.095092 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m18:24:26.098847 [debug] [ThreadPool]: On list_analytics: Close
[0m18:24:26.102164 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:24:26.103127 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:24:26.103953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:26.110811 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m18:24:26.112341 [debug] [ThreadPool]: On list_analytics: Close
[0m18:24:26.114354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_silver)
[0m18:24:26.118989 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:24:26.120205 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:24:26.121415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:26.128256 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:24:26.129195 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:24:26.129989 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:24:26.136066 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m18:24:26.138308 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:24:26.139319 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:24:26.140621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m18:24:26.142658 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:24:26.143510 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:24:26.144308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:26.150873 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:24:26.152133 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:24:26.152890 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:24:26.156052 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m18:24:26.157990 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:24:26.158990 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:24:26.163514 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:26.165535 [debug] [MainThread]: On master: BEGIN
[0m18:24:26.167306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:26.173953 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:24:26.175107 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:26.176054 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:24:26.183217 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m18:24:26.185176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '803d8b0b-439a-4fc7-b5a5-54e6a8332c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76557567f9d0>]}
[0m18:24:26.186162 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:26.187532 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:26.188582 [debug] [MainThread]: On master: BEGIN
[0m18:24:26.189648 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:24:26.190820 [debug] [MainThread]: On master: COMMIT
[0m18:24:26.191752 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:26.192581 [debug] [MainThread]: On master: COMMIT
[0m18:24:26.193783 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:24:26.194854 [debug] [MainThread]: On master: Close
[0m18:24:26.201552 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m18:24:26.202902 [info ] [Thread-1 (]: 1 of 4 START sql view model silver.stg_weather ................................. [RUN]
[0m18:24:26.204185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now model.weather_dbt.stg_weather)
[0m18:24:26.205013 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m18:24:26.210462 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m18:24:26.222480 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m18:24:26.243827 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.stg_weather"
[0m18:24:26.258949 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:24:26.260014 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: BEGIN
[0m18:24:26.261064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:26.267264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:24:26.268860 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:24:26.269871 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */

  create view "analytics"."silver"."stg_weather__dbt_tmp"
    
    
  as (
    

WITH ranked_weather AS (
    SELECT
        *,  -- Keep raw types, cast later
        ROW_NUMBER() OVER(
            PARTITION BY city_name, day 
            ORDER BY ingested_at DESC
        ) AS rn
    FROM "analytics"."bronze"."weather_raw"
),  -- ✅ Fixed: Added comma

deduped_weather AS (
    SELECT
        MD5(city_name || '|' || day::TEXT) AS weather_surrogate_key,  -- ✅ PostgreSQL fix
        
        CAST(day AS DATE) AS observation_date,
        CAST(city_name AS VARCHAR(50)) AS city_name,
        CAST(latitude AS DECIMAL(9,6)) AS latitude,
        CAST(longitude AS DECIMAL(9,6)) AS longitude,
        CAST(temp_max AS DECIMAL(5,2)) AS temp_max_celsius,
        CAST(temp_min AS DECIMAL(5,2)) AS temp_min_celsius,
        CAST(precipitation_sum AS DECIMAL(6,2)) AS precipitation_mm,
        CAST(ingested_at AS TIMESTAMP) AS ingested_at
    FROM ranked_weather
    WHERE rn = 1
        AND city_name IS NOT NULL 
        AND latitude IS NOT NULL 
        AND longitude IS NOT NULL
        AND day IS NOT NULL
        AND temp_max IS NOT NULL 
        AND temp_min IS NOT NULL
)

SELECT * FROM deduped_weather
  );
[0m18:24:26.281088 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m18:24:26.286542 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:24:26.287886 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m18:24:26.289381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:24:26.300154 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:24:26.301302 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:24:26.302325 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:24:26.304693 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:24:26.310224 [debug] [Thread-1 (]: Applying DROP to: "analytics"."silver"."stg_weather__dbt_backup"
[0m18:24:26.314909 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:24:26.315996 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
drop view if exists "analytics"."silver"."stg_weather__dbt_backup" cascade
[0m18:24:26.319062 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:24:26.322327 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: Close
[0m18:24:26.325227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803d8b0b-439a-4fc7-b5a5-54e6a8332c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7655756363d0>]}
[0m18:24:26.326679 [info ] [Thread-1 (]: 1 of 4 OK created sql view model silver.stg_weather ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m18:24:26.328082 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m18:24:26.329569 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m18:24:26.330597 [info ] [Thread-1 (]: 2 of 4 START sql table model gold.dim_date ..................................... [RUN]
[0m18:24:26.331594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m18:24:26.332614 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m18:24:26.336094 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m18:24:26.345095 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m18:24:26.361377 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_date"
[0m18:24:26.369355 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:24:26.370287 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: BEGIN
[0m18:24:26.371059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:26.377853 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:24:26.379022 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:24:26.379899 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */

  
    

  create  table "analytics"."gold"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    SELECT
        min(observation_date) as min_day,
        max(observation_date) as max_day
    FROM "analytics"."silver"."stg_weather"    
),
dates as (
    select generate_series(min_day, max_day, interval '1 day')::date as date_day
    from bounds
)
SELECT
    date_day,
    extract(year from date_day)::int as year,
    extract(month from date_day)::int as month,
    to_char(date_day, 'Mon')  as month_name,
    extract(day from date_day) as day_of_month,
    extract(dow from date_day)::int as day_of_week,
    to_char(date_day, 'Dy') as day_name,
    case when extract(dow from date_day) in (0,6) then true else false end as is_weekend
FROM dates
  );
  
[0m18:24:26.394253 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.013 seconds
[0m18:24:26.399376 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:24:26.400445 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
alter table "analytics"."gold"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:24:26.401735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:24:26.403606 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m18:24:26.404623 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:24:26.405322 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m18:24:26.407705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:24:26.411602 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_date__dbt_backup"
[0m18:24:26.417928 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:24:26.419018 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
drop table if exists "analytics"."gold"."dim_date__dbt_backup" cascade
[0m18:24:26.420411 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:24:26.421843 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: Close
[0m18:24:26.422905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803d8b0b-439a-4fc7-b5a5-54e6a8332c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76557557be50>]}
[0m18:24:26.424100 [info ] [Thread-1 (]: 2 of 4 OK created sql table model gold.dim_date ................................ [[32mSELECT 0[0m in 0.09s]
[0m18:24:26.425204 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m18:24:26.425995 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m18:24:26.427122 [info ] [Thread-1 (]: 3 of 4 START sql table model gold.dim_location ................................. [RUN]
[0m18:24:26.428369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m18:24:26.429146 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m18:24:26.431602 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m18:24:26.439944 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m18:24:26.442920 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_location"
[0m18:24:26.451082 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:24:26.452175 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: BEGIN
[0m18:24:26.453077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:26.460666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:24:26.461819 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:24:26.462648 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */

  
    

  create  table "analytics"."gold"."dim_location__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    latitude,
    longitude
FROM "analytics"."silver"."stg_weather"
  );
  
[0m18:24:26.465650 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m18:24:26.468914 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:24:26.469925 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location__dbt_tmp" rename to "dim_location"
[0m18:24:26.471432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:24:26.472883 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:24:26.474411 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:24:26.476998 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:24:26.479513 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:24:26.481878 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_location__dbt_backup"
[0m18:24:26.482940 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:24:26.483851 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
drop table if exists "analytics"."gold"."dim_location__dbt_backup" cascade
[0m18:24:26.484845 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:24:26.486556 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: Close
[0m18:24:26.488275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803d8b0b-439a-4fc7-b5a5-54e6a8332c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76557555f410>]}
[0m18:24:26.489531 [info ] [Thread-1 (]: 3 of 4 OK created sql table model gold.dim_location ............................ [[32mSELECT 0[0m in 0.06s]
[0m18:24:26.490753 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m18:24:26.491625 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m18:24:26.492496 [info ] [Thread-1 (]: 4 of 4 START sql table model gold.fct_weather_daily ............................ [RUN]
[0m18:24:26.493297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m18:24:26.494369 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m18:24:26.497317 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m18:24:26.506116 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m18:24:26.510407 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.fct_weather_daily"
[0m18:24:26.519288 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:24:26.520239 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: BEGIN
[0m18:24:26.521032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:26.527844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:24:26.528932 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:24:26.529664 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */

  
    

  create  table "analytics"."gold"."fct_weather_daily__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_metrics AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        
        -- Basic metrics
        (temp_max_celsius + temp_min_celsius) / 2 AS avg_temp,
        temp_max_celsius AS max_temp,
        temp_min_celsius AS min_temp,
        precipitation_mm AS total_precipitation,
        
        -- 7-day moving average temperature
        AVG((temp_max_celsius + temp_min_celsius) / 2) 
            OVER (
                PARTITION BY city_name 
                ORDER BY observation_date 
                ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ) AS moving_avg_7d_temp

    FROM "analytics"."silver"."stg_weather"
),

final_summary AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        ROUND(avg_temp, 2) AS avg_temp,
        ROUND(max_temp, 2) AS max_temp,
        ROUND(min_temp, 2) AS min_temp,
        ROUND(total_precipitation, 2) AS total_precipitation,
        ROUND(moving_avg_7d_temp, 2) AS moving_avg_7d_temp

    FROM daily_metrics
)

SELECT * FROM final_summary
  );
  
[0m18:24:26.538897 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m18:24:26.542199 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:24:26.543069 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily__dbt_tmp" rename to "fct_weather_daily"
[0m18:24:26.544427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:24:26.545739 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:24:26.546538 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:24:26.547627 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:24:26.549308 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:24:26.552278 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."fct_weather_daily__dbt_backup"
[0m18:24:26.553319 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:24:26.554085 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
drop table if exists "analytics"."gold"."fct_weather_daily__dbt_backup" cascade
[0m18:24:26.555191 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:24:26.557225 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: Close
[0m18:24:26.558860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803d8b0b-439a-4fc7-b5a5-54e6a8332c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76557850e410>]}
[0m18:24:26.560217 [info ] [Thread-1 (]: 4 of 4 OK created sql table model gold.fct_weather_daily ....................... [[32mSELECT 0[0m in 0.07s]
[0m18:24:26.561447 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m18:24:26.564019 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:26.564817 [debug] [MainThread]: On master: BEGIN
[0m18:24:26.565468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:24:26.572803 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:24:26.574038 [debug] [MainThread]: On master: COMMIT
[0m18:24:26.574948 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:26.575818 [debug] [MainThread]: On master: COMMIT
[0m18:24:26.576856 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:24:26.577938 [debug] [MainThread]: On master: Close
[0m18:24:26.578816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:26.579580 [debug] [MainThread]: Connection 'model.weather_dbt.fct_weather_daily' was properly closed.
[0m18:24:26.580549 [info ] [MainThread]: 
[0m18:24:26.581522 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m18:24:26.582618 [debug] [MainThread]: Command end result
[0m18:24:26.614103 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:24:26.621512 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:24:26.630763 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:24:26.632049 [info ] [MainThread]: 
[0m18:24:26.633047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:26.633728 [info ] [MainThread]: 
[0m18:24:26.634754 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:24:26.636433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.485158, "process_in_blocks": "31048", "process_kernel_time": 0.616292, "process_mem_max_rss": "127600", "process_out_blocks": "2200", "process_user_time": 2.241448}
[0m18:24:26.638042 [debug] [MainThread]: Command `dbt run` succeeded at 18:24:26.637821 after 1.49 seconds
[0m18:24:26.639170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76557ca747d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76557c9bf690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76557c9bf5d0>]}
[0m18:24:26.640329 [debug] [MainThread]: Flushing usage events
[0m18:24:28.182401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:24:30.712872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b8bc20c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b8c7a4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b8bc20b50>]}


============================== 18:24:30.721372 | 9c6e5524-7191-4b6a-84e3-57b54c31290b ==============================
[0m18:24:30.721372 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:24:30.722565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:24:30.844611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c6e5524-7191-4b6a-84e3-57b54c31290b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b8bb5f6d0>]}
[0m18:24:30.886286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c6e5524-7191-4b6a-84e3-57b54c31290b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b8e5dc750>]}
[0m18:24:30.887813 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:24:30.971289 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:24:31.223061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:24:31.224101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:24:31.254340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c6e5524-7191-4b6a-84e3-57b54c31290b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b8bec9750>]}
[0m18:24:31.322730 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:24:31.328410 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:24:31.365659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c6e5524-7191-4b6a-84e3-57b54c31290b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b89b3bd50>]}
[0m18:24:31.367545 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 435 macros
[0m18:24:31.368616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c6e5524-7191-4b6a-84e3-57b54c31290b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b8ab07cd0>]}
[0m18:24:31.370618 [info ] [MainThread]: 
[0m18:24:31.371675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:31.372622 [info ] [MainThread]: 
[0m18:24:31.373524 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:24:31.377013 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_gold'
[0m18:24:31.473286 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:24:31.474383 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:24:31.475406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:31.483379 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:24:31.484447 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:24:31.485325 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:24:31.489078 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m18:24:31.490824 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:24:31.491672 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:24:31.492536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_gold, now list_analytics_silver)
[0m18:24:31.495560 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:24:31.496484 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:24:31.497544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:31.504461 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:24:31.505371 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:24:31.506048 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:24:31.509420 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:31.511160 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:24:31.512309 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:24:31.516432 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:31.517618 [debug] [MainThread]: On master: BEGIN
[0m18:24:31.518417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:31.524718 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:24:31.525698 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:31.526684 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:24:31.531207 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m18:24:31.533755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c6e5524-7191-4b6a-84e3-57b54c31290b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b8c797c50>]}
[0m18:24:31.536510 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:31.537777 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:31.538600 [debug] [MainThread]: On master: BEGIN
[0m18:24:31.539744 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:24:31.540653 [debug] [MainThread]: On master: COMMIT
[0m18:24:31.541408 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:31.542097 [debug] [MainThread]: On master: COMMIT
[0m18:24:31.542938 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:24:31.543691 [debug] [MainThread]: On master: Close
[0m18:24:31.547995 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:24:31.549085 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj  [RUN]
[0m18:24:31.550499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_silver, now test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816)
[0m18:24:31.551359 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:24:31.562406 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:24:31.571776 [debug] [Thread-1 (]: Began executing node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:24:31.583475 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:24:31.592881 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:24:31.593945 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: BEGIN
[0m18:24:31.594732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:31.601640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:24:31.603719 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:24:31.606090 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        city_name as value_field,
        count(*) as n_records

    from "analytics"."silver"."stg_weather"
    group by city_name

)

select *
from all_values
where value_field not in (
    'Kathmandu','Pokhara','Biratnagar','Birgunj'
)



  
  
      
    ) dbt_internal_test
[0m18:24:31.610308 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:24:31.613908 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: ROLLBACK
[0m18:24:31.614977 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: Close
[0m18:24:31.616286 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj  [[32mPASS[0m in 0.07s]
[0m18:24:31.617562 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:24:31.618373 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:24:31.619094 [info ] [Thread-1 (]: 2 of 11 START test not_null_stg_weather_city_name .............................. [RUN]
[0m18:24:31.619938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816, now test.weather_dbt.not_null_stg_weather_city_name.d57308e884)
[0m18:24:31.620654 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:24:31.625864 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:24:31.634193 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:24:31.636615 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:24:31.645316 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:24:31.646062 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: BEGIN
[0m18:24:31.647087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:31.653040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:24:31.654166 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:24:31.655150 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_name
from "analytics"."silver"."stg_weather"
where city_name is null



  
  
      
    ) dbt_internal_test
[0m18:24:31.657333 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:24:31.659438 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: ROLLBACK
[0m18:24:31.660624 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: Close
[0m18:24:31.661539 [info ] [Thread-1 (]: 2 of 11 PASS not_null_stg_weather_city_name .................................... [[32mPASS[0m in 0.04s]
[0m18:24:31.663245 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:24:31.666213 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:24:31.667430 [info ] [Thread-1 (]: 3 of 11 START test not_null_stg_weather_ingested_at ............................ [RUN]
[0m18:24:31.668496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_city_name.d57308e884, now test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516)
[0m18:24:31.669225 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:24:31.672161 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:24:31.680631 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:24:31.682752 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:24:31.692238 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:24:31.693222 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: BEGIN
[0m18:24:31.694320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:31.701257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:24:31.702386 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:24:31.703471 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ingested_at
from "analytics"."silver"."stg_weather"
where ingested_at is null



  
  
      
    ) dbt_internal_test
[0m18:24:31.705729 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:24:31.708063 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: ROLLBACK
[0m18:24:31.709307 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: Close
[0m18:24:31.710388 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stg_weather_ingested_at .................................. [[32mPASS[0m in 0.04s]
[0m18:24:31.711683 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:24:31.713554 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:24:31.716260 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_weather_latitude ............................... [RUN]
[0m18:24:31.717442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516, now test.weather_dbt.not_null_stg_weather_latitude.35769df29a)
[0m18:24:31.718382 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:24:31.722316 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:24:31.733021 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:24:31.737095 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:24:31.748161 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:24:31.749320 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: BEGIN
[0m18:24:31.750153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:31.757914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:24:31.759292 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:24:31.760743 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from "analytics"."silver"."stg_weather"
where latitude is null



  
  
      
    ) dbt_internal_test
[0m18:24:31.763595 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:31.765472 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: ROLLBACK
[0m18:24:31.768558 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: Close
[0m18:24:31.771412 [info ] [Thread-1 (]: 4 of 11 PASS not_null_stg_weather_latitude ..................................... [[32mPASS[0m in 0.05s]
[0m18:24:31.772682 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:24:31.773688 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:24:31.774606 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_weather_longitude .............................. [RUN]
[0m18:24:31.775655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_latitude.35769df29a, now test.weather_dbt.not_null_stg_weather_longitude.04815d6a63)
[0m18:24:31.777629 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:24:31.781536 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:24:31.792700 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:24:31.796112 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:24:31.807292 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:24:31.808309 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: BEGIN
[0m18:24:31.809244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:31.816365 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:24:31.817763 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:24:31.818737 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from "analytics"."silver"."stg_weather"
where longitude is null



  
  
      
    ) dbt_internal_test
[0m18:24:31.821409 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:31.823292 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: ROLLBACK
[0m18:24:31.824466 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: Close
[0m18:24:31.825621 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_weather_longitude .................................... [[32mPASS[0m in 0.05s]
[0m18:24:31.826854 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:24:31.827899 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:24:31.828963 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_weather_observation_date ....................... [RUN]
[0m18:24:31.830294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_longitude.04815d6a63, now test.weather_dbt.not_null_stg_weather_observation_date.9a16015555)
[0m18:24:31.831475 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:24:31.834739 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:24:31.847697 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:24:31.850733 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:24:31.860821 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:24:31.861818 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: BEGIN
[0m18:24:31.862718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:31.869976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:24:31.871150 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:24:31.871981 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select observation_date
from "analytics"."silver"."stg_weather"
where observation_date is null



  
  
      
    ) dbt_internal_test
[0m18:24:31.874637 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:31.876936 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: ROLLBACK
[0m18:24:31.878300 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: Close
[0m18:24:31.879663 [info ] [Thread-1 (]: 6 of 11 PASS not_null_stg_weather_observation_date ............................. [[32mPASS[0m in 0.05s]
[0m18:24:31.880926 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:24:31.881948 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:24:31.883039 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_weather_precipitation_mm ....................... [RUN]
[0m18:24:31.884294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_observation_date.9a16015555, now test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4)
[0m18:24:31.885209 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:24:31.888755 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:24:31.898518 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:24:31.901521 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:24:31.914053 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:24:31.915038 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: BEGIN
[0m18:24:31.915982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:31.922509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:24:31.923828 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:24:31.924898 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select precipitation_mm
from "analytics"."silver"."stg_weather"
where precipitation_mm is null



  
  
      
    ) dbt_internal_test
[0m18:24:31.927603 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:31.929364 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: ROLLBACK
[0m18:24:31.930524 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: Close
[0m18:24:31.931840 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_weather_precipitation_mm ............................. [[32mPASS[0m in 0.05s]
[0m18:24:31.933008 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:24:31.934038 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:24:31.935071 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_weather_temp_max_celsius ....................... [RUN]
[0m18:24:31.936276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4, now test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82)
[0m18:24:31.937491 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:24:31.941080 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:24:31.951037 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:24:31.954076 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:24:31.970818 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:24:31.971924 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: BEGIN
[0m18:24:31.972913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:31.980150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:24:31.981405 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:24:31.982410 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select temp_max_celsius
from "analytics"."silver"."stg_weather"
where temp_max_celsius is null



  
  
      
    ) dbt_internal_test
[0m18:24:31.985173 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:31.987067 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: ROLLBACK
[0m18:24:31.988435 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: Close
[0m18:24:31.989596 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_weather_temp_max_celsius ............................. [[32mPASS[0m in 0.05s]
[0m18:24:31.990878 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:24:31.991830 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:24:31.992929 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_weather_temp_min_celsius ....................... [RUN]
[0m18:24:31.994200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82, now test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6)
[0m18:24:31.995222 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:24:31.998769 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:24:32.009283 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:24:32.011925 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:24:32.024950 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:24:32.026057 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: BEGIN
[0m18:24:32.027269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:32.034602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:24:32.036065 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:24:32.037634 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select temp_min_celsius
from "analytics"."silver"."stg_weather"
where temp_min_celsius is null



  
  
      
    ) dbt_internal_test
[0m18:24:32.040814 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:32.042825 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: ROLLBACK
[0m18:24:32.044068 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: Close
[0m18:24:32.045430 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_weather_temp_min_celsius ............................. [[32mPASS[0m in 0.05s]
[0m18:24:32.047188 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:24:32.048620 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:24:32.049700 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_weather_weather_surrogate_key ................. [RUN]
[0m18:24:32.051057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6, now test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab)
[0m18:24:32.051958 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:24:32.056642 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:24:32.067060 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:24:32.069749 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:24:32.079881 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:24:32.081127 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: BEGIN
[0m18:24:32.082165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:32.090805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m18:24:32.092074 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:24:32.093189 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select weather_surrogate_key
from "analytics"."silver"."stg_weather"
where weather_surrogate_key is null



  
  
      
    ) dbt_internal_test
[0m18:24:32.096086 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:32.098183 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: ROLLBACK
[0m18:24:32.099666 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: Close
[0m18:24:32.101219 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_weather_weather_surrogate_key ....................... [[32mPASS[0m in 0.05s]
[0m18:24:32.102629 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:24:32.103510 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:24:32.104502 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_weather_weather_surrogate_key ................... [RUN]
[0m18:24:32.105479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab, now test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20)
[0m18:24:32.106302 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:24:32.111892 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:24:32.121846 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:24:32.124702 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:24:32.134419 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:24:32.135624 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: BEGIN
[0m18:24:32.136706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:32.144115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:24:32.145152 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:24:32.145975 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    weather_surrogate_key as unique_field,
    count(*) as n_records

from "analytics"."silver"."stg_weather"
where weather_surrogate_key is not null
group by weather_surrogate_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:24:32.148742 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:32.150816 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: ROLLBACK
[0m18:24:32.152132 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: Close
[0m18:24:32.154900 [info ] [Thread-1 (]: 11 of 11 PASS unique_stg_weather_weather_surrogate_key ......................... [[32mPASS[0m in 0.05s]
[0m18:24:32.157560 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:24:32.159951 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:32.160927 [debug] [MainThread]: On master: BEGIN
[0m18:24:32.161744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:24:32.168714 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:24:32.169918 [debug] [MainThread]: On master: COMMIT
[0m18:24:32.170887 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:32.171855 [debug] [MainThread]: On master: COMMIT
[0m18:24:32.172960 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:24:32.174047 [debug] [MainThread]: On master: Close
[0m18:24:32.175165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:32.176217 [debug] [MainThread]: Connection 'test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20' was properly closed.
[0m18:24:32.177337 [info ] [MainThread]: 
[0m18:24:32.178448 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m18:24:32.180180 [debug] [MainThread]: Command end result
[0m18:24:32.211574 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:24:32.219533 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:24:32.233289 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:24:32.234563 [info ] [MainThread]: 
[0m18:24:32.236347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:32.238031 [info ] [MainThread]: 
[0m18:24:32.239233 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m18:24:32.240924 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5764897, "process_in_blocks": "1224", "process_kernel_time": 0.437475, "process_mem_max_rss": "129252", "process_out_blocks": "0", "process_user_time": 2.074997}
[0m18:24:32.241969 [debug] [MainThread]: Command `dbt test` succeeded at 18:24:32.241883 after 1.58 seconds
[0m18:24:32.243043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b8be17810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b8be17550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b90252fd0>]}
[0m18:24:32.244228 [debug] [MainThread]: Flushing usage events
[0m18:24:33.491781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:24:36.906498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777cb429ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777cb2e01a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777cb42a9690>]}


============================== 18:24:36.911949 | 6c13d1da-61e6-4ba6-a270-a2055d17235a ==============================
[0m18:24:36.911949 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:24:36.913212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:24:37.045388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c13d1da-61e6-4ba6-a270-a2055d17235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777cb1284750>]}
[0m18:24:37.087100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c13d1da-61e6-4ba6-a270-a2055d17235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777cb42c0190>]}
[0m18:24:37.091008 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:24:37.177872 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:24:37.405354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:24:37.406639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:24:37.440103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c13d1da-61e6-4ba6-a270-a2055d17235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777cb0f14710>]}
[0m18:24:37.468444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c13d1da-61e6-4ba6-a270-a2055d17235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777caff6a350>]}
[0m18:24:37.469549 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 435 macros
[0m18:24:37.470580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c13d1da-61e6-4ba6-a270-a2055d17235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777cb0352210>]}
[0m18:24:37.472757 [info ] [MainThread]: 
[0m18:24:37.473789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:37.474901 [info ] [MainThread]: 
[0m18:24:37.475918 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:24:37.481340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_silver'
[0m18:24:37.515764 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:24:37.517058 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:24:37.518489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:37.529217 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:24:37.530595 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:24:37.531297 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:24:37.534794 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:24:37.537524 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:24:37.538759 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:24:37.540049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m18:24:37.542492 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:24:37.543155 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:24:37.544060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:37.551209 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:24:37.552333 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:24:37.553188 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:24:37.556681 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m18:24:37.558659 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:24:37.559738 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:24:37.563895 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:37.564800 [debug] [MainThread]: On master: BEGIN
[0m18:24:37.565531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:37.572517 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:24:37.573740 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:37.574610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:24:37.579074 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m18:24:37.580897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c13d1da-61e6-4ba6-a270-a2055d17235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777cb0b42a50>]}
[0m18:24:37.581781 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:37.582833 [debug] [MainThread]: On master: Close
[0m18:24:37.586441 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m18:24:37.588051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now model.weather_dbt.stg_weather)
[0m18:24:37.589845 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m18:24:37.597110 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m18:24:37.604665 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m18:24:37.606105 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m18:24:37.608127 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m18:24:37.609204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m18:24:37.609993 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m18:24:37.612637 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m18:24:37.620232 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m18:24:37.621454 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m18:24:37.622232 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m18:24:37.624185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m18:24:37.625338 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m18:24:37.628449 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m18:24:37.635815 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m18:24:37.637497 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m18:24:37.638528 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m18:24:37.639719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m18:24:37.641746 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m18:24:37.705330 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m18:24:37.717555 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m18:24:37.719233 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m18:24:37.720266 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:24:37.721262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.fct_weather_daily, now test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816)
[0m18:24:37.722161 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:24:37.731053 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:24:37.742870 [debug] [Thread-1 (]: Began executing node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:24:37.744557 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:24:37.745619 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:24:37.747049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816, now test.weather_dbt.not_null_stg_weather_city_name.d57308e884)
[0m18:24:37.747976 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:24:37.754113 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:24:37.764617 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:24:37.766293 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:24:37.768046 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:24:37.770091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_city_name.d57308e884, now test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516)
[0m18:24:37.772646 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:24:37.776069 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:24:37.785981 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:24:37.787820 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:24:37.788915 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:24:37.789778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516, now test.weather_dbt.not_null_stg_weather_latitude.35769df29a)
[0m18:24:37.790689 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:24:37.793909 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:24:37.804392 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:24:37.805934 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:24:37.807213 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:24:37.808255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_latitude.35769df29a, now test.weather_dbt.not_null_stg_weather_longitude.04815d6a63)
[0m18:24:37.809292 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:24:37.813701 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:24:37.824414 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:24:37.825892 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:24:37.827184 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:24:37.828287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_longitude.04815d6a63, now test.weather_dbt.not_null_stg_weather_observation_date.9a16015555)
[0m18:24:37.829215 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:24:37.832803 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:24:37.845648 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:24:37.847456 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:24:37.848471 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:24:37.849465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_observation_date.9a16015555, now test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4)
[0m18:24:37.850575 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:24:37.854236 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:24:37.865111 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:24:37.866520 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:24:37.867867 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:24:37.868857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4, now test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82)
[0m18:24:37.869727 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:24:37.873744 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:24:37.882419 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:24:37.883762 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:24:37.884617 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:24:37.885400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82, now test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6)
[0m18:24:37.886049 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:24:37.892728 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:24:37.901716 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:24:37.902860 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:24:37.903694 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:24:37.904482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6, now test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab)
[0m18:24:37.905371 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:24:37.911551 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:24:37.921222 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:24:37.922332 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:24:37.923150 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:24:37.924044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab, now test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20)
[0m18:24:37.924793 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:24:37.929179 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:24:37.938292 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:24:37.939695 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:24:37.941722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:37.942622 [debug] [MainThread]: Connection 'test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20' was properly closed.
[0m18:24:37.944530 [debug] [MainThread]: Command end result
[0m18:24:38.016444 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:24:38.025574 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:24:38.037502 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:24:38.063825 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:24:38.064816 [info ] [MainThread]: Building catalog
[0m18:24:38.072239 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m18:24:38.079173 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m18:24:38.080240 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m18:24:38.081204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:38.089812 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:24:38.092420 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m18:24:38.093409 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('dim_location')) or (upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('weather_raw')) or (upper(sch.nspname) = upper('silver') and
           upper(tbl.relname) = upper('stg_weather')) or (upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('fct_weather_daily')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:24:38.102088 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.008 seconds
[0m18:24:38.105505 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m18:24:38.106960 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m18:24:38.119799 [debug] [MainThread]: Wrote artifact CatalogArtifact to /opt/airflow/dbt/weather_dbt/target/catalog.json
[0m18:24:38.155962 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:24:38.164927 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:24:38.166185 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/weather_dbt/target/catalog.json
[0m18:24:38.168562 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.3204037, "process_in_blocks": "3408", "process_kernel_time": 0.46827, "process_mem_max_rss": "127208", "process_out_blocks": "0", "process_user_time": 2.026482}
[0m18:24:38.169878 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:24:38.169756 after 1.32 seconds
[0m18:24:38.171013 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:24:38.171855 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m18:24:38.173001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777cb1963fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777cb1962c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777cb5eb2f10>]}
[0m18:24:38.174228 [debug] [MainThread]: Flushing usage events
[0m18:24:39.496894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:06.566177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f41e1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f5709650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f42c2fd0>]}


============================== 18:35:06.574278 | c882b32f-54a9-4687-b35e-8d6cb35121c8 ==============================
[0m18:35:06.574278 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:35:06.575469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:35:06.852919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c882b32f-54a9-4687-b35e-8d6cb35121c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f35b2a10>]}
[0m18:35:06.894783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c882b32f-54a9-4687-b35e-8d6cb35121c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f6ba3d50>]}
[0m18:35:06.898238 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:35:06.997706 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:35:07.270950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:07.272234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:07.302653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c882b32f-54a9-4687-b35e-8d6cb35121c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f298a650>]}
[0m18:35:07.375123 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:35:07.382211 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:35:07.418408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c882b32f-54a9-4687-b35e-8d6cb35121c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f2144490>]}
[0m18:35:07.419433 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 435 macros
[0m18:35:07.420181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c882b32f-54a9-4687-b35e-8d6cb35121c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f25a4410>]}
[0m18:35:07.423379 [info ] [MainThread]: 
[0m18:35:07.424445 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:07.425153 [info ] [MainThread]: 
[0m18:35:07.426226 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:35:07.430838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m18:35:07.533953 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:35:07.535081 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:35:07.536030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:07.545001 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m18:35:07.547163 [debug] [ThreadPool]: On list_analytics: Close
[0m18:35:07.551527 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:35:07.552647 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:35:07.553440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:07.561446 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m18:35:07.563390 [debug] [ThreadPool]: On list_analytics: Close
[0m18:35:07.565376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_silver)
[0m18:35:07.569724 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:35:07.570611 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:35:07.572217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:07.579459 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:35:07.580669 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:35:07.581881 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:35:07.585371 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:35:07.587076 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:35:07.588233 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:35:07.589684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m18:35:07.592153 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:35:07.593264 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:35:07.594185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:07.600526 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:35:07.601825 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:35:07.602758 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:35:07.606890 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m18:35:07.608623 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:35:07.609480 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:35:07.614430 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:07.615422 [debug] [MainThread]: On master: BEGIN
[0m18:35:07.616205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:07.623072 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:35:07.624367 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:07.625299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:07.631090 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m18:35:07.632883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c882b32f-54a9-4687-b35e-8d6cb35121c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f137d750>]}
[0m18:35:07.633840 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:07.635482 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:07.636274 [debug] [MainThread]: On master: BEGIN
[0m18:35:07.637676 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:35:07.638692 [debug] [MainThread]: On master: COMMIT
[0m18:35:07.639590 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:07.640395 [debug] [MainThread]: On master: COMMIT
[0m18:35:07.641707 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:35:07.642544 [debug] [MainThread]: On master: Close
[0m18:35:07.647756 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m18:35:07.648728 [info ] [Thread-1 (]: 1 of 4 START sql view model silver.stg_weather ................................. [RUN]
[0m18:35:07.649802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now model.weather_dbt.stg_weather)
[0m18:35:07.650830 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m18:35:07.657859 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m18:35:07.665997 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m18:35:07.689037 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.stg_weather"
[0m18:35:07.697913 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:35:07.698811 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: BEGIN
[0m18:35:07.699616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:07.706474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:35:07.707577 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:35:07.708255 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */

  create view "analytics"."silver"."stg_weather__dbt_tmp"
    
    
  as (
    

WITH ranked_weather AS (
    SELECT
        *,  -- Keep raw types, cast later
        ROW_NUMBER() OVER(
            PARTITION BY city_name, day 
            ORDER BY ingested_at DESC
        ) AS rn
    FROM "analytics"."bronze"."weather_raw"
),  -- ✅ Fixed: Added comma

deduped_weather AS (
    SELECT
        MD5(city_name || '|' || day::TEXT) AS weather_surrogate_key,  -- ✅ PostgreSQL fix
        
        CAST(day AS DATE) AS observation_date,
        CAST(city_name AS VARCHAR(50)) AS city_name,
        CAST(latitude AS DECIMAL(9,6)) AS latitude,
        CAST(longitude AS DECIMAL(9,6)) AS longitude,
        CAST(temp_max AS DECIMAL(5,2)) AS temp_max_celsius,
        CAST(temp_min AS DECIMAL(5,2)) AS temp_min_celsius,
        CAST(precipitation_sum AS DECIMAL(6,2)) AS precipitation_mm,
        CAST(ingested_at AS TIMESTAMP) AS ingested_at
    FROM ranked_weather
    WHERE rn = 1
        AND city_name IS NOT NULL 
        AND latitude IS NOT NULL 
        AND longitude IS NOT NULL
        AND day IS NOT NULL
        AND temp_max IS NOT NULL 
        AND temp_min IS NOT NULL
)

SELECT * FROM deduped_weather
  );
[0m18:35:07.713575 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:35:07.718107 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:35:07.719017 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather" rename to "stg_weather__dbt_backup"
[0m18:35:07.720366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:35:07.723259 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:35:07.724678 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
alter table "analytics"."silver"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m18:35:07.726298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:35:07.736117 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:35:07.737144 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:35:07.737878 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: COMMIT
[0m18:35:07.740668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:35:07.746454 [debug] [Thread-1 (]: Applying DROP to: "analytics"."silver"."stg_weather__dbt_backup"
[0m18:35:07.752124 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.stg_weather"
[0m18:35:07.753261 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.stg_weather"} */
drop view if exists "analytics"."silver"."stg_weather__dbt_backup" cascade
[0m18:35:07.757363 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:35:07.760670 [debug] [Thread-1 (]: On model.weather_dbt.stg_weather: Close
[0m18:35:07.763631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c882b32f-54a9-4687-b35e-8d6cb35121c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f1399010>]}
[0m18:35:07.764931 [info ] [Thread-1 (]: 1 of 4 OK created sql view model silver.stg_weather ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m18:35:07.766113 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m18:35:07.767680 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m18:35:07.768405 [info ] [Thread-1 (]: 2 of 4 START sql table model gold.dim_date ..................................... [RUN]
[0m18:35:07.769163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m18:35:07.769839 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m18:35:07.773466 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m18:35:07.783268 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m18:35:07.797531 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_date"
[0m18:35:07.806058 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:35:07.807152 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: BEGIN
[0m18:35:07.807924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:07.814222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:35:07.815581 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:35:07.816372 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */

  
    

  create  table "analytics"."gold"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    SELECT
        min(observation_date) as min_day,
        max(observation_date) as max_day
    FROM "analytics"."silver"."stg_weather"    
),
dates as (
    select generate_series(min_day, max_day, interval '1 day')::date as date_day
    from bounds
)
SELECT
    date_day,
    extract(year from date_day)::int as year,
    extract(month from date_day)::int as month,
    to_char(date_day, 'Mon')  as month_name,
    extract(day from date_day) as day_of_month,
    extract(dow from date_day)::int as day_of_week,
    to_char(date_day, 'Dy') as day_name,
    case when extract(dow from date_day) in (0,6) then true else false end as is_weekend
FROM dates
  );
  
[0m18:35:07.824332 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.007 seconds
[0m18:35:07.830524 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:35:07.832089 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
alter table "analytics"."gold"."dim_date" rename to "dim_date__dbt_backup"
[0m18:35:07.835387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:35:07.839571 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:35:07.840605 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
alter table "analytics"."gold"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:35:07.842234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:35:07.843976 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m18:35:07.844857 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:35:07.845819 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: COMMIT
[0m18:35:07.848286 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:35:07.850854 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_date__dbt_backup"
[0m18:35:07.854389 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_date"
[0m18:35:07.855508 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_date"} */
drop table if exists "analytics"."gold"."dim_date__dbt_backup" cascade
[0m18:35:07.859147 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:35:07.860620 [debug] [Thread-1 (]: On model.weather_dbt.dim_date: Close
[0m18:35:07.862471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c882b32f-54a9-4687-b35e-8d6cb35121c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f126fad0>]}
[0m18:35:07.863935 [info ] [Thread-1 (]: 2 of 4 OK created sql table model gold.dim_date ................................ [[32mSELECT 14[0m in 0.09s]
[0m18:35:07.864905 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m18:35:07.865750 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m18:35:07.866835 [info ] [Thread-1 (]: 3 of 4 START sql table model gold.dim_location ................................. [RUN]
[0m18:35:07.868125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m18:35:07.869101 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m18:35:07.872233 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m18:35:07.879659 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m18:35:07.883156 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.dim_location"
[0m18:35:07.892834 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:35:07.893653 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: BEGIN
[0m18:35:07.894535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:07.900990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:35:07.902226 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:35:07.903294 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */

  
    

  create  table "analytics"."gold"."dim_location__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    latitude,
    longitude
FROM "analytics"."silver"."stg_weather"
  );
  
[0m18:35:07.907493 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m18:35:07.910930 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:35:07.912302 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location" rename to "dim_location__dbt_backup"
[0m18:35:07.913476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:35:07.915862 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:35:07.916774 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
alter table "analytics"."gold"."dim_location__dbt_tmp" rename to "dim_location"
[0m18:35:07.918051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:35:07.919430 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:35:07.920042 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:35:07.920816 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: COMMIT
[0m18:35:07.923588 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:35:07.925704 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."dim_location__dbt_backup"
[0m18:35:07.926752 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.dim_location"
[0m18:35:07.927665 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.dim_location"} */
drop table if exists "analytics"."gold"."dim_location__dbt_backup" cascade
[0m18:35:07.930130 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:35:07.932850 [debug] [Thread-1 (]: On model.weather_dbt.dim_location: Close
[0m18:35:07.934001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c882b32f-54a9-4687-b35e-8d6cb35121c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f12703d0>]}
[0m18:35:07.935370 [info ] [Thread-1 (]: 3 of 4 OK created sql table model gold.dim_location ............................ [[32mSELECT 4[0m in 0.07s]
[0m18:35:07.936902 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m18:35:07.937851 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m18:35:07.938734 [info ] [Thread-1 (]: 4 of 4 START sql table model gold.fct_weather_daily ............................ [RUN]
[0m18:35:07.939532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m18:35:07.940493 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m18:35:07.944101 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m18:35:07.953421 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m18:35:07.956660 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.fct_weather_daily"
[0m18:35:07.965494 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:35:07.966724 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: BEGIN
[0m18:35:07.967509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:07.974188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:35:07.975280 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:35:07.976251 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */

  
    

  create  table "analytics"."gold"."fct_weather_daily__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_metrics AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        
        -- Basic metrics
        (temp_max_celsius + temp_min_celsius) / 2 AS avg_temp,
        temp_max_celsius AS max_temp,
        temp_min_celsius AS min_temp,
        precipitation_mm AS total_precipitation,
        
        -- 7-day moving average temperature
        AVG((temp_max_celsius + temp_min_celsius) / 2) 
            OVER (
                PARTITION BY city_name 
                ORDER BY observation_date 
                ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ) AS moving_avg_7d_temp

    FROM "analytics"."silver"."stg_weather"
),

final_summary AS (
    SELECT 
        weather_surrogate_key,
        city_name,
        observation_date,
        latitude,
        longitude,
        ROUND(avg_temp, 2) AS avg_temp,
        ROUND(max_temp, 2) AS max_temp,
        ROUND(min_temp, 2) AS min_temp,
        ROUND(total_precipitation, 2) AS total_precipitation,
        ROUND(moving_avg_7d_temp, 2) AS moving_avg_7d_temp

    FROM daily_metrics
)

SELECT * FROM final_summary
  );
  
[0m18:35:07.983412 [debug] [Thread-1 (]: SQL status: SELECT 56 in 0.006 seconds
[0m18:35:07.986953 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:35:07.987622 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily" rename to "fct_weather_daily__dbt_backup"
[0m18:35:07.988563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:35:07.991876 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:35:07.992854 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
alter table "analytics"."gold"."fct_weather_daily__dbt_tmp" rename to "fct_weather_daily"
[0m18:35:07.993972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:35:07.995435 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:35:07.996276 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:35:07.999349 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: COMMIT
[0m18:35:08.001729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:35:08.003980 [debug] [Thread-1 (]: Applying DROP to: "analytics"."gold"."fct_weather_daily__dbt_backup"
[0m18:35:08.004960 [debug] [Thread-1 (]: Using postgres connection "model.weather_dbt.fct_weather_daily"
[0m18:35:08.005962 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.fct_weather_daily"} */
drop table if exists "analytics"."gold"."fct_weather_daily__dbt_backup" cascade
[0m18:35:08.008157 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:35:08.010132 [debug] [Thread-1 (]: On model.weather_dbt.fct_weather_daily: Close
[0m18:35:08.011081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c882b32f-54a9-4687-b35e-8d6cb35121c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f12dab50>]}
[0m18:35:08.012096 [info ] [Thread-1 (]: 4 of 4 OK created sql table model gold.fct_weather_daily ....................... [[32mSELECT 56[0m in 0.07s]
[0m18:35:08.013518 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m18:35:08.015281 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:08.016015 [debug] [MainThread]: On master: BEGIN
[0m18:35:08.016733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:08.022417 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:35:08.024442 [debug] [MainThread]: On master: COMMIT
[0m18:35:08.025102 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:08.025652 [debug] [MainThread]: On master: COMMIT
[0m18:35:08.027510 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:35:08.028949 [debug] [MainThread]: On master: Close
[0m18:35:08.031249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:08.032066 [debug] [MainThread]: Connection 'model.weather_dbt.fct_weather_daily' was properly closed.
[0m18:35:08.032832 [info ] [MainThread]: 
[0m18:35:08.033592 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m18:35:08.035194 [debug] [MainThread]: Command end result
[0m18:35:08.061858 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:35:08.067364 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:35:08.075621 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:35:08.076636 [info ] [MainThread]: 
[0m18:35:08.077727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:08.079597 [info ] [MainThread]: 
[0m18:35:08.080847 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:35:08.082871 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5780506, "process_in_blocks": "69592", "process_kernel_time": 0.707799, "process_mem_max_rss": "127556", "process_out_blocks": "0", "process_user_time": 2.256111}
[0m18:35:08.083821 [debug] [MainThread]: Command `dbt run` succeeded at 18:35:08.083744 after 1.58 seconds
[0m18:35:08.084633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f8822990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f86e7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b52f879c7d0>]}
[0m18:35:08.085503 [debug] [MainThread]: Flushing usage events
[0m18:35:09.387197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:11.680579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd765fcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd7662ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd766d6cd0>]}


============================== 18:35:11.685985 | 2eb74dc8-d313-40ae-b5f6-336edf39e7f8 ==============================
[0m18:35:11.685985 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:35:11.687464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:35:11.817385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eb74dc8-d313-40ae-b5f6-336edf39e7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd75d101d0>]}
[0m18:35:11.859938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eb74dc8-d313-40ae-b5f6-336edf39e7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd78f1fc10>]}
[0m18:35:11.862028 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:35:11.937939 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:35:12.145210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:12.150460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:12.179007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eb74dc8-d313-40ae-b5f6-336edf39e7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd75197450>]}
[0m18:35:12.249670 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:35:12.255666 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:35:12.291519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eb74dc8-d313-40ae-b5f6-336edf39e7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd74577f50>]}
[0m18:35:12.292720 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 435 macros
[0m18:35:12.293480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb74dc8-d313-40ae-b5f6-336edf39e7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd74d53f50>]}
[0m18:35:12.295636 [info ] [MainThread]: 
[0m18:35:12.296638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:12.297313 [info ] [MainThread]: 
[0m18:35:12.298740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:35:12.303279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_gold'
[0m18:35:12.393916 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:35:12.394929 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:35:12.395614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:12.402882 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:35:12.403877 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:35:12.404438 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:35:12.408993 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m18:35:12.410740 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:35:12.411686 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:35:12.412664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_gold, now list_analytics_silver)
[0m18:35:12.415133 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:35:12.416074 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:35:12.417025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:12.423084 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:35:12.423906 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:35:12.424484 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:35:12.428210 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:35:12.430250 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:35:12.431854 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:35:12.436235 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:12.437333 [debug] [MainThread]: On master: BEGIN
[0m18:35:12.437928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:12.444491 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:35:12.445854 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:12.447017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:12.451647 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m18:35:12.453414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb74dc8-d313-40ae-b5f6-336edf39e7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd7664ec90>]}
[0m18:35:12.454476 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:12.455954 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:12.456818 [debug] [MainThread]: On master: BEGIN
[0m18:35:12.458201 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:35:12.459526 [debug] [MainThread]: On master: COMMIT
[0m18:35:12.460371 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:12.461017 [debug] [MainThread]: On master: COMMIT
[0m18:35:12.462031 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:35:12.462923 [debug] [MainThread]: On master: Close
[0m18:35:12.467738 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:35:12.468856 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj  [RUN]
[0m18:35:12.471377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_silver, now test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816)
[0m18:35:12.472535 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:35:12.483687 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:35:12.492272 [debug] [Thread-1 (]: Began executing node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:35:12.505260 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:35:12.514340 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:35:12.515193 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: BEGIN
[0m18:35:12.515804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:12.523487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:35:12.524533 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:35:12.525280 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        city_name as value_field,
        count(*) as n_records

    from "analytics"."silver"."stg_weather"
    group by city_name

)

select *
from all_values
where value_field not in (
    'Kathmandu','Pokhara','Biratnagar','Birgunj'
)



  
  
      
    ) dbt_internal_test
[0m18:35:12.528516 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:35:12.532157 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: ROLLBACK
[0m18:35:12.533898 [debug] [Thread-1 (]: On test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816: Close
[0m18:35:12.535958 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj  [[32mPASS[0m in 0.06s]
[0m18:35:12.537493 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:35:12.538785 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:35:12.539724 [info ] [Thread-1 (]: 2 of 11 START test not_null_stg_weather_city_name .............................. [RUN]
[0m18:35:12.541081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816, now test.weather_dbt.not_null_stg_weather_city_name.d57308e884)
[0m18:35:12.543706 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:35:12.549066 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:35:12.557336 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:35:12.559914 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:35:12.568855 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:35:12.570816 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: BEGIN
[0m18:35:12.571755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:12.578596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:35:12.579672 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:35:12.580607 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_name
from "analytics"."silver"."stg_weather"
where city_name is null



  
  
      
    ) dbt_internal_test
[0m18:35:12.583918 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:35:12.585793 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: ROLLBACK
[0m18:35:12.586886 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_city_name.d57308e884: Close
[0m18:35:12.588228 [info ] [Thread-1 (]: 2 of 11 PASS not_null_stg_weather_city_name .................................... [[32mPASS[0m in 0.05s]
[0m18:35:12.589593 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:35:12.591927 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:35:12.593559 [info ] [Thread-1 (]: 3 of 11 START test not_null_stg_weather_ingested_at ............................ [RUN]
[0m18:35:12.594913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_city_name.d57308e884, now test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516)
[0m18:35:12.595827 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:35:12.599585 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:35:12.609561 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:35:12.612922 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:35:12.622803 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:35:12.623608 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: BEGIN
[0m18:35:12.624333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:12.630694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:35:12.632015 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:35:12.632903 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ingested_at
from "analytics"."silver"."stg_weather"
where ingested_at is null



  
  
      
    ) dbt_internal_test
[0m18:35:12.635333 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:35:12.637195 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: ROLLBACK
[0m18:35:12.638889 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516: Close
[0m18:35:12.640442 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stg_weather_ingested_at .................................. [[32mPASS[0m in 0.05s]
[0m18:35:12.641784 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:35:12.642904 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:35:12.644262 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_weather_latitude ............................... [RUN]
[0m18:35:12.645425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516, now test.weather_dbt.not_null_stg_weather_latitude.35769df29a)
[0m18:35:12.646445 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:35:12.649875 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:35:12.663672 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:35:12.667741 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:35:12.677170 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:35:12.678229 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: BEGIN
[0m18:35:12.679754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:12.686745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:35:12.687733 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:35:12.688583 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from "analytics"."silver"."stg_weather"
where latitude is null



  
  
      
    ) dbt_internal_test
[0m18:35:12.691498 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:35:12.694086 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: ROLLBACK
[0m18:35:12.695588 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_latitude.35769df29a: Close
[0m18:35:12.696855 [info ] [Thread-1 (]: 4 of 11 PASS not_null_stg_weather_latitude ..................................... [[32mPASS[0m in 0.05s]
[0m18:35:12.698130 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:35:12.699242 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:35:12.700176 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_weather_longitude .............................. [RUN]
[0m18:35:12.701235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_latitude.35769df29a, now test.weather_dbt.not_null_stg_weather_longitude.04815d6a63)
[0m18:35:12.702744 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:35:12.706696 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:35:12.716599 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:35:12.719319 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:35:12.729471 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:35:12.730810 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: BEGIN
[0m18:35:12.731724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:12.737420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:35:12.738773 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:35:12.739896 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from "analytics"."silver"."stg_weather"
where longitude is null



  
  
      
    ) dbt_internal_test
[0m18:35:12.742478 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:35:12.744604 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: ROLLBACK
[0m18:35:12.746028 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_longitude.04815d6a63: Close
[0m18:35:12.747207 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_weather_longitude .................................... [[32mPASS[0m in 0.05s]
[0m18:35:12.749082 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:35:12.750285 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:35:12.751372 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_weather_observation_date ....................... [RUN]
[0m18:35:12.752338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_longitude.04815d6a63, now test.weather_dbt.not_null_stg_weather_observation_date.9a16015555)
[0m18:35:12.753251 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:35:12.756380 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:35:12.768253 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:35:12.770782 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:35:12.779927 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:35:12.780712 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: BEGIN
[0m18:35:12.781357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:12.787422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:35:12.788626 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:35:12.789535 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select observation_date
from "analytics"."silver"."stg_weather"
where observation_date is null



  
  
      
    ) dbt_internal_test
[0m18:35:12.793909 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:35:12.795774 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: ROLLBACK
[0m18:35:12.796930 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_observation_date.9a16015555: Close
[0m18:35:12.798128 [info ] [Thread-1 (]: 6 of 11 PASS not_null_stg_weather_observation_date ............................. [[32mPASS[0m in 0.05s]
[0m18:35:12.799436 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:35:12.800539 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:35:12.801379 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_weather_precipitation_mm ....................... [RUN]
[0m18:35:12.802255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_observation_date.9a16015555, now test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4)
[0m18:35:12.803746 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:35:12.807220 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:35:12.816972 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:35:12.820174 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:35:12.828967 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:35:12.829751 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: BEGIN
[0m18:35:12.830887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:12.838651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:35:12.840326 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:35:12.842275 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select precipitation_mm
from "analytics"."silver"."stg_weather"
where precipitation_mm is null



  
  
      
    ) dbt_internal_test
[0m18:35:12.845189 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:35:12.847267 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: ROLLBACK
[0m18:35:12.848467 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4: Close
[0m18:35:12.850249 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_weather_precipitation_mm ............................. [[32mPASS[0m in 0.05s]
[0m18:35:12.851371 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:35:12.852310 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:35:12.853283 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_weather_temp_max_celsius ....................... [RUN]
[0m18:35:12.854260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4, now test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82)
[0m18:35:12.855027 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:35:12.858732 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:35:12.867749 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:35:12.870477 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:35:12.882827 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:35:12.884093 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: BEGIN
[0m18:35:12.885092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:12.891843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:35:12.892957 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:35:12.894098 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select temp_max_celsius
from "analytics"."silver"."stg_weather"
where temp_max_celsius is null



  
  
      
    ) dbt_internal_test
[0m18:35:12.897197 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:35:12.899239 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: ROLLBACK
[0m18:35:12.900250 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82: Close
[0m18:35:12.901257 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_weather_temp_max_celsius ............................. [[32mPASS[0m in 0.05s]
[0m18:35:12.902440 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:35:12.903427 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:35:12.904699 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_weather_temp_min_celsius ....................... [RUN]
[0m18:35:12.905781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82, now test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6)
[0m18:35:12.906718 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:35:12.909895 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:35:12.920863 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:35:12.923770 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:35:12.932828 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:35:12.933651 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: BEGIN
[0m18:35:12.934549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:12.940413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:35:12.941650 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:35:12.942519 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select temp_min_celsius
from "analytics"."silver"."stg_weather"
where temp_min_celsius is null



  
  
      
    ) dbt_internal_test
[0m18:35:12.945079 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:35:12.947300 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: ROLLBACK
[0m18:35:12.948222 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6: Close
[0m18:35:12.949463 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_weather_temp_min_celsius ............................. [[32mPASS[0m in 0.04s]
[0m18:35:12.951204 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:35:12.952307 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:35:12.953239 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_weather_weather_surrogate_key ................. [RUN]
[0m18:35:12.954535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6, now test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab)
[0m18:35:12.955454 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:35:12.964044 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:35:12.973138 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:35:12.976142 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:35:12.986655 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:35:12.987818 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: BEGIN
[0m18:35:12.988847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:12.996181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:35:12.997462 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:35:12.998482 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select weather_surrogate_key
from "analytics"."silver"."stg_weather"
where weather_surrogate_key is null



  
  
      
    ) dbt_internal_test
[0m18:35:13.000804 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:35:13.002542 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: ROLLBACK
[0m18:35:13.003938 [debug] [Thread-1 (]: On test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab: Close
[0m18:35:13.005873 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_weather_weather_surrogate_key ....................... [[32mPASS[0m in 0.05s]
[0m18:35:13.007630 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:35:13.008541 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:35:13.009560 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_weather_weather_surrogate_key ................... [RUN]
[0m18:35:13.010704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab, now test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20)
[0m18:35:13.011666 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:35:13.016904 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:35:13.027526 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:35:13.030725 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:35:13.039861 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:35:13.041064 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: BEGIN
[0m18:35:13.042633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:13.050742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:35:13.052137 [debug] [Thread-1 (]: Using postgres connection "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:35:13.053187 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    weather_surrogate_key as unique_field,
    count(*) as n_records

from "analytics"."silver"."stg_weather"
where weather_surrogate_key is not null
group by weather_surrogate_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:35:13.056006 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:35:13.057864 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: ROLLBACK
[0m18:35:13.059145 [debug] [Thread-1 (]: On test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20: Close
[0m18:35:13.060947 [info ] [Thread-1 (]: 11 of 11 PASS unique_stg_weather_weather_surrogate_key ......................... [[32mPASS[0m in 0.05s]
[0m18:35:13.062265 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:35:13.065577 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:13.066485 [debug] [MainThread]: On master: BEGIN
[0m18:35:13.067116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:13.073380 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:35:13.075212 [debug] [MainThread]: On master: COMMIT
[0m18:35:13.076708 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:13.077727 [debug] [MainThread]: On master: COMMIT
[0m18:35:13.079431 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:35:13.080282 [debug] [MainThread]: On master: Close
[0m18:35:13.081480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:13.082596 [debug] [MainThread]: Connection 'test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20' was properly closed.
[0m18:35:13.083486 [info ] [MainThread]: 
[0m18:35:13.084252 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m18:35:13.085823 [debug] [MainThread]: Command end result
[0m18:35:13.117137 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:35:13.122758 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:35:13.133892 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:35:13.135115 [info ] [MainThread]: 
[0m18:35:13.136496 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:13.137721 [info ] [MainThread]: 
[0m18:35:13.138813 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m18:35:13.141870 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5141147, "process_in_blocks": "1224", "process_kernel_time": 0.439222, "process_mem_max_rss": "129124", "process_out_blocks": "0", "process_user_time": 2.121444}
[0m18:35:13.143461 [debug] [MainThread]: Command `dbt test` succeeded at 18:35:13.143300 after 1.52 seconds
[0m18:35:13.144884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd7aa6b5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd7ab207d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd768aa410>]}
[0m18:35:13.147093 [debug] [MainThread]: Flushing usage events
[0m18:35:14.898812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:17.496135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263de2353d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263de235850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263de236050>]}


============================== 18:35:17.502437 | 408950e1-27a6-43d3-a41a-18e2c27f74bf ==============================
[0m18:35:17.502437 [info ] [MainThread]: Running with dbt=1.10.7
[0m18:35:17.503710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:35:17.662568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '408950e1-27a6-43d3-a41a-18e2c27f74bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263dd9a82d0>]}
[0m18:35:17.718854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '408950e1-27a6-43d3-a41a-18e2c27f74bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e0b70590>]}
[0m18:35:17.720906 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:35:17.811204 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m18:35:18.088729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:18.090032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:18.119769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '408950e1-27a6-43d3-a41a-18e2c27f74bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263dd5fae90>]}
[0m18:35:18.145000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '408950e1-27a6-43d3-a41a-18e2c27f74bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263dc513ed0>]}
[0m18:35:18.146137 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 435 macros
[0m18:35:18.147115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408950e1-27a6-43d3-a41a-18e2c27f74bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263dc9a5d10>]}
[0m18:35:18.149126 [info ] [MainThread]: 
[0m18:35:18.150731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:18.151974 [info ] [MainThread]: 
[0m18:35:18.153628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:35:18.158104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_silver'
[0m18:35:18.193248 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:35:18.194379 [debug] [ThreadPool]: On list_analytics_silver: BEGIN
[0m18:35:18.195337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:18.202935 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:35:18.204048 [debug] [ThreadPool]: Using postgres connection "list_analytics_silver"
[0m18:35:18.205011 [debug] [ThreadPool]: On list_analytics_silver: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_silver"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:35:18.209191 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:35:18.211465 [debug] [ThreadPool]: On list_analytics_silver: ROLLBACK
[0m18:35:18.212562 [debug] [ThreadPool]: On list_analytics_silver: Close
[0m18:35:18.214139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_silver, now list_analytics_gold)
[0m18:35:18.216479 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:35:18.217248 [debug] [ThreadPool]: On list_analytics_gold: BEGIN
[0m18:35:18.217812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:18.224499 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:35:18.225545 [debug] [ThreadPool]: Using postgres connection "list_analytics_gold"
[0m18:35:18.226350 [debug] [ThreadPool]: On list_analytics_gold: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_analytics_gold"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m18:35:18.229943 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m18:35:18.231987 [debug] [ThreadPool]: On list_analytics_gold: ROLLBACK
[0m18:35:18.233126 [debug] [ThreadPool]: On list_analytics_gold: Close
[0m18:35:18.237884 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:18.238669 [debug] [MainThread]: On master: BEGIN
[0m18:35:18.239660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:18.246510 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:35:18.247462 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:18.248434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:18.252829 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m18:35:18.254535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408950e1-27a6-43d3-a41a-18e2c27f74bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263dd5fa890>]}
[0m18:35:18.255884 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:18.258004 [debug] [MainThread]: On master: Close
[0m18:35:18.262673 [debug] [Thread-1 (]: Began running node model.weather_dbt.stg_weather
[0m18:35:18.263700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_gold, now model.weather_dbt.stg_weather)
[0m18:35:18.264410 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.stg_weather
[0m18:35:18.270283 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.stg_weather"
[0m18:35:18.278350 [debug] [Thread-1 (]: Began executing node model.weather_dbt.stg_weather
[0m18:35:18.279841 [debug] [Thread-1 (]: Finished running node model.weather_dbt.stg_weather
[0m18:35:18.281532 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_date
[0m18:35:18.282559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.stg_weather, now model.weather_dbt.dim_date)
[0m18:35:18.283324 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_date
[0m18:35:18.285825 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_date"
[0m18:35:18.293911 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_date
[0m18:35:18.295066 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_date
[0m18:35:18.295832 [debug] [Thread-1 (]: Began running node model.weather_dbt.dim_location
[0m18:35:18.297381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_date, now model.weather_dbt.dim_location)
[0m18:35:18.298115 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.dim_location
[0m18:35:18.300636 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.dim_location"
[0m18:35:18.309074 [debug] [Thread-1 (]: Began executing node model.weather_dbt.dim_location
[0m18:35:18.310903 [debug] [Thread-1 (]: Finished running node model.weather_dbt.dim_location
[0m18:35:18.311725 [debug] [Thread-1 (]: Began running node model.weather_dbt.fct_weather_daily
[0m18:35:18.312540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.dim_location, now model.weather_dbt.fct_weather_daily)
[0m18:35:18.313356 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.fct_weather_daily
[0m18:35:18.379744 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.fct_weather_daily"
[0m18:35:18.389138 [debug] [Thread-1 (]: Began executing node model.weather_dbt.fct_weather_daily
[0m18:35:18.391168 [debug] [Thread-1 (]: Finished running node model.weather_dbt.fct_weather_daily
[0m18:35:18.392153 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:35:18.393164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.fct_weather_daily, now test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816)
[0m18:35:18.393848 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:35:18.402120 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816"
[0m18:35:18.411643 [debug] [Thread-1 (]: Began executing node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:35:18.412778 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816
[0m18:35:18.413916 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:35:18.414936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_values_stg_weather_city_name__Kathmandu__Pokhara__Biratnagar__Birgunj.37320cc816, now test.weather_dbt.not_null_stg_weather_city_name.d57308e884)
[0m18:35:18.415929 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:35:18.422056 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_city_name.d57308e884"
[0m18:35:18.430821 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:35:18.432077 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_city_name.d57308e884
[0m18:35:18.433087 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:35:18.433982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_city_name.d57308e884, now test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516)
[0m18:35:18.435089 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:35:18.438388 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516"
[0m18:35:18.447090 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:35:18.448534 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516
[0m18:35:18.449639 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:35:18.450774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_ingested_at.6792be3516, now test.weather_dbt.not_null_stg_weather_latitude.35769df29a)
[0m18:35:18.451481 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:35:18.455156 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_latitude.35769df29a"
[0m18:35:18.465340 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:35:18.466319 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_latitude.35769df29a
[0m18:35:18.467030 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:35:18.467704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_latitude.35769df29a, now test.weather_dbt.not_null_stg_weather_longitude.04815d6a63)
[0m18:35:18.468330 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:35:18.471969 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_longitude.04815d6a63"
[0m18:35:18.480905 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:35:18.482207 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_longitude.04815d6a63
[0m18:35:18.483237 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:35:18.484273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_longitude.04815d6a63, now test.weather_dbt.not_null_stg_weather_observation_date.9a16015555)
[0m18:35:18.485093 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:35:18.488395 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_observation_date.9a16015555"
[0m18:35:18.498013 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:35:18.499289 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_observation_date.9a16015555
[0m18:35:18.500731 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:35:18.501688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_observation_date.9a16015555, now test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4)
[0m18:35:18.502531 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:35:18.505735 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4"
[0m18:35:18.516388 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:35:18.517538 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4
[0m18:35:18.518216 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:35:18.519193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_precipitation_mm.8a6f6e2ca4, now test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82)
[0m18:35:18.520399 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:35:18.523933 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82"
[0m18:35:18.535239 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:35:18.536327 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82
[0m18:35:18.537061 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:35:18.537875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_max_celsius.7465228b82, now test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6)
[0m18:35:18.538757 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:35:18.544337 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6"
[0m18:35:18.554028 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:35:18.555669 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6
[0m18:35:18.556574 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:35:18.557383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_temp_min_celsius.cc67c354a6, now test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab)
[0m18:35:18.557970 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:35:18.562224 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab"
[0m18:35:18.570550 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:35:18.572220 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab
[0m18:35:18.573172 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:35:18.573986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_stg_weather_weather_surrogate_key.529fb30dab, now test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20)
[0m18:35:18.574877 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:35:18.580409 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20"
[0m18:35:18.588813 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:35:18.590686 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20
[0m18:35:18.592808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:18.593674 [debug] [MainThread]: Connection 'test.weather_dbt.unique_stg_weather_weather_surrogate_key.77babdae20' was properly closed.
[0m18:35:18.595822 [debug] [MainThread]: Command end result
[0m18:35:18.667474 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:35:18.673162 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:35:18.683884 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/weather_dbt/target/run_results.json
[0m18:35:18.712834 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:35:18.713988 [info ] [MainThread]: Building catalog
[0m18:35:18.724664 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m18:35:18.732506 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m18:35:18.733762 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m18:35:18.734908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:18.742072 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:35:18.743229 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m18:35:18.743936 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('weather_raw')) or (upper(sch.nspname) = upper('silver') and
           upper(tbl.relname) = upper('stg_weather')) or (upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('fct_weather_daily')) or (upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('dim_location')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:35:18.748447 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.004 seconds
[0m18:35:18.751783 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m18:35:18.753702 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m18:35:18.765128 [debug] [MainThread]: Wrote artifact CatalogArtifact to /opt/airflow/dbt/weather_dbt/target/catalog.json
[0m18:35:18.797076 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/weather_dbt/target/manifest.json
[0m18:35:18.802673 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/weather_dbt/target/semantic_manifest.json
[0m18:35:18.803656 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/weather_dbt/target/catalog.json
[0m18:35:18.806143 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.3672003, "process_in_blocks": "3408", "process_kernel_time": 0.449638, "process_mem_max_rss": "127228", "process_out_blocks": "0", "process_user_time": 2.081071}
[0m18:35:18.808503 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:35:18.808358 after 1.37 seconds
[0m18:35:18.809571 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:35:18.810476 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m18:35:18.811291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263de321090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e2745850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263dff71f90>]}
[0m18:35:18.812365 [debug] [MainThread]: Flushing usage events
[0m18:35:20.086224 [debug] [MainThread]: An error was encountered while trying to flush usage events
